function _classCallCheck(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,r,t){return r&&_defineProperties(e.prototype,r),t&&_defineProperties(e,t),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{"1Vod":function(e,r,t){"use strict";t.r(r),t.d(r,"AllowAccessModule",(function(){return T}));var n=t("mrSG"),a=t("3Pt+"),i=t("fXoL"),o=t("tyNb"),s=t("9ZKQ"),c=t("dWDE"),l=t("xyCQ"),p=t("WF9o"),u=t("ofXK"),m=t("kmnG"),f=t("qFsG"),b=t("bTqV"),d=t("Xa2L");function h(e,r){if(1&e&&i.Pb(0,"img",9),2&e){var t=i.gc();i.nc("src",t.app.icon,i.uc)}}function g(e,r){if(1&e&&(i.Ub(0,"h1"),i.Ac(1),i.Tb()),2&e){var t=i.gc();i.Cb(1),i.Cc(" ",t.app.name," ")}}function w(e,r){if(1&e&&(i.Ub(0,"mat-error"),i.Ac(1),i.Tb()),2&e){var t=i.gc();i.Cb(1),i.Cc(" ",t.errors.email," ")}}function v(e,r){if(1&e&&(i.Ub(0,"mat-error"),i.Ac(1),i.Tb()),2&e){var t=i.gc();i.Cb(1),i.Cc(" ",t.errors.password," ")}}function C(e,r){1&e&&i.Pb(0,"mat-progress-spinner",10)}var y,I,k=((y=function(){function e(r,t,n,i,o){_classCallCheck(this,e),this.route=r,this.toast=t,this.formerror=n,this.service=i,this.localstorage=o,this.form=new a.d({email:new a.b("",[a.p.email,a.p.required]),password:new a.b("",[a.p.required])}),this.errors={email:"",password:""},this.app={},this.subscriptions={}}return _createClass(e,[{key:"load",value:function(){return Object(n.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.loading=!0,e.next=3,this.service.load({filter:["icon","name","scopes"],appId:this.appId});case 3:r=e.sent,this.loading=!1,r.ok?this.app=r.result:this.toast.error("issue loading app!");case 5:case"end":return e.stop()}}),e,this)})))}},{key:"submit",value:function(){return Object(n.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var r,t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.loading=!0,this.form.disable(),r=new Date((new Date).setFullYear((new Date).getFullYear()+1)),e.next=4,this.service.allowaccess({appId:this.appId,email:this.form.value.email,expiry:r,scopes:this.app.scopes,password:this.form.value.password,description:this.app.name+" (LOGIN)"});case 4:t=e.sent,this.form.enable(),this.loading=!1,t.ok?(n=[this.returl,"?","email=",this.form.value.email,"&","tokenId=",t.result.tokenId].join(""),window.open(n,"_parent")):this.toast.error(t.error.message);case 6:case"end":return e.stop()}}),e,this)})))}},{key:"ngOnInit",value:function(){var e=this;this.subscriptions.form=this.form.valueChanges.subscribe((function(r){e.errors=e.formerror.validateForm(e.form,e.errors,!0)})),this.subscriptions.route=this.route.queryParams.subscribe((function(r){e.appId=r.appId,e.returl=r.returl,void 0!==r.email&&(e.form.controls.email.setValue(r.email),e.localstorage.set("email",r.email)),e.load()}))}},{key:"ngOnDestroy",value:function(){this.subscriptions.form.unsubscribe(),this.subscriptions.route.unsubscribe()}}]),e}()).\u0275fac=function(e){return new(e||y)(i.Ob(o.a),i.Ob(s.a),i.Ob(c.a),i.Ob(l.a),i.Ob(p.a))},y.\u0275cmp=i.Ib({type:y,selectors:[["allow-access-page"]],decls:16,vars:7,consts:[[3,"formGroup","ngSubmit"],["alt","app icon",3,"src",4,"ngIf"],[4,"ngIf"],["appearance","outline"],["text-uppercase",""],["matInput","","type","email","name","email","placeholder","email","formControlName","email","required",""],["matInput","","type","password","name","password","placeholder","password","formControlName","password","required",""],["type","submit","mat-flat-button","","color","primary"],["mode","indeterminate","diameter","30",4,"ngIf"],["alt","app icon",3,"src"],["mode","indeterminate","diameter","30"]],template:function(e,r){1&e&&(i.Ub(0,"form",0),i.cc("ngSubmit",(function(){return!r.form.invalid&&!r.loading&&r.submit()})),i.zc(1,h,1,1,"img",1),i.zc(2,g,2,1,"h1",2),i.Ub(3,"mat-form-field",3),i.Ub(4,"mat-label",4),i.Ac(5," Email "),i.Tb(),i.Pb(6,"input",5),i.zc(7,w,2,1,"mat-error",2),i.Tb(),i.Ub(8,"mat-form-field",3),i.Ub(9,"mat-label",4),i.Ac(10," Password "),i.Tb(),i.Pb(11,"input",6),i.zc(12,v,2,1,"mat-error",2),i.Tb(),i.Ub(13,"button",7),i.Ac(14),i.zc(15,C,1,0,"mat-progress-spinner",8),i.Tb(),i.Tb()),2&e&&(i.nc("formGroup",r.form),i.Cb(1),i.nc("ngIf",r.app.icon),i.Cb(1),i.nc("ngIf",r.app.name),i.Cb(5),i.nc("ngIf",r.errors.email),i.Cb(5),i.nc("ngIf",r.errors.password),i.Cb(2),i.Cc(" ",r.loading?"":"allow access"," "),i.Cb(1),i.nc("ngIf",r.loading))},directives:[a.q,a.j,a.e,u.l,m.c,m.g,f.a,a.a,a.i,a.c,a.o,b.a,m.b,d.a],styles:["img[_ngcontent-%COMP%]{width:100px;display:block;margin:25px auto}form[_ngcontent-%COMP%]{width:400px;margin:auto}form[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:20px;text-align:center;line-height:20px;font-weight:400;text-transform:uppercase}@media screen and (max-width:420px){form[_ngcontent-%COMP%]{width:calc(100% - 20px)}}"]}),y),x=t("NFeN"),O=t("d3UM"),P=t("/t3+"),_=[{path:"",component:k}],T=((I=function e(){_classCallCheck(this,e)}).\u0275mod=i.Mb({type:I}),I.\u0275inj=i.Lb({factory:function(e){return new(e||I)},imports:[[a.f,u.c,x.b,f.b,b.b,O.b,P.b,m.e,a.n,d.b,o.g.forChild(_)]]}),I)}}]);