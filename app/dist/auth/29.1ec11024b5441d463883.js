(window.webpackJsonp=window.webpackJsonp||[]).push([[29],{bkGc:function(t,e,i){"use strict";i.r(e),i.d(e,"TipsAndUpdatesModule",(function(){return At}));var s=i("mrSG"),o=i("Ovx2"),n=i("Dh3D");class r{constructor(t){this.app={},this.role=0,void 0!==t&&null!=t&&(void 0!==t.app&&null!=t.app&&(void 0!==t.app.name&&null!=t.app.name&&(this.app.name=t.app.name),void 0!==t.app.icon&&null!=t.app.icon&&(this.app.icon=t.app.icon)),void 0!==t.role&&null!=t.role&&(this.role=t.role),void 0!==t.data&&null!=t.data&&(this.data=t.data),void 0!==t.appId&&null!=t.appId&&(this.appId=t.appId),void 0!==t.title&&null!=t.title&&(this.title=t.title),void 0!==t.itemId&&null!=t.itemId&&(this.itemId=t.itemId),void 0!==t.subtitle&&null!=t.subtitle&&(this.subtitle=t.subtitle))}}var a=i("+0xr"),l=i("3Pt+"),c=i("0IaG"),d=i("fXoL"),h=i("xyCQ"),u=i("dWDE"),b=i("/t3+"),m=i("kmnG"),p=i("bTqV"),f=i("NFeN"),g=i("4jEk"),v=i("ofXK"),C=i("d3UM"),y=i("FKr1"),E=i("WJ5W"),O=i("bv9b"),S=i("AbOq"),w=i("roMP");function I(t,e){1&t&&d.Nb(0,"mat-progress-bar",11)}function k(t,e){if(1&t&&(d.Sb(0,"mat-option",12),d.Cc(1),d.Rb()),2&t){const t=e.$implicit;d.kc("value",t.appId),d.Ab(1),d.Ec(" ",t.name," ")}}function q(t,e){if(1&t&&(d.Sb(0,"mat-error"),d.Cc(1),d.Rb()),2&t){const t=d.ec();d.Ab(1),d.Ec(" ",t.errors.appId," ")}}const M=function(t){return{name:t}};let R=(()=>{class t{constructor(t,e,i,s){this.apps=t,this.dialog=e,this.config=i,this.formerror=s,this.form=new l.f({appId:new l.c([])}),this.errors={appId:""},this.filter=new l.f({app:new l.c("")}),this.subscriptions={}}load(){return Object(s.a)(this,void 0,void 0,(function*(){this.loading=!0;const t=yield this.apps.list({filter:["name","appId"]});this.apps.data=t.ok?t.result.map(t=>new o.a(t)):[],void 0!==this.config.appId&&null!=this.config.appId&&this.form.controls.appId.setValue(this.config.appId),this.loading=!1}))}close(){return Object(s.a)(this,void 0,void 0,(function*(){this.dialog.close(!1)}))}submit(){return Object(s.a)(this,void 0,void 0,(function*(){this.dialog.close(this.form.value)}))}ngOnInit(){this.subscriptions.form=this.form.valueChanges.subscribe(t=>{this.errors=this.formerror.validateForm(this.form,this.errors,!0)}),this.load()}ngOnDestroy(){this.subscriptions.form.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(d.Mb(h.a),d.Mb(c.d),d.Mb(c.a),d.Mb(u.a))},t.\u0275cmp=d.Gb({type:t,selectors:[["tips-and-updates-filter-dialog"]],decls:21,vars:13,consts:[[1,"spacer"],["mat-icon-button","",3,"click"],["mode","indeterminate",4,"ngIf"],[3,"formGroup","ngSubmit"],["appearance","outline"],["name","appId","formControlName","appId","multiple",""],[3,"formGroup"],["placeholderLabel","filter apps","noEntriesFoundLabel","no apps found","formControlName","app"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],["type","submit","color","primary","mat-flat-button",""],["mode","indeterminate"],[3,"value"]],template:function(t,e){1&t&&(d.Sb(0,"mat-toolbar"),d.Sb(1,"mat-label",0),d.Cc(2," Filter Features "),d.Rb(),d.Sb(3,"button",1),d.ac("click",(function(){return e.close()})),d.Sb(4,"mat-icon"),d.Cc(5," close "),d.Rb(),d.Rb(),d.Rb(),d.Sb(6,"mat-content"),d.Ac(7,I,1,0,"mat-progress-bar",2),d.Sb(8,"form",3),d.ac("ngSubmit",(function(){return!e.loading&&!e.form.invalid&&e.submit()})),d.Sb(9,"mat-form-field",4),d.Sb(10,"mat-label"),d.Cc(11," App(s) "),d.Rb(),d.Sb(12,"mat-select",5),d.Sb(13,"mat-option",6),d.Nb(14,"ngx-mat-select-search",7),d.Rb(),d.Ac(15,k,2,2,"mat-option",8),d.fc(16,"filterBy"),d.fc(17,"orderBy"),d.Rb(),d.Ac(18,q,2,1,"mat-error",9),d.Rb(),d.Sb(19,"button",10),d.Cc(20," submit "),d.Rb(),d.Rb(),d.Rb()),2&t&&(d.Ab(7),d.kc("ngIf",e.loading),d.Ab(1),d.kc("formGroup",e.form),d.Ab(5),d.kc("formGroup",e.filter),d.Ab(2),d.kc("ngForOf",d.hc(16,5,d.hc(17,8,e.apps.data,"name"),d.mc(11,M,e.filter.value.app))),d.Ab(3),d.kc("ngIf",e.errors.appId))},directives:[b.a,m.g,p.a,f.a,g.a,v.l,l.w,l.p,l.g,m.c,C.a,l.o,l.e,y.k,E.a,v.k,O.a,m.b],pipes:[S.a,w.a],styles:[".filter-dialog{width:500px!important}.filter-dialog .mat-dialog-container{padding:0!important}@media screen and (max-width:600px){.filter-dialog .mat-dialog-container{top:0;left:0;right:0;bottom:0;z-index:5000;position:fixed;border-radius:0}}"],encapsulation:2}),t})();var A=i("9ZKQ"),x=i("u0tM"),j=i("L7HW"),V=i("bS1C"),P=i("tyNb"),T=i("swrf"),L=i("BhS5"),N=i("ossm"),F=i("znSr"),z=i("MutI"),D=i("A5z7");function G(t,e){1&t&&d.Nb(0,"mat-progress-bar",13)}function _(t,e){if(1&t){const t=d.Tb();d.Sb(0,"mat-chip",16),d.ac("removed",(function(){d.rc(t);const i=e.$implicit;return d.ec(2).unfilter("appId",i)})),d.Sb(1,"mat-icon"),d.Cc(2," apps "),d.Rb(),d.Sb(3,"mat-label"),d.Cc(4),d.Rb(),d.Sb(5,"mat-icon",17),d.Cc(6," cancel "),d.Rb(),d.Rb()}if(2&t){const t=e.$implicit,i=d.ec(2);d.Ab(4),d.Ec(" ",i.describe(i.apps.data,"appId",t)," ")}}function H(t,e){if(1&t&&(d.Sb(0,"mat-chip-list",14),d.Ac(1,_,7,1,"mat-chip",15),d.Rb()),2&t){const t=d.ec();d.Ab(1),d.kc("ngForOf",t.filter.appId)}}function Q(t,e){1&t&&(d.Sb(0,"th",18),d.Cc(1," Title "),d.Rb())}function W(t,e){if(1&t&&(d.Sb(0,"td",19),d.Cc(1),d.Rb()),2&t){const t=e.$implicit;d.Ab(1),d.Ec(" ",t.title," ")}}function J(t,e){1&t&&(d.Sb(0,"th",18),d.Cc(1," Subtitle "),d.Rb())}function $(t,e){if(1&t&&(d.Sb(0,"td",19),d.Cc(1),d.Rb()),2&t){const t=e.$implicit;d.Ab(1),d.Ec(" ",t.subtitle," ")}}function B(t,e){1&t&&d.Nb(0,"th",20)}function K(t,e){if(1&t){const t=d.Tb();d.Sb(0,"td",19),d.Sb(1,"button",21),d.ac("click",(function(){d.rc(t);const i=e.$implicit;return d.ec().options(i)})),d.Sb(2,"mat-icon"),d.Cc(3," more_vert "),d.Rb(),d.Rb(),d.Rb()}}function U(t,e){1&t&&d.Nb(0,"tr",22)}function Z(t,e){1&t&&d.Nb(0,"tr",23)}function Y(t,e){if(1&t){const t=d.Tb();d.Sb(0,"mat-list-item",24),d.ac("click",(function(){d.rc(t);const i=e.$implicit;return d.ec().options(i)})),d.Sb(1,"mat-label"),d.Sb(2,"h3"),d.Cc(3),d.Rb(),d.Sb(4,"p"),d.Cc(5),d.Rb(),d.Rb(),d.Rb()}if(2&t){const t=e.$implicit;d.Ab(3),d.Ec(" ",t.title," "),d.Ab(2),d.Ec(" ",t.subtitle," ")}}let X=(()=>{class t{constructor(t,e,i,s,o,n,r,l,c,d){this.apps=t,this.toast=e,this.dialog=i,this.sheet=s,this.config=o,this.filters=n,this.router=r,this.confirm=l,this.buttons=c,this.service=d,this.filter=this.filters.get({appId:[]}),this.table=new a.k,this.columns=["title","subtitle","options"],this.subscriptions={}}list(){return Object(s.a)(this,void 0,void 0,(function*(){this.loading=!0;const t=yield this.service.list({filter:["icon","role","title","itemId","subtitle"],appId:this.filter.appId});this.table.data=t.ok?t.result.map(t=>new r(t)):[],this.loading=!1}))}load(){return Object(s.a)(this,void 0,void 0,(function*(){this.loading=!0;const t=yield this.apps.list({filter:["name","appId"]});this.apps.data=t.ok?t.result.map(t=>new o.a(t)):[],this.loading=!1}))}unfilter(t,e){this.filter[t]=this.filter[t].filter(t=>t!=e),this.filters.update(this.filter),this.list()}options(t){return Object(s.a)(this,void 0,void 0,(function*(){this.sheet.show({role:t.role,title:t.title,options:[{icon:"edit",title:"Edit",handler:()=>Object(s.a)(this,void 0,void 0,(function*(){this.router.navigate(["/tips-and-updates","editor"],{queryParams:{mode:"update",itemId:t.itemId}})})),disabled:[0,1]},{icon:"content_copy",title:"Copy",handler:()=>Object(s.a)(this,void 0,void 0,(function*(){this.router.navigate(["/tips-and-updates","editor"],{queryParams:{mode:"copy",itemId:t.itemId}})})),disabled:[0,1]},{icon:"delete",title:"Delete",danger:!0,handler:()=>Object(s.a)(this,void 0,void 0,(function*(){this.confirm.show({message:"Are you sure you want to delete "+t.title+"?",handler:()=>Object(s.a)(this,void 0,void 0,(function*(){this.loading=!0;const e=yield this.service.delete({itemId:t.itemId});if(e.ok){for(let e=0;e<this.table.data.length;e++)if(this.table.data[e].itemId==t.itemId){this.table.data.splice(e,1),this.toast.show("Item was removed!");break}this.table.data=this.table.data.map(t=>new r(t))}else this.toast.show(e.error.message);this.loading=!1}))})})),disabled:[0,1,2,3,4]}]})}))}describe(t,e,i){let s="-";return t.map(t=>{t[e]==i&&(s=t.name)}),s}ngOnInit(){this.buttons.show("add"),this.buttons.hide("close"),this.buttons.show("filter"),this.buttons.show("search"),this.table.sort=this.sort,this.table.sort.active="title",this.table.sort.direction="asc",this.subscriptions.add=this.buttons.add.click.subscribe(t=>{this.router.navigate(["/tips-and-updates","editor"],{queryParams:{mode:"add"}})}),this.subscriptions.loaded=this.config.loaded.subscribe(t=>Object(s.a)(this,void 0,void 0,(function*(){t&&(yield this.list(),yield this.load())}))),this.subscriptions.search=this.buttons.search.value.subscribe(t=>{this.table.filter=t}),this.subscriptions.filter=this.buttons.filter.click.subscribe(t=>Object(s.a)(this,void 0,void 0,(function*(){const t=yield this.dialog.open(R,{data:this.filter,panelClass:"filter-dialog"});yield t.afterClosed().subscribe(t=>Object(s.a)(this,void 0,void 0,(function*(){t&&(Object.keys(t).map(e=>{this.filter[e]=t[e]}),this.filters.update(this.filter),this.list())})))})))}ngOnDestroy(){this.buttons.reset("search"),this.subscriptions.add.unsubscribe(),this.subscriptions.loaded.unsubscribe(),this.subscriptions.filter.unsubscribe(),this.subscriptions.search.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(d.Mb(h.a),d.Mb(A.a),d.Mb(c.b),d.Mb(x.a),d.Mb(j.a),d.Mb(V.a),d.Mb(P.c),d.Mb(T.a),d.Mb(L.a),d.Mb(N.a))},t.\u0275cmp=d.Gb({type:t,selectors:[["tips-and-updates-page"]],viewQuery:function(t,e){var i;1&t&&d.wc(n.a,!0),2&t&&d.oc(i=d.bc())&&(e.sort=i.first)},decls:16,vars:7,consts:[["mode","indeterminate",4,"ngIf"],["class","filterbar",4,"ngIf"],["mat-table","","fxShow","","fxHide.xs","true","matSort","",3,"dataSource"],["matColumnDef","title"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","subtitle"],["matColumnDef","options"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",4,"matRowDef","matRowDefColumns"],["fxHide","","fxShow.xs","true"],["lines","full","matRipple","",3,"click",4,"ngFor","ngForOf"],["mode","indeterminate"],[1,"filterbar"],[3,"removed",4,"ngFor","ngForOf"],[3,"removed"],["matChipRemove",""],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-header-cell",""],["mat-icon-button","",3,"click"],["mat-header-row",""],["mat-row",""],["lines","full","matRipple","",3,"click"]],template:function(t,e){1&t&&(d.Ac(0,G,1,0,"mat-progress-bar",0),d.Ac(1,H,2,1,"mat-chip-list",1),d.Sb(2,"table",2),d.Qb(3,3),d.Ac(4,Q,2,0,"th",4),d.Ac(5,W,2,1,"td",5),d.Pb(),d.Qb(6,6),d.Ac(7,J,2,0,"th",4),d.Ac(8,$,2,1,"td",5),d.Pb(),d.Qb(9,7),d.Ac(10,B,1,0,"th",8),d.Ac(11,K,4,0,"td",5),d.Pb(),d.Ac(12,U,1,0,"tr",9),d.Ac(13,Z,1,0,"tr",10),d.Rb(),d.Sb(14,"mat-list",11),d.Ac(15,Y,6,2,"mat-list-item",12),d.Rb()),2&t&&(d.kc("ngIf",e.loading),d.Ab(1),d.kc("ngIf",e.filter.appId.length>0),d.Ab(1),d.kc("dataSource",e.table),d.Ab(10),d.kc("matHeaderRowDef",e.columns)("matHeaderRowDefSticky",!0),d.Ab(1),d.kc("matRowDefColumns",e.columns),d.Ab(2),d.kc("ngForOf",e.table.data))},directives:[v.l,a.j,F.a,n.a,a.c,a.e,a.b,a.g,a.i,z.a,v.k,O.a,D.c,D.a,f.a,m.g,D.d,a.d,n.b,a.a,p.a,a.f,a.h,z.b,y.o],styles:[".mat-column-title[_ngcontent-%COMP%]{width:30%}.mat-column-options[_ngcontent-%COMP%]{width:40px;padding-right:16px!important}mat-list[_ngcontent-%COMP%]   mat-list-item[_ngcontent-%COMP%]{display:flex;align-items:center;flex-direction:row}"]}),t})();var tt=i("qFsG"),et=i("jhN1"),it=i("quSY"),st=i("xgIS"),ot=i("Kj3r");const nt=[[["","quill-editor-toolbar",""]]],rt=["[quill-editor-toolbar]"],at={toolbar:[["bold","italic","underline","strike"],["blockquote","code-block"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],[{direction:"rtl"}],[{size:["small",!1,"large","huge"]}],[{header:[1,2,3,4,5,6,!1]}],[{color:[]},{background:[]}],[{font:[]}],[{align:[]}],["clean"],["link","image","video"]]},lt=(t,e)=>t||e||"html",ct=new d.r("config");let dt=(()=>{class t{constructor(t,e){this.config=e,this.count=0,this.document=t.get(v.d),this.config||(this.config={modules:at})}getQuill(){return this.count++,this.Quill||1!==this.count||(this.$importPromise=new Promise(t=>Object(s.a)(this,void 0,void 0,(function*(){var e,s;const o=this.document.addEventListener;this.document.addEventListener=this.document.__zone_symbol__addEventListener||this.document.addEventListener;const n=yield i.e(30).then(i.t.bind(null,"kzlf",7));this.document.addEventListener=o,this.Quill=n.default?n.default:n,null===(e=this.config.customOptions)||void 0===e||e.forEach(t=>{const e=this.Quill.import(t.import);e.whitelist=t.whitelist,this.Quill.register(e,!0,this.config.suppressGlobalRegisterWarning)}),null===(s=this.config.customModules)||void 0===s||s.forEach(({implementation:t,path:e})=>{this.Quill.register(e,t,this.config.suppressGlobalRegisterWarning)}),t(this.Quill)})))),this.$importPromise}}return t.\u0275fac=function(e){return new(e||t)(d.Wb(d.s),d.Wb(ct))},t.\u0275prov=d.Ib({factory:function(){return new t(d.Wb(d.p),d.Wb(ct))},token:t,providedIn:"root"}),t})(),ht=(()=>{class t{constructor(t,e,i,s,o,n,r){this.elementRef=e,this.domSanitizer=i,this.platformId=s,this.renderer=o,this.zone=n,this.service=r,this.required=!1,this.customToolbarPosition="top",this.sanitize=!1,this.styles=null,this.strict=!0,this.customOptions=[],this.customModules=[],this.preserveWhitespace=!1,this.trimOnValidation=!1,this.compareValues=!1,this.filterNull=!1,this.defaultEmptyValue=null,this.onEditorCreated=new d.o,this.onEditorChanged=new d.o,this.onContentChanged=new d.o,this.onSelectionChanged=new d.o,this.onFocus=new d.o,this.onBlur=new d.o,this.disabled=!1,this.subscription=null,this.valueGetter=(t,e)=>{let i=e.querySelector(".ql-editor").innerHTML;"<p><br></p>"!==i&&"<div><br></div>"!==i||(i=this.defaultEmptyValue);let s=i;const o=lt(this.format,this.service.config.format);if("text"===o)s=t.getText();else if("object"===o)s=t.getContents();else if("json"===o)try{s=JSON.stringify(t.getContents())}catch(n){s=t.getText()}return s},this.valueSetter=(t,e)=>{const i=lt(this.format,this.service.config.format);if("html"===i)return this.sanitize&&(e=this.domSanitizer.sanitize(d.J.HTML,e)),t.clipboard.convert(e);if("json"===i)try{return JSON.parse(e)}catch(s){return[{insert:e}]}return e},this.selectionChangeHandler=(t,e,i)=>{const s=!t&&!!this.onModelTouched;(this.onBlur.observers.length||this.onFocus.observers.length||this.onSelectionChanged.observers.length||s)&&this.zone.run(()=>{null===t?this.onBlur.emit({editor:this.quillEditor,source:i}):null===e&&this.onFocus.emit({editor:this.quillEditor,source:i}),this.onSelectionChanged.emit({editor:this.quillEditor,oldRange:e,range:t,source:i}),s&&this.onModelTouched()})},this.textChangeHandler=(t,e,i)=>{const s=this.quillEditor.getText(),o=this.quillEditor.getContents();let n=this.editorElem.querySelector(".ql-editor").innerHTML;"<p><br></p>"!==n&&"<div><br></div>"!==n||(n=this.defaultEmptyValue);const r=this.trackChanges||this.service.config.trackChanges,a=("user"===i||r&&"all"===r)&&!!this.onModelChange;(this.onContentChanged.observers.length||a)&&this.zone.run(()=>{a&&this.onModelChange(this.valueGetter(this.quillEditor,this.editorElem)),this.onContentChanged.emit({content:o,delta:t,editor:this.quillEditor,html:n,oldDelta:e,source:i,text:s})})},this.editorChangeHandler=(t,e,i,s)=>{if(this.onEditorChanged.observers.length)if("text-change"===t){const o=this.quillEditor.getText(),n=this.quillEditor.getContents();let r=this.editorElem.querySelector(".ql-editor").innerHTML;"<p><br></p>"!==r&&"<div><br></div>"!==r||(r=this.defaultEmptyValue),this.zone.run(()=>{this.onEditorChanged.emit({content:n,delta:e,editor:this.quillEditor,event:t,html:r,oldDelta:i,source:s,text:o})})}else this.zone.run(()=>{this.onEditorChanged.emit({editor:this.quillEditor,event:t,oldRange:i,range:e,source:s})})},this.document=t.get(v.d)}static normalizeClassNames(t){return t.trim().split(" ").reduce((t,e)=>{const i=e.trim();return i&&t.push(i),t},[])}ngAfterViewInit(){return Object(s.a)(this,void 0,void 0,(function*(){if(Object(v.u)(this.platformId))return;const t=yield this.service.getQuill();this.elementRef.nativeElement.insertAdjacentHTML("top"===this.customToolbarPosition?"beforeend":"afterbegin",this.preserveWhitespace?"<pre quill-editor-element></pre>":"<div quill-editor-element></div>"),this.editorElem=this.elementRef.nativeElement.querySelector("[quill-editor-element]");const e=this.elementRef.nativeElement.querySelector("[quill-editor-toolbar]"),i=Object.assign({},this.modules||this.service.config.modules);e?i.toolbar=e:void 0===i.toolbar&&(i.toolbar=at.toolbar);let s=void 0!==this.placeholder?this.placeholder:this.service.config.placeholder;void 0===s&&(s="Insert text here ..."),this.styles&&Object.keys(this.styles).forEach(t=>{this.renderer.setStyle(this.editorElem,t,this.styles[t])}),this.classes&&this.addClasses(this.classes),this.customOptions.forEach(e=>{const i=t.import(e.import);i.whitelist=e.whitelist,t.register(i,!0)}),this.customModules.forEach(({implementation:e,path:i})=>{t.register(i,e)});let o=this.bounds&&"self"===this.bounds?this.editorElem:this.bounds;o||(o=this.service.config.bounds?this.service.config.bounds:this.document.body);let n=this.debug;!n&&!1!==n&&this.service.config.debug&&(n=this.service.config.debug);let r=this.readOnly;r||!1===this.readOnly||(r=void 0!==this.service.config.readOnly&&this.service.config.readOnly);let a=this.defaultEmptyValue;this.service.config.hasOwnProperty("defaultEmptyValue")&&(a=this.service.config.defaultEmptyValue);let l=this.scrollingContainer;l||null===this.scrollingContainer||(l=null===this.service.config.scrollingContainer||this.service.config.scrollingContainer?this.service.config.scrollingContainer:null);let c=this.formats;if(c||void 0!==c||(c=this.service.config.formats?[...this.service.config.formats]:null===this.service.config.formats?null:void 0),this.zone.runOutsideAngular(()=>{var e,d,h;if(this.quillEditor=new t(this.editorElem,{bounds:o,debug:n,formats:c,modules:i,placeholder:s,readOnly:r,defaultEmptyValue:a,scrollingContainer:l,strict:this.strict,theme:this.theme||(this.service.config.theme?this.service.config.theme:"snow")}),this.linkPlaceholder){const t=null===(d=null===(e=this.quillEditor)||void 0===e?void 0:e.theme)||void 0===d?void 0:d.tooltip,i=null===(h=null==t?void 0:t.root)||void 0===h?void 0:h.querySelector("input[data-link]");(null==i?void 0:i.dataset)&&(i.dataset.link=this.linkPlaceholder)}}),this.content){if("text"===lt(this.format,this.service.config.format))this.quillEditor.setText(this.content,"silent");else{const t=this.valueSetter(this.quillEditor,this.content);this.quillEditor.setContents(t,"silent")}this.quillEditor.getModule("history").clear()}this.setDisabledState(),this.addQuillEventListeners(),(this.onEditorCreated.observers.length||this.onValidatorChanged)&&requestAnimationFrame(()=>{this.onValidatorChanged&&this.onValidatorChanged(),this.onEditorCreated.emit(this.quillEditor)})}))}ngOnDestroy(){this.dispose()}ngOnChanges(t){if(this.quillEditor){if(t.readOnly&&this.quillEditor.enable(!t.readOnly.currentValue),t.placeholder&&(this.quillEditor.root.dataset.placeholder=t.placeholder.currentValue),t.defaultEmptyValue&&(this.quillEditor.root.dataset.defaultEmptyValue=t.defaultEmptyValue.currentValue),t.styles){const e=t.styles.currentValue,i=t.styles.previousValue;i&&Object.keys(i).forEach(t=>{this.renderer.removeStyle(this.editorElem,t)}),e&&Object.keys(e).forEach(t=>{this.renderer.setStyle(this.editorElem,t,this.styles[t])})}if(t.classes){const e=t.classes.currentValue,i=t.classes.previousValue;i&&this.removeClasses(i),e&&this.addClasses(e)}t.debounceTime&&this.addQuillEventListeners()}}addClasses(e){t.normalizeClassNames(e).forEach(t=>{this.renderer.addClass(this.editorElem,t)})}removeClasses(e){t.normalizeClassNames(e).forEach(t=>{this.renderer.removeClass(this.editorElem,t)})}writeValue(t){if(this.filterNull&&null===t)return;if(this.content=t,!this.quillEditor)return;const e=lt(this.format,this.service.config.format),i=this.valueSetter(this.quillEditor,t);if(this.compareValues){const t=this.quillEditor.getContents();if(JSON.stringify(t)===JSON.stringify(i))return}t?"text"===e?this.quillEditor.setText(t):this.quillEditor.setContents(i):this.quillEditor.setText("")}setDisabledState(t=this.disabled){this.disabled=t,this.quillEditor&&(t?(this.quillEditor.disable(),this.renderer.setAttribute(this.elementRef.nativeElement,"disabled","disabled")):(this.readOnly||this.quillEditor.enable(),this.renderer.removeAttribute(this.elementRef.nativeElement,"disabled")))}registerOnChange(t){this.onModelChange=t}registerOnTouched(t){this.onModelTouched=t}registerOnValidatorChange(t){this.onValidatorChanged=t}validate(){if(!this.quillEditor)return null;const t={};let e=!0;const i=this.quillEditor.getText(),s=this.trimOnValidation?i.trim().length:1===i.length&&0===i.trim().length?0:i.length-1;return this.minLength&&s&&s<this.minLength&&(t.minLengthError={given:s,minLength:this.minLength},e=!1),this.maxLength&&s>this.maxLength&&(t.maxLengthError={given:s,maxLength:this.maxLength},e=!1),this.required&&!s&&(t.requiredError={empty:!0},e=!1),e?null:t}addQuillEventListeners(){this.dispose(),this.zone.runOutsideAngular(()=>{this.subscription=new it.a,this.subscription.add(Object(st.a)(this.quillEditor,"selection-change").subscribe(([t,e,i])=>{this.selectionChangeHandler(t,e,i)}));let t=Object(st.a)(this.quillEditor,"text-change"),e=Object(st.a)(this.quillEditor,"editor-change");"number"==typeof this.debounceTime&&(t=t.pipe(Object(ot.a)(this.debounceTime)),e=e.pipe(Object(ot.a)(this.debounceTime))),this.subscription.add(t.subscribe(([t,e,i])=>{this.textChangeHandler(t,e,i)})),this.subscription.add(e.subscribe(([t,e,i,s])=>{this.editorChangeHandler(t,e,i,s)}))})}dispose(){null!==this.subscription&&(this.subscription.unsubscribe(),this.subscription=null)}}return t.\u0275fac=function(e){return new(e||t)(d.Mb(d.s),d.Mb(d.l),d.Mb(et.b),d.Mb(d.C),d.Mb(d.F),d.Mb(d.A),d.Mb(dt))},t.\u0275dir=d.Hb({type:t,inputs:{required:"required",customToolbarPosition:"customToolbarPosition",sanitize:"sanitize",styles:"styles",strict:"strict",customOptions:"customOptions",customModules:"customModules",preserveWhitespace:"preserveWhitespace",trimOnValidation:"trimOnValidation",compareValues:"compareValues",filterNull:"filterNull",defaultEmptyValue:"defaultEmptyValue",valueGetter:"valueGetter",valueSetter:"valueSetter",format:"format",theme:"theme",modules:"modules",debug:"debug",readOnly:"readOnly",placeholder:"placeholder",maxLength:"maxLength",minLength:"minLength",formats:"formats",scrollingContainer:"scrollingContainer",bounds:"bounds",trackChanges:"trackChanges",classes:"classes",linkPlaceholder:"linkPlaceholder",debounceTime:"debounceTime"},outputs:{onEditorCreated:"onEditorCreated",onEditorChanged:"onEditorChanged",onContentChanged:"onContentChanged",onSelectionChanged:"onSelectionChanged",onFocus:"onFocus",onBlur:"onBlur"},features:[d.yb]}),t})(),ut=(()=>{class t extends ht{constructor(t,e,i,s,o,n,r){super(t,e,i,s,o,n,r)}}return t.\u0275fac=function(e){return new(e||t)(d.Mb(d.s),d.Mb(d.l),d.Mb(et.b),d.Mb(d.C),d.Mb(d.F),d.Mb(d.A),d.Mb(dt))},t.\u0275cmp=d.Gb({type:t,selectors:[["quill-editor"]],features:[d.zb([{multi:!0,provide:l.m,useExisting:Object(d.U)(()=>t)},{multi:!0,provide:l.l,useExisting:Object(d.U)(()=>t)}]),d.xb],ngContentSelectors:rt,decls:1,vars:0,template:function(t,e){1&t&&(d.jc(nt),d.ic(0))},encapsulation:2}),t})(),bt=(()=>{class t{static forRoot(e){return{ngModule:t,providers:[{provide:ct,useValue:e}]}}}return t.\u0275mod=d.Kb({type:t}),t.\u0275inj=d.Jb({factory:function(e){return new(e||t)},providers:[dt],imports:[[v.c]]}),t})();var mt=i("ZRfb");function pt(t,e){if(1&t&&(d.Sb(0,"mat-option",11),d.Cc(1),d.Rb()),2&t){const t=e.$implicit;d.kc("value",t.appId),d.Ab(1),d.Ec(" ",t.name," ")}}function ft(t,e){if(1&t&&(d.Sb(0,"mat-error"),d.Cc(1),d.Rb()),2&t){const t=d.ec();d.Ab(1),d.Ec(" ",t.errors.appId," ")}}function gt(t,e){if(1&t&&(d.Sb(0,"mat-error"),d.Cc(1),d.Rb()),2&t){const t=d.ec();d.Ab(1),d.Ec(" ",t.errors.title," ")}}function vt(t,e){if(1&t&&(d.Sb(0,"mat-error"),d.Cc(1),d.Rb()),2&t){const t=d.ec();d.Ab(1),d.Ec(" ",t.errors.subtitle," ")}}const Ct=function(t){return{name:t}};let yt=(()=>{class t{constructor(t,e,i,s,o,n,r){this.apps=t,this.toast=e,this.route=i,this.config=s,this.router=o,this.buttons=n,this.service=r,this.form=new l.f({data:new l.c(null,[l.v.required]),appId:new l.c(null,[l.v.required]),title:new l.c(null,[l.v.required]),subtitle:new l.c(null,[l.v.required])}),this.errors={data:"",appId:"",title:"",subtitle:""},this.filter=new l.f({apps:new l.c("",[l.v.required])}),this.subscriptions={}}get(){return Object(s.a)(this,void 0,void 0,(function*(){this.loading=!0;const t=yield this.service.get({filter:["role","data","appId","title","subtitle"],itemId:this.itemId});if(t.ok){const e=new r(t.result);e.role>=2?(this.form.controls.data.setValue(e.data),this.form.controls.appId.setValue(e.appId),this.form.controls.title.setValue(e.title),this.form.controls.subtitle.setValue(e.subtitle)):(this.toast.show("You have insufficient rights to edit this item!"),this.router.navigate(["/tips-and-updates"]))}else this.toast.show(t.error.message),this.router.navigate(["/tips-and-updates"]);this.loading=!1}))}load(){return Object(s.a)(this,void 0,void 0,(function*(){this.loading=!0;const t=yield this.apps.list({filter:["role","name","icon","appId"]});t.ok?this.apps.data=t.result.map(t=>new o.a(t)).filter(t=>t.role>=2):(this.apps.data=[],this.toast.show(t.error.message)),this.loading=!1}))}submit(){return Object(s.a)(this,void 0,void 0,(function*(){this.loading=!0;let t=this.mode;"copy"==t&&(t="add",delete this.itemId);const e=yield this.service[t]({data:this.form.value.data,appId:this.form.value.appId,title:this.form.value.title,itemId:this.itemId,subtitle:this.form.value.subtitle});e.ok?this.router.navigate(["/tips-and-updates"]):this.toast.show(e.error.message),this.loading=!1}))}ngOnInit(){this.buttons.hide("add"),this.buttons.show("close"),this.buttons.hide("filter"),this.buttons.hide("search"),this.subscriptions.close=this.buttons.close.click.subscribe(t=>{this.router.navigate(["/tips-and-updates"])}),this.subscriptions.loaded=this.config.loaded.subscribe(t=>Object(s.a)(this,void 0,void 0,(function*(){if(t){const t=this.route.snapshot.queryParams;this.mode=t.mode,this.itemId=t.itemId,"add"!=this.mode?(yield this.get(),yield this.load()):yield this.load()}})))}ngOnDestroy(){this.subscriptions.close.unsubscribe(),this.subscriptions.loaded.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(d.Mb(h.a),d.Mb(A.a),d.Mb(P.a),d.Mb(j.a),d.Mb(P.c),d.Mb(L.a),d.Mb(N.a))},t.\u0275cmp=d.Gb({type:t,selectors:[["tips-and-updates-editor-page"]],decls:26,vars:14,consts:[[3,"formGroup","ngSubmit"],["appearance","outline"],["name","appId","placeholder","appId","formControlName","appId","required",""],[3,"formGroup"],["placeholderLabel","filter apps","noEntriesFoundLabel","no apps found","formControlName","apps"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],["matInput","","type","text","name","title","placeholder","title","formControlName","title","required",""],["matInput","","type","text","name","subtitle","placeholder","subtitle","formControlName","subtitle","required",""],["name","data","formControlName","data","required",""],["type","button","mat-flat-button","","color","primary",3,"disabled","click"],[3,"value"]],template:function(t,e){1&t&&(d.Sb(0,"mat-content"),d.Sb(1,"form",0),d.ac("ngSubmit",(function(){return!e.loading&&!e.form.invalid&&e.submit()})),d.Sb(2,"mat-form-field",1),d.Sb(3,"mat-label"),d.Cc(4," App "),d.Rb(),d.Sb(5,"mat-select",2),d.Sb(6,"mat-option",3),d.Nb(7,"ngx-mat-select-search",4),d.Rb(),d.Ac(8,pt,2,2,"mat-option",5),d.fc(9,"filterBy"),d.Rb(),d.Ac(10,ft,2,1,"mat-error",6),d.Rb(),d.Sb(11,"mat-form-field",1),d.Sb(12,"mat-label"),d.Cc(13," Title "),d.Rb(),d.Nb(14,"input",7),d.Ac(15,gt,2,1,"mat-error",6),d.Rb(),d.Sb(16,"mat-form-field",1),d.Sb(17,"mat-label"),d.Cc(18," Subtitle "),d.Rb(),d.Nb(19,"input",8),d.Ac(20,vt,2,1,"mat-error",6),d.Rb(),d.Rb(),d.Sb(21,"section",3),d.Nb(22,"quill-editor",9),d.Rb(),d.Rb(),d.Sb(23,"mat-footer"),d.Sb(24,"button",10),d.ac("click",(function(){return!e.loading&&!e.form.invalid&&e.submit()})),d.Cc(25),d.Rb(),d.Rb()),2&t&&(d.Ab(1),d.kc("formGroup",e.form),d.Ab(5),d.kc("formGroup",e.filter),d.Ab(2),d.kc("ngForOf",d.hc(9,9,e.apps.data,d.mc(12,Ct,e.filter.value.apps))),d.Ab(2),d.kc("ngIf",e.errors.appId),d.Ab(5),d.kc("ngIf",e.errors.title),d.Ab(5),d.kc("ngIf",e.errors.subtitle),d.Ab(1),d.kc("formGroup",e.form),d.Ab(3),d.kc("disabled",e.form.invalid),d.Ab(1),d.Ec(" ",e.mode," "))},directives:[g.a,l.w,l.p,l.g,m.c,m.g,C.a,l.o,l.e,l.u,y.k,E.a,v.k,v.l,tt.a,l.b,ut,mt.a,p.a,m.b],pipes:[S.a],styles:["[upload][_ngcontent-%COMP%]{width:100px;margin:auto;height:100px;border:2px solid transparent;display:flex;align-items:center;border-radius:100%;justify-content:center;background-color:#eee}[upload].required[_ngcontent-%COMP%]{border-color:red}mat-content[_ngcontent-%COMP%], mat-footer[_ngcontent-%COMP%]{display:flex;align-items:center;flex-direction:column}mat-content[_ngcontent-%COMP%]   form[_ngcontent-%COMP%], mat-footer[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{max-width:400px;margin-top:20px}mat-content[_ngcontent-%COMP%]   button[_ngcontent-%COMP%], mat-footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%;max-width:400px}mat-footer[_ngcontent-%COMP%]{justify-content:center}"]}),t})();var Et=i("wZkO"),Ot=i("gyTc"),St=i("R32p"),wt=i("tVzd"),It=i("J89Z"),kt=i("YUcS"),qt=i("H0Zp"),Mt=i("p/0r");const Rt=[{path:"",component:X},{path:"editor",component:yt}];let At=(()=>{class t{}return t.\u0275mod=d.Kb({type:t}),t.\u0275inj=d.Jb({factory:function(e){return new(e||t)},imports:[[l.i,v.c,St.a,Et.a,f.b,n.c,z.c,Ot.a,D.e,a.l,tt.b,c.c,It.a,wt.a,y.p,p.b,C.b,kt.a,qt.a,Mt.a,b.b,m.e,l.t,O.b,bt.forRoot(),E.b,P.g.forChild(Rt)]]}),t})()}}]);