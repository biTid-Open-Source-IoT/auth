function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{"4dGL":function(e,t,r){"use strict";r.r(t),r.d(t,"ScopesModule",(function(){return ne}));var o=r("CSBE"),n=r("ofXK"),s=r("C6Ja"),i=r("NFeN"),a=r("STbY"),c=r("+0xr"),u=r("qFsG"),p=r("d3UM"),l=r("0IaG"),b=r("bTqV"),d=r("J89Z"),m=r("/t3+"),f=r("O8lL"),h=r("mrSG"),g=r("At5g"),v=r("RZmA"),y=r("SY5p"),C=r("fXoL"),x=r("d3yR"),w=r("9ZKQ"),k=r("2ChS"),I=r("tyNb"),T=r("a6VE"),U=r("bv9b");function O(e,t){1&e&&C.Pb(0,"mat-progress-bar",16)}function R(e,t){1&e&&(C.Ub(0,"th",17),C.yc(1," app "),C.Tb())}function P(e,t){if(1&e&&(C.Ub(0,"td",18),C.yc(1),C.Tb()),2&e){var r=t.$implicit;C.Cb(1),C.Ac(" ",r.app," ")}}function _(e,t){1&e&&(C.Ub(0,"th",17),C.yc(1," description "),C.Tb())}function D(e,t){if(1&e&&(C.Ub(0,"td",18),C.yc(1),C.Tb()),2&e){var r=t.$implicit;C.Cb(1),C.Ac(" ",r.description," ")}}function S(e,t){1&e&&(C.Ub(0,"th",17),C.yc(1," url "),C.Tb())}function j(e,t){if(1&e&&(C.Ub(0,"td",19),C.yc(1),C.Tb()),2&e){var r=t.$implicit;C.Cb(1),C.Ac(" ",r.url," ")}}function A(e,t){1&e&&C.Pb(0,"tr",20)}function q(e,t){if(1&e){var r=C.Vb();C.Ub(0,"tr",21),C.cc("click",(function(){C.rc(r);var e=t.$implicit;return C.gc().options(e)})),C.Tb()}}var M,N=((M=function(){function e(t,r,o,n,s,i){_classCallCheck(this,e),this.menu=t,this.toast=r,this.sheet=o,this.dialog=n,this.router=s,this.service=i,this.sort={key:"description",reverse:!1},this.scopes=new c.k,this.columns=["app","description","url"],this.subscriptions={}}return _createClass(e,[{key:"list",value:function(){return Object(h.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.loading=!0,e.next=3,this.service.list({sort:_defineProperty({},this.sort.key,this.sort.reverse?-1:1),filter:["url","app","role","appId","scopeId","description"]});case 3:t=e.sent,this.loading=!1,this.scopes.data=t.ok?t.result:[];case 5:case"end":return e.stop()}}),e,this)})))}},{key:"options",value:function(e){return Object(h.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r,o=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.sheet.open(y.a,{data:{role:e.role,title:e.description,options:[{icon:"create",title:"Edit",disabled:[0,1],optionId:0},{icon:"file_copy",title:"Copy",disabled:[0,1,2],optionId:1},{icon:"delete",title:"Delete",disabled:[0,1,2,3,4],optionId:2}]}});case 2:return r=t.sent,t.next=5,r.afterDismissed().subscribe((function(t){return Object(h.a)(o,void 0,void 0,regeneratorRuntime.mark((function r(){var o,n=this;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(void 0===t){r.next=13;break}r.t0=t,r.next=0===r.t0?4:1===r.t0?6:2===r.t0?8:13;break;case 4:return this.router.navigate(["/scopes","update",e.scopeId]),r.abrupt("break",13);case 6:return this.router.navigate(["/scopes","copy",e.scopeId]),r.abrupt("break",13);case 8:return r.next=10,this.dialog.open(g.a,{panelClass:"delete-dialog",disableClose:!0});case 10:return o=r.sent,r.next=13,o.afterClosed().subscribe((function(t){return Object(h.a)(n,void 0,void 0,regeneratorRuntime.mark((function r(){var o,n;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!t){r.next=19;break}return this.loading=!0,r.next=4,this.service.delete({scopeId:e.scopeId});case 4:if(o=r.sent,this.loading=!1,!o.ok){r.next=18;break}this.toast.success("scope was deleted!"),n=0;case 8:if(!(n<this.scopes.data.length)){r.next=15;break}if(this.scopes.data[n].scopeId!=e.scopeId){r.next=12;break}return this.scopes.data.splice(n,1),r.abrupt("break",15);case 12:n++,r.next=8;break;case 15:this.scopes.data=JSON.parse(JSON.stringify(this.scopes.data)),r.next=19;break;case 18:this.toast.error("issue deleting scope!");case 19:case"end":return r.stop()}}),r,this)})))}));case 13:case"end":return r.stop()}}),r,this)})))}));case 5:case"end":return t.stop()}}),t,this)})))}},{key:"ngOnInit",value:function(){var e=this;this.list(),this.subscriptions.search=this.search.change.subscribe((function(t){e.scopes.filter=t}))}},{key:"ngOnDestroy",value:function(){this.subscriptions.search.unsubscribe()}}]),e}()).\u0275fac=function(e){return new(e||M)(C.Ob(x.a),C.Ob(w.a),C.Ob(k.b),C.Ob(l.b),C.Ob(I.b),C.Ob(T.a))},M.\u0275cmp=C.Ib({type:M,selectors:[["app-scopes-page"]],viewQuery:function(e,t){var r;1&e&&C.vc(v.a,!0),2&e&&C.oc(r=C.dc())&&(t.search=r.first)},decls:24,vars:5,consts:[["color","primary"],["mat-icon-button","",1,"menu-toggle",3,"click"],[1,"page-label","spacer"],["placeholder","filter scopes"],["mat-icon-button","","routerLink","add"],["mode","indeterminate","color","accent",4,"ngIf"],[1,"page-body"],["mat-table","",3,"dataSource"],["matColumnDef","app"],["mat-header-cell","","text-uppercase","",4,"matHeaderCellDef"],["mat-cell","","text-uppercase","",4,"matCellDef"],["matColumnDef","description"],["matColumnDef","url"],["mat-cell","","text-lowercase","",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",3,"click",4,"matRowDef","matRowDefColumns"],["mode","indeterminate","color","accent"],["mat-header-cell","","text-uppercase",""],["mat-cell","","text-uppercase",""],["mat-cell","","text-lowercase",""],["mat-header-row",""],["mat-row","",3,"click"]],template:function(e,t){1&e&&(C.Ub(0,"mat-toolbar",0),C.Ub(1,"button",1),C.cc("click",(function(){return t.menu.toggle()})),C.Ub(2,"mat-icon"),C.yc(3," menu "),C.Tb(),C.Tb(),C.Ub(4,"div",2),C.yc(5," scopes "),C.Tb(),C.Pb(6,"search",3),C.Ub(7,"button",4),C.Ub(8,"mat-icon"),C.yc(9," add "),C.Tb(),C.Tb(),C.Tb(),C.xc(10,O,1,0,"mat-progress-bar",5),C.Ub(11,"div",6),C.Ub(12,"table",7),C.Sb(13,8),C.xc(14,R,2,0,"th",9),C.xc(15,P,2,1,"td",10),C.Rb(),C.Sb(16,11),C.xc(17,_,2,0,"th",9),C.xc(18,D,2,1,"td",10),C.Rb(),C.Sb(19,12),C.xc(20,S,2,0,"th",9),C.xc(21,j,2,1,"td",13),C.Rb(),C.xc(22,A,1,0,"tr",14),C.xc(23,q,1,0,"tr",15),C.Tb(),C.Tb()),2&e&&(C.Cb(10),C.nc("ngIf",t.loading),C.Cb(2),C.nc("dataSource",t.scopes),C.Cb(10),C.nc("matHeaderRowDef",t.columns)("matHeaderRowDefSticky",!0),C.Cb(1),C.nc("matRowDefColumns",t.columns))},directives:[m.a,b.a,i.a,v.a,I.c,n.l,c.j,c.c,c.e,c.b,c.g,c.i,U.a,c.d,c.a,c.f,c.h],styles:[".mat-column-icon[_ngcontent-%COMP%]{width:60px}.mat-column-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:40px;margin-top:5px;max-height:40px}.mat-row[_ngcontent-%COMP%]{cursor:pointer}"]}),M),F=r("AytR"),G=r("3Pt+"),L=r("dWDE"),V=r("xyCQ"),J=r("kmnG"),$=r("FKr1"),E=r("roMP");function H(e,t){1&e&&C.Pb(0,"mat-progress-bar",14)}function K(e,t){if(1&e&&(C.Ub(0,"mat-error"),C.yc(1),C.Tb()),2&e){var r=C.gc();C.Cb(1),C.Ac(" ",r.errors.description," ")}}function Q(e,t){if(1&e&&(C.Ub(0,"mat-error"),C.yc(1),C.Tb()),2&e){var r=C.gc();C.Cb(1),C.Ac(" ",r.errors.url," ")}}function Z(e,t){if(1&e&&(C.Ub(0,"mat-option",15),C.yc(1),C.Tb()),2&e){var r=t.$implicit;C.nc("value",r.appId),C.Cb(1),C.Ac(" ",r.name," ")}}function B(e,t){if(1&e&&(C.Ub(0,"mat-error"),C.yc(1),C.Tb()),2&e){var r=C.gc();C.Cb(1),C.Ac(" ",r.errors.appId," ")}}function X(e,t){if(1&e&&(C.Ub(0,"mat-option",15),C.yc(1),C.Tb()),2&e){var r=t.$implicit;C.nc("value",r.value),C.Cb(1),C.Ac(" ",r.title," ")}}function Y(e,t){if(1&e&&(C.Ub(0,"mat-error"),C.yc(1),C.Tb()),2&e){var r=C.gc();C.Cb(1),C.Ac(" ",r.errors.roles," ")}}var W,z,ee,te=((W=function(){function e(t,r,o,n,s,i){_classCallCheck(this,e),this.route=t,this.toast=r,this.router=o,this.service=n,this.formerror=s,this.appsservice=i,this.form=new G.d({url:new G.b("",[G.p.required]),appId:new G.b("",[G.p.required]),roles:new G.b(0,[G.p.required]),description:new G.b("",[G.p.required])}),this.errors={url:"",appId:"",roles:"",description:""},this.apps=[],this.roles=F.a.roles,this.subscriptions={}}return _createClass(e,[{key:"get",value:function(){return Object(h.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.loading=!0,e.next=3,this.service.get({filter:["url","role","appId","roles","description"],scopeId:this.scopeId});case 3:t=e.sent,this.loading=!1,t.ok?(t.result.role<3&&(this.router.navigate(["/scopes"]),this.toast.error("you do not have permission to access this scope!")),this.form.controls.url.setValue(t.result.url),this.form.controls.appId.setValue(t.result.appId),this.form.controls.roles.setValue(t.result.roles),this.form.controls.description.setValue(t.result.description)):(this.router.navigate(["/scopes"]),this.toast.error("issue loading scope!")),this.load();case 5:case"end":return e.stop()}}),e,this)})))}},{key:"load",value:function(){return Object(h.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.loading=!0,e.next=3,this.appsservice.list({filter:["name","appId"]});case 3:t=e.sent,this.loading=!1,t.ok&&(this.apps=t.result);case 5:case"end":return e.stop()}}),e,this)})))}},{key:"submit",value:function(){return Object(h.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.loading=!0,"copy"==(t=this.mode)&&(t="add"),this.form.disable(),e.next=5,this.service[t]({url:this.form.value.url,roles:this.form.value.roles,appId:this.form.value.appId,scopeId:this.scopeId,description:this.form.value.description});case 5:r=e.sent,this.form.enable(),this.loading=!1,r.ok?(this.router.navigate(["/scopes"]),this.toast.success("add"==t?"scope was added!":"scope was updated!")):this.toast.error("add"==t?"there was an issue adding scope!":"there was an issue updating scope!");case 7:case"end":return e.stop()}}),e,this)})))}},{key:"ngOnInit",value:function(){var e=this;this.subscriptions.form=this.form.valueChanges.subscribe((function(t){e.errors=e.formerror.validateForm(e.form,e.errors,!0)})),this.subscriptions.route=this.route.params.subscribe((function(t){e.mode=t.mode,e.scopeId=t.scopeId,"add"!=e.mode?e.get():e.load()}))}},{key:"ngOnDestroy",value:function(){this.subscriptions.form.unsubscribe(),this.subscriptions.route.unsubscribe()}}]),e}()).\u0275fac=function(e){return new(e||W)(C.Ob(I.a),C.Ob(w.a),C.Ob(I.b),C.Ob(T.a),C.Ob(L.a),C.Ob(V.a))},W.\u0275cmp=C.Ib({type:W,selectors:[["app-scope-editor"]],decls:33,vars:14,consts:[["color","primary"],[1,"page-label","spacer"],["mat-icon-button","","routerLink","/scopes"],["mode","indeterminate","color","accent",4,"ngIf"],[3,"formGroup","ngSubmit"],["appearance","outline"],["text-uppercase",""],["matInput","","type","text","name","description","placeholder","description","formControlName","description","required",""],[4,"ngIf"],["matInput","","type","url","name","url","placeholder","url","formControlName","url","required",""],["name","appId","placeholder","app","formControlName","appId","required",""],[3,"value",4,"ngFor","ngForOf"],["name","roles","placeholder","roles","formControlName","roles","required","","multiple",""],["type","submit","mat-flat-button","","color","primary"],["mode","indeterminate","color","accent"],[3,"value"]],template:function(e,t){1&e&&(C.Ub(0,"mat-toolbar",0),C.Ub(1,"div",1),C.yc(2),C.Tb(),C.Ub(3,"button",2),C.Ub(4,"mat-icon"),C.yc(5," close "),C.Tb(),C.Tb(),C.Tb(),C.xc(6,H,1,0,"mat-progress-bar",3),C.Ub(7,"form",4),C.cc("ngSubmit",(function(){return!t.form.invalid&&t.submit()})),C.Ub(8,"mat-form-field",5),C.Ub(9,"mat-label",6),C.yc(10," description "),C.Tb(),C.Pb(11,"input",7),C.xc(12,K,2,1,"mat-error",8),C.Tb(),C.Ub(13,"mat-form-field",5),C.Ub(14,"mat-label",6),C.yc(15," url "),C.Tb(),C.Pb(16,"input",9),C.xc(17,Q,2,1,"mat-error",8),C.Tb(),C.Ub(18,"mat-form-field",5),C.Ub(19,"mat-label",6),C.yc(20," app "),C.Tb(),C.Ub(21,"mat-select",10),C.xc(22,Z,2,2,"mat-option",11),C.hc(23,"orderBy"),C.Tb(),C.xc(24,B,2,1,"mat-error",8),C.Tb(),C.Ub(25,"mat-form-field",5),C.Ub(26,"mat-label",6),C.yc(27," roles "),C.Tb(),C.Ub(28,"mat-select",12),C.xc(29,X,2,2,"mat-option",11),C.Tb(),C.xc(30,Y,2,1,"mat-error",8),C.Tb(),C.Ub(31,"button",13),C.yc(32," submit "),C.Tb(),C.Tb()),2&e&&(C.Cb(2),C.Cc(" ","add"==t.mode?"add scope":""," ","copy"==t.mode?"copy scope":""," ","update"==t.mode?"update scope":""," "),C.Cb(4),C.nc("ngIf",t.loading),C.Cb(1),C.nc("formGroup",t.form),C.Cb(5),C.nc("ngIf",t.errors.description),C.Cb(5),C.nc("ngIf",t.errors.url),C.Cb(5),C.nc("ngForOf",C.jc(23,11,t.apps,"name")),C.Cb(2),C.nc("ngIf",t.errors.appId),C.Cb(5),C.nc("ngForOf",t.roles),C.Cb(1),C.nc("ngIf",t.errors.roles))},directives:[m.a,b.a,I.c,i.a,n.l,G.q,G.j,G.e,J.c,J.g,u.a,G.a,G.i,G.c,G.o,p.a,n.k,U.a,J.b,$.k],pipes:[E.a],styles:["form[_ngcontent-%COMP%]{width:400px;margin:auto}@media screen and (max-width:420px){form[_ngcontent-%COMP%]{width:calc(100% - 20px)}}"]}),W),re=[{path:"",component:N},{path:":mode",component:te},{path:":mode/:scopeId",component:te}],oe=((ee=function e(){_classCallCheck(this,e)}).\u0275mod=C.Mb({type:ee}),ee.\u0275inj=C.Lb({factory:function(e){return new(e||ee)},imports:[[I.e.forChild(re)],I.e]}),ee),ne=((z=function e(){_classCallCheck(this,e)}).\u0275mod=C.Mb({type:z}),z.\u0275inj=C.Lb({factory:function(e){return new(e||z)},imports:[[G.f,n.c,o.a,s.a,i.b,a.a,u.b,c.l,p.b,l.c,b.b,d.a,m.b,f.a,J.e,oe,G.n,k.c,U.b]]}),z)}}]);