"use strict";(self.webpackChunkauth=self.webpackChunkauth||[]).push([[316],{6316:($e,D,a)=>{a.r(D),a.d(D,{TokensPageModule:()=>Ge});var d=a(5861),T=a(4847),u=a(4999),_=a(7046),k=a(1444);class v{constructor(o){this.app={name:void 0,icon:void 0},this.token={scopes:void 0,expiry:void 0,timezone:void 0,description:void 0},this.role=0,this.apps=[],this.users=[],this.groups=[],this.disabled=!1,void 0!==o&&null!=o&&(void 0!==o.app&&null!=o.app&&(void 0!==o.app.icon&&null!=o.app.icon&&(this.app.icon=o.app.icon),void 0!==o.app.name&&null!=o.app.name&&(this.app.name=o.app.name)),void 0!==o.token&&null!=o.token&&(void 0!==o.token.scopes&&null!=o.token.scopes&&(this.token.scopes=o.token.scopes),void 0!==o.token.expiry&&null!=o.token.expiry&&(this.token.expiry=new Date(o.token.expiry)),void 0!==o.token.timezone&&null!=o.token.timezone&&(this.token.timezone=o.token.timezone),void 0!==o.token.description&&null!=o.token.description&&(this.token.description=o.token.description)),void 0!==o.role&&null!=o.role&&(this.role=o.role),void 0!==o.apps&&null!=o.apps&&(this.apps=o.apps.map(t=>new k.U(t))),void 0!==o.appId&&null!=o.appId&&(this.appId=o.appId),void 0!==o.users&&null!=o.users&&(this.users=o.users.map(t=>new k.U(t))),void 0!==o.groups&&null!=o.groups&&(this.groups=o.groups.map(t=>new k.U(t))),void 0!==o.device&&null!=o.device&&(this.device=o.device),void 0!==o.tokenId&&null!=o.tokenId&&(this.tokenId=o.tokenId),void 0!==o.disabled&&null!=o.disabled&&(this.disabled=o.disabled),void 0!==o.description&&null!=o.description&&(this.description=o.description))}}var l=a(3075),b=a(8966),e=a(5e3),C=a(5358),L=a(2109),I=a(4594),m=a(7322),Z=a(7423),A=a(5245),y=a(8863),f=a(9808),P=a(4107),N=a(508),O=a(1303),Y=a(5899),J=a(4014),q=a(3711);function E(i,o){1&i&&e._UZ(0,"mat-progress-bar",11)}function S(i,o){if(1&i&&(e.TgZ(0,"mat-option",12),e._uU(1),e.qZA()),2&i){const t=o.$implicit;e.Q6J("value",t.appId),e.xp6(1),e.hij(" ",t.name," ")}}function B(i,o){if(1&i&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.hij(" ",t.errors.appId," ")}}const R=function(i){return{name:i}};let $=(()=>{class i{constructor(t,n,r,s){this.apps=t,this.dialog=n,this.config=r,this.formerror=s,this.form=new l.cw({appId:new l.NI([])}),this.errors={appId:""},this.filter=new l.cw({app:new l.NI("")}),this.loading=!1,this.observers={}}load(){var t=this;return(0,d.Z)(function*(){t.loading=!0;const n=yield t.apps.list({filter:["name","appId"]});t.apps.data=n.ok?n.result.map(r=>new _.g(r)):[],void 0!==t.config.appId&&null!=t.config.appId&&t.form.controls.appId.setValue(t.config.appId),t.loading=!1})()}close(){var t=this;return(0,d.Z)(function*(){t.dialog.close(!1)})()}submit(){var t=this;return(0,d.Z)(function*(){t.dialog.close(t.form.value)})()}ngOnInit(){this.observers.form=this.form.valueChanges.subscribe(t=>{this.errors=this.formerror.validateForm(this.form,this.errors,!0)}),this.load()}ngOnDestroy(){this.observers.form.unsubscribe()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(C.b),e.Y36(b.so),e.Y36(b.WI),e.Y36(L.J))},i.\u0275cmp=e.Xpm({type:i,selectors:[["tokens-filter-dialog"]],decls:21,vars:13,consts:[[1,"spacer"],["mat-icon-button","",3,"click"],["mode","indeterminate",4,"ngIf"],[3,"formGroup","ngSubmit"],["appearance","outline"],["name","appId","formControlName","appId","multiple",""],[3,"formGroup"],["placeholderLabel","filter apps","noEntriesFoundLabel","no apps found","formControlName","app"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],["type","submit","color","primary","mat-flat-button",""],["mode","indeterminate"],[3,"value"]],template:function(t,n){1&t&&(e.TgZ(0,"mat-toolbar"),e.TgZ(1,"mat-label",0),e._uU(2," Filter Tokens "),e.qZA(),e.TgZ(3,"button",1),e.NdJ("click",function(){return n.close()}),e.TgZ(4,"mat-icon"),e._uU(5," close "),e.qZA(),e.qZA(),e.qZA(),e.TgZ(6,"mat-content"),e.YNc(7,E,1,0,"mat-progress-bar",2),e.TgZ(8,"form",3),e.NdJ("ngSubmit",function(){return!n.loading&&!n.form.invalid&&n.submit()}),e.TgZ(9,"mat-form-field",4),e.TgZ(10,"mat-label"),e._uU(11," App(s) "),e.qZA(),e.TgZ(12,"mat-select",5),e.TgZ(13,"mat-option",6),e._UZ(14,"ngx-mat-select-search",7),e.qZA(),e.YNc(15,S,2,2,"mat-option",8),e.ALo(16,"filterBy"),e.ALo(17,"orderBy"),e.qZA(),e.YNc(18,B,2,1,"mat-error",9),e.qZA(),e.TgZ(19,"button",10),e._uU(20," submit "),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(7),e.Q6J("ngIf",n.loading),e.xp6(1),e.Q6J("formGroup",n.form),e.xp6(5),e.Q6J("formGroup",n.filter),e.xp6(2),e.Q6J("ngForOf",e.xi3(16,5,e.xi3(17,8,n.apps.data,"name"),e.VKq(11,R,n.filter.value.app))),e.xp6(3),e.Q6J("ngIf",n.errors.appId))},directives:[I.Ye,m.hX,Z.lW,A.Hw,y.s,f.O5,l._Y,l.JL,l.sg,m.KE,P.gD,l.JJ,l.u,N.ey,O.nu,f.sg,Y.pW,m.TO],pipes:[J.g,q.T],styles:[".filter-dialog{width:500px!important}.filter-dialog .mat-dialog-container{padding:0!important}@media screen and (max-width: 600px){.filter-dialog .mat-dialog-container{top:0px;left:0px;right:0px;bottom:0px;z-index:5000;position:fixed;border-radius:0}}\n"],encapsulation:2}),i})();var H=a(3065),w=a(649),z=a(7563),F=a(8939),X=a(8188),g=a(6696),V=a(5167),U=a(213);class K{constructor(o,t){this._document=t;const n=this._textarea=this._document.createElement("textarea"),r=n.style;r.position="fixed",r.top=r.opacity="0",r.left="-999em",n.setAttribute("aria-hidden","true"),n.value=o,this._document.body.appendChild(n)}copy(){const o=this._textarea;let t=!1;try{if(o){const n=this._document.activeElement;o.select(),o.setSelectionRange(0,o.value.length),t=this._document.execCommand("copy"),n&&n.focus()}}catch(n){}return t}destroy(){const o=this._textarea;o&&(o.remove(),this._textarea=void 0)}}let W=(()=>{class i{constructor(t){this._document=t}copy(t){const n=this.beginCopy(t),r=n.copy();return n.destroy(),r}beginCopy(t){return new K(t,this._document)}}return i.\u0275fac=function(t){return new(t||i)(e.LFG(f.K0))},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();var ee=a(7635),te=a(5277),ne=a(3322),h=a(4449),x=a(6688),Q=a(7238),oe=a(8712);function ie(i,o){1&i&&e._UZ(0,"mat-progress-bar",19)}function re(i,o){if(1&i){const t=e.EpF();e.TgZ(0,"mat-chip",22),e.NdJ("removed",function(){const s=e.CHM(t).$implicit;return e.oxw(2).unfilter("appId",s)}),e.TgZ(1,"mat-icon"),e._uU(2," apps "),e.qZA(),e.TgZ(3,"mat-label"),e._uU(4),e.ALo(5,"describe"),e.qZA(),e.TgZ(6,"mat-icon",23),e._uU(7," cancel "),e.qZA(),e.qZA()}if(2&i){const t=o.$implicit,n=e.oxw(2);e.xp6(4),e.hij(" ",e.gM2(5,1,n.apps.data,"appId",t,"name")," ")}}function ae(i,o){if(1&i&&(e.TgZ(0,"mat-chip-list",20),e.YNc(1,re,8,6,"mat-chip",21),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.filter.appId)}}function se(i,o){1&i&&(e.TgZ(0,"th",24),e._uU(1," Icon "),e.qZA())}function le(i,o){if(1&i&&(e.TgZ(0,"td",25),e._UZ(1,"img",26),e.qZA()),2&i){const t=o.$implicit;e.xp6(1),e.Q6J("src",t.app.icon,e.LSH)("alt",t.app.name)}}function de(i,o){1&i&&(e.TgZ(0,"th",27),e._uU(1," App Name "),e.qZA())}function pe(i,o){if(1&i&&(e.TgZ(0,"td",25),e._uU(1),e.qZA()),2&i){const t=o.$implicit;e.xp6(1),e.hij(" ",t.app.name," ")}}function ce(i,o){1&i&&(e.TgZ(0,"th",27),e._uU(1," Description "),e.qZA())}function ue(i,o){if(1&i&&(e.TgZ(0,"td",25),e._uU(1),e.qZA()),2&i){const t=o.$implicit;e.xp6(1),e.hij(" ",t.description," ")}}function fe(i,o){1&i&&(e.TgZ(0,"th",27),e._uU(1," Expiry "),e.qZA())}function me(i,o){if(1&i&&(e.TgZ(0,"td",25),e._uU(1),e.ALo(2,"date"),e.qZA()),2&i){const t=o.$implicit;e.xp6(1),e.hij(" ",e.xi3(2,1,t.token.expiry,"yyyy/MM/dd HH:mm")," ")}}function ge(i,o){1&i&&e._UZ(0,"th",24)}function he(i,o){if(1&i){const t=e.EpF();e.TgZ(0,"td",25),e.TgZ(1,"button",28),e.NdJ("click",function(r){const p=e.CHM(t).$implicit;return e.oxw().disable(r,p)}),e.TgZ(2,"mat-icon"),e._uU(3),e.qZA(),e.qZA(),e.qZA()}if(2&i){const t=o.$implicit,n=e.oxw();e.xp6(1),e.Q6J("disabled",n.tokenId==t.tokenId||t.role<2)("matTooltip",t.disabled?"Disabled":"Enabled"),e.xp6(2),e.hij(" ",t.disabled?"do_disturb_on":"check_circle"," ")}}function Te(i,o){1&i&&e._UZ(0,"tr",29)}function ve(i,o){if(1&i){const t=e.EpF();e.TgZ(0,"tr",30),e.NdJ("click",function(){const s=e.CHM(t).$implicit;return e.oxw().options(s)}),e.qZA()}}function Ze(i,o){if(1&i){const t=e.EpF();e.TgZ(0,"mat-list-item",31),e.NdJ("click",function(){const s=e.CHM(t).$implicit;return e.oxw().options(s)}),e._UZ(1,"img",32),e.TgZ(2,"mat-label"),e.TgZ(3,"h3"),e._uU(4),e.TgZ(5,"small"),e._uU(6),e.qZA(),e.qZA(),e.TgZ(7,"p"),e._uU(8),e.ALo(9,"date"),e.qZA(),e.qZA(),e.qZA()}if(2&i){const t=o.$implicit;e.xp6(1),e.Q6J("src",t.app.icon,e.LSH)("alt",t.app.name),e.xp6(3),e.hij(" ",t.description," "),e.xp6(2),e.hij(" ",t.app.name," "),e.xp6(2),e.hij(" ",e.xi3(9,5,t.token.expiry,"yyyy/MM/dd HH:mm")," ")}}const j=function(){return["icon","app.name","description","token.expiry","disabled"]};let ye=(()=>{class i{constructor(t,n,r,s,p,c,Le,Ee,Se,Be,Re){this.apps=t,this.toast=n,this.dialog=r,this.sheet=s,this.config=p,this.filters=c,this.router=Le,this.confirm=Ee,this.service=Se,this.clipboard=Be,this.localstorage=Re,this.sort=new T.YE,this.filter=this.filters.get({appId:[]}),this.tokens=new u.by,this.loading=!1,this.observers={}}list(){var t=this;return(0,d.Z)(function*(){t.loading=!0;const n=yield t.service.list({filter:["app","role","tokenId","disabled","description","token.expiry"],appId:t.filter.appId});t.tokens.data=n.ok?n.result.map(r=>new v(r)):[],t.loading=!1})()}load(){var t=this;return(0,d.Z)(function*(){t.loading=!0;const n=yield t.apps.list({filter:["name","appId"]});t.apps.data=n.ok?n.result.map(r=>new _.g(r)):[],t.loading=!1})()}OpenFilter(){var t=this;return(0,d.Z)(function*(){yield(yield t.dialog.open($,{data:t.filter,panelClass:"filter-dialog"})).afterClosed().subscribe(function(){var r=(0,d.Z)(function*(s){s&&(Object.keys(s).map(p=>{t.filter[p]=s[p]}),t.filters.update(t.filter),t.list())});return function(s){return r.apply(this,arguments)}}())})()}options(t){var n=this;return(0,d.Z)(function*(){var r;t.tokenId==n.tokenId?n.toast.show("This token has been locked as it is your current login token!"):n.sheet.show({role:t.role,title:t.description,options:[{icon:"launch",title:"View",handler:(r=(0,d.Z)(function*(){n.router.navigate(["/tokens","viewer"],{queryParams:{tokenId:t.tokenId}})}),function(){return r.apply(this,arguments)}),disabled:[0]},{icon:"content_copy",title:"Copy",handler:function(){var r=(0,d.Z)(function*(){n.loading=!0;const s=yield n.service.get({filter:["token"],tokenId:t.tokenId});s.ok?(n.clipboard.copy(JSON.stringify(s.result.token)),n.toast.show("Token was copied to clipboard!")):n.toast.show(s.error.message),n.loading=!1});return function(){return r.apply(this,arguments)}}(),disabled:[0,1]},{icon:"people",title:"Subscribers",handler:function(){var r=(0,d.Z)(function*(){n.router.navigate(["/subscribers","token",t.tokenId])});return function(){return r.apply(this,arguments)}}(),disabled:[0,1,2,3]},{icon:"remove",title:"Unubscribe",danger:!0,handler:function(){var r=(0,d.Z)(function*(){var s;n.confirm.show({message:"Are you sure you want to unsubscribe from "+t.description+"?",handler:(s=(0,d.Z)(function*(){n.loading=!0;const p=yield n.service.unsubscribe({id:n.localstorage.get("userId"),type:"user",tokenId:t.tokenId});if(p.ok){for(let c=0;c<n.tokens.data.length;c++)if(n.tokens.data[c].tokenId==t.tokenId){n.tokens.data.splice(c,1),n.toast.show("You were unsubscribed!");break}n.tokens.data=n.tokens.data.map(c=>new v(c))}else n.toast.show(p.error.message);n.loading=!1}),function(){return s.apply(this,arguments)})})});return function(){return r.apply(this,arguments)}}(),disabled:[5]},{icon:"delete",title:"Revoke",danger:!0,handler:function(){var r=(0,d.Z)(function*(){var s;n.confirm.show({message:"Are you sure you want to revoke "+t.description+"?",handler:(s=(0,d.Z)(function*(){n.loading=!0;const p=yield n.service.revoke({tokenId:t.tokenId});if(p.ok){for(let c=0;c<n.tokens.data.length;c++)if(n.tokens.data[c].tokenId==t.tokenId){n.tokens.data.splice(c,1),n.toast.show("Token was revoked!");break}n.tokens.data=n.tokens.data.map(c=>new v(c))}else n.toast.show(p.error.message);n.loading=!1}),function(){return s.apply(this,arguments)})})});return function(){return r.apply(this,arguments)}}(),disabled:[0,1,2,3,4]}]})})()}unfilter(t,n){this.filter[t]=this.filter[t].filter(r=>r!=n),this.filters.update(this.filter),this.list()}disable(t,n){var r=this;return(0,d.Z)(function*(){r.loading=!0,t.preventDefault(),t.stopPropagation();const s=yield r.service.update({tokenId:n.tokenId,disabled:!n.disabled});s.ok?n.disabled=!n.disabled:r.toast.show(s.error.message),r.loading=!1})()}ngOnInit(){var n,t=this;this.tokens.sort=this.sort,this.tokens.sort.active="expiry",this.tokens.sort.direction="desc",this.observers.loaded=this.config.loaded.subscribe(function(){var r=(0,d.Z)(function*(s){s&&(yield t.load(),yield t.list(),t.tokenId=t.localstorage.get("tokenId",null))});return function(s){return r.apply(this,arguments)}}()),this.observers.search=null===(n=this.search)||void 0===n?void 0:n.change.subscribe(r=>{this.tokens.filter=r})}ngOnDestroy(){var t,n;null===(t=this.observers.loaded)||void 0===t||t.unsubscribe(),null===(n=this.observers.search)||void 0===n||n.unsubscribe()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(C.b),e.Y36(w.k),e.Y36(b.uw),e.Y36(z.I),e.Y36(F.E),e.Y36(X.q),e.Y36(g.F0),e.Y36(V.z),e.Y36(U.H),e.Y36(W),e.Y36(ee.n))},i.\u0275cmp=e.Xpm({type:i,selectors:[["tokens-page"]],viewQuery:function(t,n){if(1&t&&(e.Gf(T.YE,7),e.Gf(H.g,7)),2&t){let r;e.iGM(r=e.CRH())&&(n.sort=r.first),e.iGM(r=e.CRH())&&(n.search=r.first)}},decls:34,vars:9,consts:[["for","users"],["placeholder","Filter users.."],["mat-icon-button","",3,"click"],["mode","indeterminate",4,"ngIf"],["class","filterbar",4,"ngIf"],["mat-table","","fxShow","","fxHide.xs","true","matSort","",3,"dataSource"],["matColumnDef","icon"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","app.name"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["matColumnDef","description"],["matColumnDef","token.expiry"],["matColumnDef","disabled"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",3,"click",4,"matRowDef","matRowDefColumns"],["fxHide","","fxShow.xs","true"],["lines","full","matRipple","",3,"click",4,"ngFor","ngForOf"],["mat-fab","","color","primary","routerLink","generate",1,"add-floating-button"],["mode","indeterminate"],[1,"filterbar"],[3,"removed",4,"ngFor","ngForOf"],[3,"removed"],["matChipRemove",""],["mat-header-cell",""],["mat-cell",""],["width","40","height","40","draggable","false",3,"src","alt"],["mat-header-cell","","mat-sort-header",""],["mat-icon-button","",3,"disabled","matTooltip","click"],["mat-header-row",""],["mat-row","",3,"click"],["lines","full","matRipple","",3,"click"],["slot","start","width","40","height","40","draggable","false",3,"src","alt"]],template:function(t,n){1&t&&(e.TgZ(0,"mat-toolbar"),e._UZ(1,"mat-menu-button"),e.TgZ(2,"label",0),e._uU(3," Users "),e.qZA(),e._UZ(4,"search",1),e.TgZ(5,"button",2),e.NdJ("click",function(){return n.OpenFilter()}),e.TgZ(6,"mat-icon"),e._uU(7," filter_list "),e.qZA(),e.qZA(),e.qZA(),e.YNc(8,ie,1,0,"mat-progress-bar",3),e.TgZ(9,"mat-content"),e.YNc(10,ae,2,1,"mat-chip-list",4),e.TgZ(11,"table",5),e.ynx(12,6),e.YNc(13,se,2,0,"th",7),e.YNc(14,le,2,2,"td",8),e.BQk(),e.ynx(15,9),e.YNc(16,de,2,0,"th",10),e.YNc(17,pe,2,1,"td",8),e.BQk(),e.ynx(18,11),e.YNc(19,ce,2,0,"th",10),e.YNc(20,ue,2,1,"td",8),e.BQk(),e.ynx(21,12),e.YNc(22,fe,2,0,"th",10),e.YNc(23,me,3,4,"td",8),e.BQk(),e.ynx(24,13),e.YNc(25,ge,1,0,"th",7),e.YNc(26,he,4,3,"td",8),e.BQk(),e.YNc(27,Te,1,0,"tr",14),e.YNc(28,ve,1,0,"tr",15),e.qZA(),e.TgZ(29,"mat-list",16),e.YNc(30,Ze,10,8,"mat-list-item",17),e.qZA(),e.qZA(),e.TgZ(31,"button",18),e.TgZ(32,"mat-icon"),e._uU(33," add "),e.qZA(),e.qZA()),2&t&&(e.xp6(8),e.Q6J("ngIf",n.loading),e.xp6(2),e.Q6J("ngIf",n.filter.appId.length>0),e.xp6(1),e.Q6J("dataSource",n.tokens),e.xp6(16),e.Q6J("matHeaderRowDef",e.DdM(7,j))("matHeaderRowDefSticky",!0),e.xp6(1),e.Q6J("matRowDefColumns",e.DdM(8,j)),e.xp6(2),e.Q6J("ngForOf",n.tokens.data))},directives:[I.Ye,te.v,H.g,Z.lW,A.Hw,f.O5,y.s,u.BZ,ne.b8,T.YE,u.w1,u.fO,u.Dz,u.as,u.nj,h.i$,f.sg,g.rH,Y.pW,x.qn,x.HS,m.hX,x.qH,u.ge,u.ev,T.nU,Q.gM,u.XQ,u.Gk,h.Tg],pipes:[oe.z,f.uU],styles:[".mat-column-icon[_ngcontent-%COMP%]{width:60px}.mat-column-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{margin-top:4px}.mat-column-expiry[_ngcontent-%COMP%]{width:150px}.mat-column-options[_ngcontent-%COMP%]{width:40px;padding-right:16px!important}.mat-column-disabled[_ngcontent-%COMP%]{width:40px}mat-list[_ngcontent-%COMP%]   mat-list-item[_ngcontent-%COMP%]{display:flex;align-items:center;flex-direction:row}"]}),i})();var M=a(7093);function xe(i,o){if(1&i&&e._UZ(0,"img",7),2&i){const t=e.oxw();e.Q6J("src",t.token.app.icon,e.LSH)("alt",t.token.app.name)}}function _e(i,o){if(1&i&&(e.TgZ(0,"mat-list-item"),e.TgZ(1,"mat-label",5),e.TgZ(2,"p"),e._uU(3),e.qZA(),e.qZA(),e.qZA()),2&i){const t=o.$implicit;e.xp6(3),e.hij(" ",t," ")}}let ke=(()=>{class i{constructor(t,n,r,s,p){this.toast=t,this.route=n,this.config=r,this.router=s,this.service=p,this.token=new v,this.loading=!1,this.observers={}}get(){var t=this;return(0,d.Z)(function*(){t.loading=!0;const n=yield t.service.get({filter:["app","appId","device","expiry","scopes","tokenId","description"],tokenId:t.tokenId});n.ok?t.token=new v(n.result):(t.toast.show(n.error.message),t.router.navigate(["/tokens"])),t.loading=!1})()}ngOnInit(){var t=this;this.observers.loaded=this.config.loaded.subscribe(function(){var n=(0,d.Z)(function*(r){r&&(t.tokenId=t.route.snapshot.queryParams.tokenId,t.get())});return function(r){return n.apply(this,arguments)}}())}ngOnDestroy(){var t;null===(t=this.observers.loaded)||void 0===t||t.unsubscribe()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(w.k),e.Y36(g.gz),e.Y36(F.E),e.Y36(g.F0),e.Y36(U.H))},i.\u0275cmp=e.Xpm({type:i,selectors:[["tokens-viewer-page"]],decls:27,vars:9,consts:[["fxLayout","row"],["fxFlex","50","fxFlexOffset","25","fxFlex.lg","70","fxFlexOffset.lg","15","fxFlex.md","80","fxFlexOffset.md","10","fxFlex.sm","90","fxFlexOffset.sm","5","fxFlex.xs","100","fxFlexOffset.xs","0"],["mat-subheader",""],["lines","full"],["slot","start","width","48","height","48","draggable","false",3,"src","alt",4,"ngIf"],[1,"spacer"],[4,"ngFor","ngForOf"],["slot","start","width","48","height","48","draggable","false",3,"src","alt"]],template:function(t,n){1&t&&(e.TgZ(0,"mat-content",0),e.TgZ(1,"mat-list",1),e.TgZ(2,"div",2),e._uU(3," App "),e.qZA(),e.TgZ(4,"mat-list-item",3),e.YNc(5,xe,1,2,"img",4),e.TgZ(6,"mat-label",5),e.TgZ(7,"h3"),e._uU(8),e.qZA(),e.TgZ(9,"p"),e._uU(10),e.qZA(),e.qZA(),e.qZA(),e.TgZ(11,"div",2),e._uU(12," Device "),e.qZA(),e.TgZ(13,"mat-list-item",3),e.TgZ(14,"mat-label",5),e.TgZ(15,"p"),e._uU(16),e.qZA(),e.qZA(),e.qZA(),e.TgZ(17,"div",2),e._uU(18," Expiry "),e.qZA(),e.TgZ(19,"mat-list-item",3),e.TgZ(20,"mat-label",5),e.TgZ(21,"p"),e._uU(22),e.ALo(23,"date"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(24,"div",2),e._uU(25," Scopes "),e.qZA(),e.YNc(26,_e,4,1,"mat-list-item",6),e.qZA(),e.qZA()),2&t&&(e.xp6(5),e.Q6J("ngIf",n.token.app.icon),e.xp6(3),e.hij(" ",n.token.app.name," "),e.xp6(2),e.hij(" ID: ",n.token.appId," "),e.xp6(6),e.hij(" ",n.token.device," "),e.xp6(6),e.hij(" ",e.xi3(23,6,n.token.token.expiry,"yyyy/MM/dd HH:mm")," "),e.xp6(4),e.Q6J("ngForOf",n.token.token.scopes))},directives:[y.s,M.xw,h.i$,M.yH,M.UT,h.gs,h.Tg,f.O5,m.hX,f.sg],pipes:[f.uU],styles:[""]}),i})();var G=a(8833),be=a(4080);function Ce(i,o){if(1&i&&(e.TgZ(0,"mat-option",10),e._uU(1),e.qZA()),2&i){const t=o.$implicit;e.Q6J("value",t.appId),e.xp6(1),e.hij(" ",t.name," ")}}function Ie(i,o){if(1&i&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.hij(" ",t.errors.appId," ")}}function Ae(i,o){if(1&i&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.hij(" ",t.errors.expiry," ")}}function Pe(i,o){if(1&i&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.hij(" ",t.errors.description," ")}}const Oe=function(i){return{name:i}};let Ye=(()=>{class i{constructor(t,n,r,s,p,c){this.apps=t,this.toast=n,this.route=r,this.config=s,this.router=p,this.service=c,this.form=new l.cw({appId:new l.NI(null,[l.kI.required]),expiry:new l.NI(null,[l.kI.required]),description:new l.NI(null,[l.kI.required])}),this.errors={appId:"",expiry:"",description:""},this.loading=!1,this.observers={}}load(){var t=this;return(0,d.Z)(function*(){t.loading=!0;const n=yield t.apps.list({filter:["role","name","icon","appId"],private:[!0,!1]});n.ok?t.apps.data=n.result.map(r=>new _.g(r)):(t.apps.data=[],t.toast.show(n.error.message)),t.loading=!1})()}submit(){var t=this;return(0,d.Z)(function*(){t.loading=!0;const n=yield t.service.generate({appId:t.form.value.appId,expiry:t.form.value.expiry,description:t.form.value.description});n.ok?t.router.navigate(["/tokens"]):t.toast.show(n.error.message),t.loading=!1})()}ngOnInit(){var t=this;this.observers.loaded=this.config.loaded.subscribe(function(){var n=(0,d.Z)(function*(r){r&&(yield t.load())});return function(r){return n.apply(this,arguments)}}())}ngOnDestroy(){var t;null===(t=this.observers.loaded)||void 0===t||t.unsubscribe()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(C.b),e.Y36(w.k),e.Y36(g.gz),e.Y36(F.E),e.Y36(g.F0),e.Y36(U.H))},i.\u0275cmp=e.Xpm({type:i,selectors:[["tokens-generate-page"]],decls:26,vars:14,consts:[[3,"formGroup","ngSubmit"],["appearance","outline"],["name","appId","placeholder","appId","formControlName","appId","required",""],["placeholderLabel","Filter apps...","noEntriesFoundLabel","There are no apps matching your query!"],["filter",""],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],["matInput","","type","datetime-local","name","expiry","format","YYYY-MM-DD HH:mm","placeholder","expiry","formControlName","expiry","required",""],["matInput","","type","text","name","description","placeholder","description","formControlName","description","required",""],["type","button","mat-flat-button","","color","primary",3,"disabled","click"],[3,"value"]],template:function(t,n){if(1&t&&(e.TgZ(0,"mat-content"),e.TgZ(1,"form",0),e.NdJ("ngSubmit",function(){return!n.loading&&!n.form.invalid&&n.submit()}),e.TgZ(2,"mat-form-field",1),e.TgZ(3,"mat-label"),e._uU(4," App "),e.qZA(),e.TgZ(5,"mat-select",2),e.TgZ(6,"mat-option"),e._UZ(7,"ngx-mat-select-search",3,4),e.qZA(),e.YNc(9,Ce,2,2,"mat-option",5),e.ALo(10,"filterBy"),e.ALo(11,"orderBy"),e.qZA(),e.YNc(12,Ie,2,1,"mat-error",6),e.qZA(),e.TgZ(13,"mat-form-field",1),e.TgZ(14,"mat-label"),e._uU(15," Expiry "),e.qZA(),e._UZ(16,"input",7),e.YNc(17,Ae,2,1,"mat-error",6),e.qZA(),e.TgZ(18,"mat-form-field",1),e.TgZ(19,"mat-label"),e._uU(20," Description "),e.qZA(),e._UZ(21,"input",8),e.YNc(22,Pe,2,1,"mat-error",6),e.qZA(),e.qZA(),e.qZA(),e.TgZ(23,"mat-footer"),e.TgZ(24,"button",9),e.NdJ("click",function(){return!n.loading&&!n.form.invalid&&n.submit()}),e._uU(25," generate "),e.qZA(),e.qZA()),2&t){const r=e.MAs(8);e.xp6(1),e.Q6J("formGroup",n.form),e.xp6(8),e.Q6J("ngForOf",e.xi3(10,6,e.xi3(11,9,n.apps.data,"name"),e.VKq(12,Oe,r.value))),e.xp6(3),e.Q6J("ngIf",n.errors.appId),e.xp6(5),e.Q6J("ngIf",n.errors.expiry),e.xp6(5),e.Q6J("ngIf",n.errors.description),e.xp6(2),e.Q6J("disabled",n.form.invalid)}},directives:[y.s,l._Y,l.JL,l.sg,m.KE,m.hX,P.gD,l.JJ,l.u,l.Q7,N.ey,O.nu,f.sg,f.O5,G.Nt,l.Fj,be.A,Z.lW,m.TO],pipes:[J.g,q.T],styles:["[upload][_ngcontent-%COMP%]{width:100px;margin:auto;height:100px;border:2px solid transparent;display:flex;align-items:center;border-radius:100%;justify-content:center;background-color:#eee}[upload].required[_ngcontent-%COMP%]{border-color:red}mat-footer[_ngcontent-%COMP%], mat-content[_ngcontent-%COMP%]{display:flex;align-items:center;flex-direction:column}mat-footer[_ngcontent-%COMP%]   form[_ngcontent-%COMP%], mat-content[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{max-width:400px;margin-top:20px}mat-footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%], mat-content[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%;max-width:400px}mat-footer[_ngcontent-%COMP%]{justify-content:center}"]}),i})();var we=a(949),Fe=a(8248),Ue=a(2217),Me=a(7375),De=a(2155),Ne=a(2604),Je=a(4274),qe=a(1065),He=a(5612),Qe=a(5896);const je=[{path:"",component:ye},{path:"viewer",component:ke},{path:"generate",component:Ye}];let Ge=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[[l.u5,f.ez,we.t,h.ie,A.Ps,Fe._,T.JX,G.c,x.Hi,u.p0,Ue.l,Z.ot,P.LD,Me.M,De.o9,Ne.o,Je.X,I.g0,Q.AV,m.lN,qe.w,Qe.n,He.G,l.UX,Y.Cv,O.Co,g.Bz.forChild(je)]]}),i})()}}]);