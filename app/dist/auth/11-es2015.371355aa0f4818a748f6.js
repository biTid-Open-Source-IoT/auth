(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{"1Vod":function(t,e,r){"use strict";r.r(e),r.d(e,"AllowAccessModule",(function(){return T}));var s=r("ofXK"),i=r("NFeN"),o=r("qFsG"),a=r("d3UM"),n=r("bTqV"),c=r("/t3+"),p=r("kmnG"),l=r("mrSG"),m=r("3Pt+"),b=r("fXoL"),u=r("tyNb"),d=r("9ZKQ"),f=r("dWDE"),h=r("xyCQ"),g=r("WF9o"),w=r("Xa2L");function y(t,e){if(1&t&&b.Pb(0,"img",9),2&t){const t=b.gc();b.nc("src",t.app.icon,b.sc)}}function I(t,e){if(1&t&&(b.Ub(0,"h1"),b.yc(1),b.Tb()),2&t){const t=b.gc();b.Cb(1),b.Ac(" ",t.app.name," ")}}function C(t,e){if(1&t&&(b.Ub(0,"mat-error"),b.yc(1),b.Tb()),2&t){const t=b.gc();b.Cb(1),b.Ac(" ",t.errors.email," ")}}function x(t,e){if(1&t&&(b.Ub(0,"mat-error"),b.yc(1),b.Tb()),2&t){const t=b.gc();b.Cb(1),b.Ac(" ",t.errors.password," ")}}function v(t,e){1&t&&b.Pb(0,"mat-progress-spinner",10)}const O=[{path:"",component:(()=>{class t{constructor(t,e,r,s,i){this.route=t,this.toast=e,this.formerror=r,this.service=s,this.localstorage=i,this.form=new m.d({email:new m.b("",[m.p.email,m.p.required]),password:new m.b("",[m.p.required])}),this.errors={email:"",password:""},this.app={},this.subscriptions={}}load(){return Object(l.a)(this,void 0,void 0,(function*(){this.loading=!0;const t=yield this.service.load({filter:["icon","name","scopes"],appId:this.appId});this.loading=!1,t.ok?this.app=t.result:this.toast.error("issue loading app!")}))}submit(){return Object(l.a)(this,void 0,void 0,(function*(){this.loading=!0,this.form.disable();const t=new Date((new Date).setFullYear((new Date).getFullYear()+1)),e=yield this.service.allowaccess({appId:this.appId,email:this.form.value.email,expiry:t,scopes:this.app.scopes,password:this.form.value.password,description:this.app.name+" (LOGIN)"});this.form.enable(),this.loading=!1,e.ok?window.open(this.returl+"?_id="+e.result.tokenId+"&email="+this.form.value.email+"&appId="+this.appId,"_parent"):this.toast.error(e.error.message)}))}ngOnInit(){this.subscriptions.form=this.form.valueChanges.subscribe(t=>{this.errors=this.formerror.validateForm(this.form,this.errors,!0)}),this.subscriptions.route=this.route.queryParams.subscribe(t=>{this.appId=t.appId,this.returl=t.returl,void 0!==t.email&&(this.form.controls.email.setValue(t.email),this.localstorage.set("email",t.email)),this.load()})}ngOnDestroy(){this.subscriptions.form.unsubscribe(),this.subscriptions.route.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(b.Ob(u.a),b.Ob(d.a),b.Ob(f.a),b.Ob(h.a),b.Ob(g.a))},t.\u0275cmp=b.Ib({type:t,selectors:[["app-allow-access"]],decls:16,vars:7,consts:[[3,"formGroup","ngSubmit"],["alt","app icon",3,"src",4,"ngIf"],[4,"ngIf"],["appearance","outline"],["text-uppercase",""],["matInput","","type","email","name","email","placeholder","email","formControlName","email","required",""],["matInput","","type","password","name","password","placeholder","password","formControlName","password","required",""],["type","submit","mat-flat-button","","color","primary"],["mode","indeterminate","diameter","30",4,"ngIf"],["alt","app icon",3,"src"],["mode","indeterminate","diameter","30"]],template:function(t,e){1&t&&(b.Ub(0,"form",0),b.cc("ngSubmit",(function(){return!e.form.invalid&&!e.loading&&e.submit()})),b.xc(1,y,1,1,"img",1),b.xc(2,I,2,1,"h1",2),b.Ub(3,"mat-form-field",3),b.Ub(4,"mat-label",4),b.yc(5," Email "),b.Tb(),b.Pb(6,"input",5),b.xc(7,C,2,1,"mat-error",2),b.Tb(),b.Ub(8,"mat-form-field",3),b.Ub(9,"mat-label",4),b.yc(10," Password "),b.Tb(),b.Pb(11,"input",6),b.xc(12,x,2,1,"mat-error",2),b.Tb(),b.Ub(13,"button",7),b.yc(14),b.xc(15,v,1,0,"mat-progress-spinner",8),b.Tb(),b.Tb()),2&t&&(b.nc("formGroup",e.form),b.Cb(1),b.nc("ngIf",e.app.icon),b.Cb(1),b.nc("ngIf",e.app.name),b.Cb(5),b.nc("ngIf",e.errors.email),b.Cb(5),b.nc("ngIf",e.errors.password),b.Cb(2),b.Ac(" ",e.loading?"":"allow access"," "),b.Cb(1),b.nc("ngIf",e.loading))},directives:[m.q,m.j,m.e,s.l,p.c,p.g,o.a,m.a,m.i,m.c,m.o,n.a,p.b,w.a],styles:["img[_ngcontent-%COMP%]{width:100px;display:block;margin:25px auto}form[_ngcontent-%COMP%]{width:400px;margin:auto}form[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:20px;text-align:center;line-height:20px;font-weight:400;text-transform:uppercase}@media screen and (max-width:420px){form[_ngcontent-%COMP%]{width:calc(100% - 20px)}}"]}),t})()}];let P=(()=>{class t{}return t.\u0275mod=b.Mb({type:t}),t.\u0275inj=b.Lb({factory:function(e){return new(e||t)},imports:[[u.e.forChild(O)],u.e]}),t})(),T=(()=>{class t{}return t.\u0275mod=b.Mb({type:t}),t.\u0275inj=b.Lb({factory:function(e){return new(e||t)},imports:[[m.f,s.c,i.b,o.b,n.b,a.b,c.b,p.e,m.n,P,w.b]]}),t})()}}]);