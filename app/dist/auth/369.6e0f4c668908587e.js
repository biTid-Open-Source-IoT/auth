"use strict";(self.webpackChunkauth=self.webpackChunkauth||[]).push([[369],{4369:(dt,L,r)=>{r.r(L),r.d(L,{SubscribersPageModule:()=>lt});var f=r(5861),h=r(4999),m=r(3075),_=r(8966),e=r(5e3),U=r(5358),B=r(4733),H=r(7660),q=r(2109),S=r(4594),w=r(7423),Z=r(5245),v=r(9808),x=r(5899),N=r(8863),D=r(7093),A=r(7322),V=r(8833),ee=r(5664),E=r(3191),g=r(508),J=r(727),te=r(7579),ie=r(9770),T=r(6451),oe=r(9646),I=r(4968),Q=r(925),O=r(9776),W=r(4115),y=r(1159),ne=r(7429),ae=r(8675),P=r(3900),F=r(5698),k=r(9300),se=r(4004),le=r(8505),re=r(1005),de=r(226);const ue=["panel"];function ce(a,o){if(1&a&&(e.TgZ(0,"div",0,1),e.Hsn(2),e.qZA()),2&a){const t=o.id,i=e.oxw();e.Q6J("id",i.id)("ngClass",i._classList),e.uIk("aria-label",i.ariaLabel||null)("aria-labelledby",i._getPanelAriaLabelledby(t))}}const pe=["*"];let me=0;class fe{constructor(o,t){this.source=o,this.option=t}}const he=(0,g.Kr)(class{}),z=new e.OlP("mat-autocomplete-default-options",{providedIn:"root",factory:function ge(){return{autoActiveFirstOption:!1}}});let ye=(()=>{class a extends he{constructor(t,i,n,l){super(),this._changeDetectorRef=t,this._elementRef=i,this._activeOptionChanges=J.w0.EMPTY,this.showPanel=!1,this._isOpen=!1,this.displayWith=null,this.optionSelected=new e.vpe,this.opened=new e.vpe,this.closed=new e.vpe,this.optionActivated=new e.vpe,this._classList={},this.id="mat-autocomplete-"+me++,this.inertGroups=(null==l?void 0:l.SAFARI)||!1,this._autoActiveFirstOption=!!n.autoActiveFirstOption}get isOpen(){return this._isOpen&&this.showPanel}get autoActiveFirstOption(){return this._autoActiveFirstOption}set autoActiveFirstOption(t){this._autoActiveFirstOption=(0,E.Ig)(t)}set classList(t){this._classList=t&&t.length?(0,E.du)(t).reduce((i,n)=>(i[n]=!0,i),{}):{},this._setVisibilityClasses(this._classList),this._elementRef.nativeElement.className=""}ngAfterContentInit(){this._keyManager=new ee.s1(this.options).withWrap(),this._activeOptionChanges=this._keyManager.change.subscribe(t=>{this.isOpen&&this.optionActivated.emit({source:this,option:this.options.toArray()[t]||null})}),this._setVisibility()}ngOnDestroy(){this._activeOptionChanges.unsubscribe()}_setScrollTop(t){this.panel&&(this.panel.nativeElement.scrollTop=t)}_getScrollTop(){return this.panel?this.panel.nativeElement.scrollTop:0}_setVisibility(){this.showPanel=!!this.options.length,this._setVisibilityClasses(this._classList),this._changeDetectorRef.markForCheck()}_emitSelectEvent(t){const i=new fe(this,t);this.optionSelected.emit(i)}_getPanelAriaLabelledby(t){return this.ariaLabel?null:this.ariaLabelledby?(t?t+" ":"")+this.ariaLabelledby:t}_setVisibilityClasses(t){t[this._visibleClass]=this.showPanel,t[this._hiddenClass]=!this.showPanel}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(e.sBO),e.Y36(e.SBq),e.Y36(z),e.Y36(Q.t4))},a.\u0275dir=e.lG2({type:a,viewQuery:function(t,i){if(1&t&&(e.Gf(e.Rgc,7),e.Gf(ue,5)),2&t){let n;e.iGM(n=e.CRH())&&(i.template=n.first),e.iGM(n=e.CRH())&&(i.panel=n.first)}},inputs:{ariaLabel:["aria-label","ariaLabel"],ariaLabelledby:["aria-labelledby","ariaLabelledby"],displayWith:"displayWith",autoActiveFirstOption:"autoActiveFirstOption",panelWidth:"panelWidth",classList:["class","classList"]},outputs:{optionSelected:"optionSelected",opened:"opened",closed:"closed",optionActivated:"optionActivated"},features:[e.qOj]}),a})(),be=(()=>{class a extends ye{constructor(){super(...arguments),this._visibleClass="mat-autocomplete-visible",this._hiddenClass="mat-autocomplete-hidden"}}return a.\u0275fac=function(){let o;return function(i){return(o||(o=e.n5z(a)))(i||a)}}(),a.\u0275cmp=e.Xpm({type:a,selectors:[["mat-autocomplete"]],contentQueries:function(t,i,n){if(1&t&&(e.Suo(n,g.K7,5),e.Suo(n,g.ey,5)),2&t){let l;e.iGM(l=e.CRH())&&(i.optionGroups=l),e.iGM(l=e.CRH())&&(i.options=l)}},hostAttrs:[1,"mat-autocomplete"],inputs:{disableRipple:"disableRipple"},exportAs:["matAutocomplete"],features:[e._Bn([{provide:g.HF,useExisting:a}]),e.qOj],ngContentSelectors:pe,decls:1,vars:0,consts:[["role","listbox",1,"mat-autocomplete-panel",3,"id","ngClass"],["panel",""]],template:function(t,i){1&t&&(e.F$t(),e.YNc(0,ce,3,4,"ng-template"))},directives:[v.mk],styles:[".mat-autocomplete-panel{min-width:112px;max-width:280px;overflow:auto;-webkit-overflow-scrolling:touch;visibility:hidden;max-width:none;max-height:256px;position:relative;width:100%;border-bottom-left-radius:4px;border-bottom-right-radius:4px}.mat-autocomplete-panel.mat-autocomplete-visible{visibility:visible}.mat-autocomplete-panel.mat-autocomplete-hidden{visibility:hidden}.mat-autocomplete-panel-above .mat-autocomplete-panel{border-radius:0;border-top-left-radius:4px;border-top-right-radius:4px}.mat-autocomplete-panel .mat-divider-horizontal{margin-top:-1px}.cdk-high-contrast-active .mat-autocomplete-panel{outline:solid 1px}mat-autocomplete{display:none}\n"],encapsulation:2,changeDetection:0}),a})();const G=new e.OlP("mat-autocomplete-scroll-strategy"),_e={provide:G,deps:[O.aV],useFactory:function ve(a){return()=>a.scrollStrategies.reposition()}},Ae={provide:m.JU,useExisting:(0,e.Gpc)(()=>j),multi:!0};let Te=(()=>{class a{constructor(t,i,n,l,s,d,c,p,u,b,Y){this._element=t,this._overlay=i,this._viewContainerRef=n,this._zone=l,this._changeDetectorRef=s,this._dir=c,this._formField=p,this._document=u,this._viewportRuler=b,this._defaults=Y,this._componentDestroyed=!1,this._autocompleteDisabled=!1,this._manuallyFloatingLabel=!1,this._viewportSubscription=J.w0.EMPTY,this._canOpenOnNextFocus=!0,this._closeKeyEventStream=new te.x,this._windowBlurHandler=()=>{this._canOpenOnNextFocus=this._document.activeElement!==this._element.nativeElement||this.panelOpen},this._onChange=()=>{},this._onTouched=()=>{},this.position="auto",this.autocompleteAttribute="off",this._overlayAttached=!1,this.optionSelections=(0,ie.P)(()=>{const C=this.autocomplete?this.autocomplete.options:null;return C?C.changes.pipe((0,ae.O)(C),(0,P.w)(()=>(0,T.T)(...C.map(rt=>rt.onSelectionChange)))):this._zone.onStable.pipe((0,F.q)(1),(0,P.w)(()=>this.optionSelections))}),this._scrollStrategy=d}get autocompleteDisabled(){return this._autocompleteDisabled}set autocompleteDisabled(t){this._autocompleteDisabled=(0,E.Ig)(t)}ngAfterViewInit(){const t=this._getWindow();void 0!==t&&this._zone.runOutsideAngular(()=>t.addEventListener("blur",this._windowBlurHandler))}ngOnChanges(t){t.position&&this._positionStrategy&&(this._setStrategyPositions(this._positionStrategy),this.panelOpen&&this._overlayRef.updatePosition())}ngOnDestroy(){const t=this._getWindow();void 0!==t&&t.removeEventListener("blur",this._windowBlurHandler),this._viewportSubscription.unsubscribe(),this._componentDestroyed=!0,this._destroyPanel(),this._closeKeyEventStream.complete()}get panelOpen(){return this._overlayAttached&&this.autocomplete.showPanel}openPanel(){this._attachOverlay(),this._floatLabel()}closePanel(){this._resetLabel(),this._overlayAttached&&(this.panelOpen&&this._zone.run(()=>{this.autocomplete.closed.emit()}),this.autocomplete._isOpen=this._overlayAttached=!1,this._overlayRef&&this._overlayRef.hasAttached()&&(this._overlayRef.detach(),this._closingActionsSubscription.unsubscribe()),this._componentDestroyed||this._changeDetectorRef.detectChanges())}updatePosition(){this._overlayAttached&&this._overlayRef.updatePosition()}get panelClosingActions(){return(0,T.T)(this.optionSelections,this.autocomplete._keyManager.tabOut.pipe((0,k.h)(()=>this._overlayAttached)),this._closeKeyEventStream,this._getOutsideClickStream(),this._overlayRef?this._overlayRef.detachments().pipe((0,k.h)(()=>this._overlayAttached)):(0,oe.of)()).pipe((0,se.U)(t=>t instanceof g.rN?t:null))}get activeOption(){return this.autocomplete&&this.autocomplete._keyManager?this.autocomplete._keyManager.activeItem:null}_getOutsideClickStream(){return(0,T.T)((0,I.R)(this._document,"click"),(0,I.R)(this._document,"auxclick"),(0,I.R)(this._document,"touchend")).pipe((0,k.h)(t=>{const i=(0,Q.sA)(t),n=this._formField?this._formField._elementRef.nativeElement:null,l=this.connectedTo?this.connectedTo.elementRef.nativeElement:null;return this._overlayAttached&&i!==this._element.nativeElement&&this._document.activeElement!==this._element.nativeElement&&(!n||!n.contains(i))&&(!l||!l.contains(i))&&!!this._overlayRef&&!this._overlayRef.overlayElement.contains(i)}))}writeValue(t){Promise.resolve().then(()=>this._setTriggerValue(t))}registerOnChange(t){this._onChange=t}registerOnTouched(t){this._onTouched=t}setDisabledState(t){this._element.nativeElement.disabled=t}_handleKeydown(t){const i=t.keyCode,n=(0,y.Vb)(t);if(i===y.hY&&!n&&t.preventDefault(),this.activeOption&&i===y.K5&&this.panelOpen&&!n)this.activeOption._selectViaInteraction(),this._resetActiveItem(),t.preventDefault();else if(this.autocomplete){const l=this.autocomplete._keyManager.activeItem,s=i===y.LH||i===y.JH;i===y.Mf||s&&!n&&this.panelOpen?this.autocomplete._keyManager.onKeydown(t):s&&this._canOpen()&&this.openPanel(),(s||this.autocomplete._keyManager.activeItem!==l)&&this._scrollToOption(this.autocomplete._keyManager.activeItemIndex||0)}}_handleInput(t){let i=t.target,n=i.value;"number"===i.type&&(n=""==n?null:parseFloat(n)),this._previousValue!==n&&(this._previousValue=n,this._onChange(n),this._canOpen()&&this._document.activeElement===t.target&&this.openPanel())}_handleFocus(){this._canOpenOnNextFocus?this._canOpen()&&(this._previousValue=this._element.nativeElement.value,this._attachOverlay(),this._floatLabel(!0)):this._canOpenOnNextFocus=!0}_handleClick(){this._canOpen()&&!this.panelOpen&&this.openPanel()}_floatLabel(t=!1){this._formField&&"auto"===this._formField.floatLabel&&(t?this._formField._animateAndLockLabel():this._formField.floatLabel="always",this._manuallyFloatingLabel=!0)}_resetLabel(){this._manuallyFloatingLabel&&(this._formField.floatLabel="auto",this._manuallyFloatingLabel=!1)}_subscribeToClosingActions(){const t=this._zone.onStable.pipe((0,F.q)(1)),i=this.autocomplete.options.changes.pipe((0,le.b)(()=>this._positionStrategy.reapplyLastPosition()),(0,re.g)(0));return(0,T.T)(t,i).pipe((0,P.w)(()=>(this._zone.run(()=>{const n=this.panelOpen;this._resetActiveItem(),this.autocomplete._setVisibility(),this._changeDetectorRef.detectChanges(),this.panelOpen&&(this._overlayRef.updatePosition(),n!==this.panelOpen&&this.autocomplete.opened.emit())}),this.panelClosingActions)),(0,F.q)(1)).subscribe(n=>this._setValueAndClose(n))}_destroyPanel(){this._overlayRef&&(this.closePanel(),this._overlayRef.dispose(),this._overlayRef=null)}_setTriggerValue(t){const i=this.autocomplete&&this.autocomplete.displayWith?this.autocomplete.displayWith(t):t,n=null!=i?i:"";this._formField?this._formField._control.value=n:this._element.nativeElement.value=n,this._previousValue=n}_setValueAndClose(t){const i=t&&t.source;i&&(this._clearPreviousSelectedOption(i),this._setTriggerValue(i.value),this._onChange(i.value),this.autocomplete._emitSelectEvent(i),this._element.nativeElement.focus()),this.closePanel()}_clearPreviousSelectedOption(t){this.autocomplete.options.forEach(i=>{i!==t&&i.selected&&i.deselect()})}_attachOverlay(){var t;let i=this._overlayRef;i?(this._positionStrategy.setOrigin(this._getConnectedElement()),i.updateSize({width:this._getPanelWidth()})):(this._portal=new ne.UE(this.autocomplete.template,this._viewContainerRef,{id:null===(t=this._formField)||void 0===t?void 0:t.getLabelId()}),i=this._overlay.create(this._getOverlayConfig()),this._overlayRef=i,i.keydownEvents().subscribe(l=>{(l.keyCode===y.hY&&!(0,y.Vb)(l)||l.keyCode===y.LH&&(0,y.Vb)(l,"altKey"))&&(this._closeKeyEventStream.next(),this._resetActiveItem(),l.stopPropagation(),l.preventDefault())}),this._viewportSubscription=this._viewportRuler.change().subscribe(()=>{this.panelOpen&&i&&i.updateSize({width:this._getPanelWidth()})})),i&&!i.hasAttached()&&(i.attach(this._portal),this._closingActionsSubscription=this._subscribeToClosingActions());const n=this.panelOpen;this.autocomplete._setVisibility(),this.autocomplete._isOpen=this._overlayAttached=!0,this.panelOpen&&n!==this.panelOpen&&this.autocomplete.opened.emit()}_getOverlayConfig(){var t;return new O.X_({positionStrategy:this._getOverlayPosition(),scrollStrategy:this._scrollStrategy(),width:this._getPanelWidth(),direction:this._dir,panelClass:null===(t=this._defaults)||void 0===t?void 0:t.overlayPanelClass})}_getOverlayPosition(){const t=this._overlay.position().flexibleConnectedTo(this._getConnectedElement()).withFlexibleDimensions(!1).withPush(!1);return this._setStrategyPositions(t),this._positionStrategy=t,t}_setStrategyPositions(t){const i=[{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top"},{originX:"end",originY:"bottom",overlayX:"end",overlayY:"top"}],n=this._aboveClass,l=[{originX:"start",originY:"top",overlayX:"start",overlayY:"bottom",panelClass:n},{originX:"end",originY:"top",overlayX:"end",overlayY:"bottom",panelClass:n}];let s;s="above"===this.position?l:"below"===this.position?i:[...i,...l],t.withPositions(s)}_getConnectedElement(){return this.connectedTo?this.connectedTo.elementRef:this._formField?this._formField.getConnectedOverlayOrigin():this._element}_getPanelWidth(){return this.autocomplete.panelWidth||this._getHostWidth()}_getHostWidth(){return this._getConnectedElement().nativeElement.getBoundingClientRect().width}_resetActiveItem(){const t=this.autocomplete;t.autoActiveFirstOption?t._keyManager.setFirstItemActive():t._keyManager.setActiveItem(-1)}_canOpen(){const t=this._element.nativeElement;return!t.readOnly&&!t.disabled&&!this._autocompleteDisabled}_getWindow(){var t;return(null===(t=this._document)||void 0===t?void 0:t.defaultView)||window}_scrollToOption(t){const i=this.autocomplete,n=(0,g.CB)(t,i.options,i.optionGroups);if(0===t&&1===n)i._setScrollTop(0);else if(i.panel){const l=i.options.toArray()[t];if(l){const s=l._getHostElement(),d=(0,g.jH)(s.offsetTop,s.offsetHeight,i._getScrollTop(),i.panel.nativeElement.offsetHeight);i._setScrollTop(d)}}}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(e.SBq),e.Y36(O.aV),e.Y36(e.s_b),e.Y36(e.R0b),e.Y36(e.sBO),e.Y36(G),e.Y36(de.Is,8),e.Y36(A.G_,9),e.Y36(v.K0,8),e.Y36(W.rL),e.Y36(z,8))},a.\u0275dir=e.lG2({type:a,inputs:{autocomplete:["matAutocomplete","autocomplete"],position:["matAutocompletePosition","position"],connectedTo:["matAutocompleteConnectedTo","connectedTo"],autocompleteAttribute:["autocomplete","autocompleteAttribute"],autocompleteDisabled:["matAutocompleteDisabled","autocompleteDisabled"]},features:[e.TTD]}),a})(),j=(()=>{class a extends Te{constructor(){super(...arguments),this._aboveClass="mat-autocomplete-panel-above"}}return a.\u0275fac=function(){let o;return function(i){return(o||(o=e.n5z(a)))(i||a)}}(),a.\u0275dir=e.lG2({type:a,selectors:[["input","matAutocomplete",""],["textarea","matAutocomplete",""]],hostAttrs:[1,"mat-autocomplete-trigger"],hostVars:7,hostBindings:function(t,i){1&t&&e.NdJ("focusin",function(){return i._handleFocus()})("blur",function(){return i._onTouched()})("input",function(l){return i._handleInput(l)})("keydown",function(l){return i._handleKeydown(l)})("click",function(){return i._handleClick()}),2&t&&e.uIk("autocomplete",i.autocompleteAttribute)("role",i.autocompleteDisabled?null:"combobox")("aria-autocomplete",i.autocompleteDisabled?null:"list")("aria-activedescendant",i.panelOpen&&i.activeOption?i.activeOption.id:null)("aria-expanded",i.autocompleteDisabled?null:i.panelOpen.toString())("aria-owns",i.autocompleteDisabled||!i.panelOpen||null==i.autocomplete?null:i.autocomplete.id)("aria-haspopup",i.autocompleteDisabled?null:"listbox")},exportAs:["matAutocompleteTrigger"],features:[e._Bn([Ae]),e.qOj]}),a})(),Oe=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({providers:[_e],imports:[[O.U8,g.Ng,g.BQ,v.ez],W.ZD,g.Ng,g.BQ]}),a})(),X=(()=>{class a{constructor(t,i){this.el=t,this.renderer=i}ngOnChanges(){this.renderer.setStyle(this.el.nativeElement,"background-image",["url(",this.src,")"].join(""))}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(e.SBq),e.Y36(e.Qsj))},a.\u0275cmp=e.Xpm({type:a,selectors:[["mat-avatar"]],inputs:{src:"src"},features:[e.TTD],decls:0,vars:0,template:function(t,i){},styles:["mat-avatar{width:40px;height:40px;display:block;border-radius:100%;background-size:cover;background-color:#fafafa;background-repeat:no-repeat;background-position:center center}\n"],encapsulation:2}),a})();var K=r(4107),Me=r(4080),Ce=r(3711);function Se(a,o){1&a&&e._UZ(0,"mat-progress-bar",20)}function we(a,o){if(1&a){const t=e.EpF();e.TgZ(0,"mat-option",21),e.NdJ("click",function(){const l=e.CHM(t).$implicit;return e.oxw().setSearchValue(l.id)}),e._UZ(1,"mat-avatar",22),e._uU(2),e.qZA()}if(2&a){const t=o.$implicit;e.Q6J("value",t.description),e.xp6(1),e.Q6J("src",t.icon),e.xp6(1),e.hij(" ",t.description," ")}}function Ze(a,o){if(1&a&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),2&a){const t=e.oxw();e.xp6(1),e.hij(" ",t.errors.type," ")}}function xe(a,o){if(1&a&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),2&a){const t=e.oxw();e.xp6(1),e.hij(" ",t.errors.role," ")}}let De=(()=>{class a{constructor(t,i,n,l,s,d){this.apps=t,this.users=i,this.dialog=n,this.groups=l,this.config=s,this.formerror=d,this.form=new m.cw({id:new m.NI(null,[m.kI.required]),role:new m.NI(1,[m.kI.required]),type:new m.NI("app",[m.kI.required]),search:new m.NI(null)}),this.errors={id:"",role:"",type:"",search:""},this.options=[],this.loading=!1,this.searching=!1,this.observers={}}submit(){var t=this;return(0,f.Z)(function*(){delete t.form.value.search,t.form.controls.id.enable(),t.form.controls.type.enable(),t.form.controls.search.enable(),t.dialog.close(t.form.value)})()}search(){var t=this;return(0,f.Z)(function*(){t.searching=!0;let n,i={limit:5};switch(t.form.value.type){case"app":i.filter=["name","icon","appId"],i.name=t.form.value.search,i.private=[!0,!1],n=t.apps;break;case"user":i.filter=["name","userId","picture"],i.name=t.form.value.search,n=t.users;break;case"group":i.filter=["groupId","description"],i.private=[!0,!1],i.description=t.form.value.search,n=t.groups}const l=yield n.list(i);if(l.ok)switch(t.form.value.type){case"app":t.options=l.result.map(s=>({id:s.appId,icon:s.icon,description:s.name}));break;case"user":t.options=l.result.map(s=>({id:s.userId,icon:s.picture,description:[s.name.first,s.name.last].join(" ")}));break;case"group":t.options=l.result.map(s=>({id:s.groupId,icon:"./assets/icons/icon-512x512.png",description:s.description}))}else t.options=[];t.searching=!1})()}setSearchValue(t){this.form.controls.id.setValue(t)}ngOnDestroy(){var t,i;null===(t=this.observers.form)||void 0===t||t.unsubscribe(),null===(i=this.observers.search)||void 0===i||i.unsubscribe()}ngAfterViewInit(){this.mode=this.config.mode;let t=this.config.accesor;"update"==this.config.mode&&(this.form.controls.id.setValue(null==t?void 0:t.id),this.form.controls.id.disable(),this.form.controls.type.setValue(null==t?void 0:t.type),this.form.controls.type.disable(),this.form.controls.role.setValue(null==t?void 0:t.role),this.form.controls.search.setValue(null==t?void 0:t.description),this.form.controls.search.disable()),this.observers.form=this.form.valueChanges.subscribe(i=>{this.errors=this.formerror.validateForm(this.form,this.errors,!0)}),this.observers.search=this.form.controls.search.valueChanges.subscribe(i=>{void 0!==i&&null!=i&&(null==i?void 0:i.length)>0?setTimeout(()=>this.search(),250):this.options=[]})}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(U.b),e.Y36(B.f),e.Y36(_.so),e.Y36(H.J),e.Y36(_.WI),e.Y36(q.J))},a.\u0275cmp=e.Xpm({type:a,selectors:[["subscribers-editor-dialog"]],decls:46,vars:16,consts:[["mat-icon-button","","mat-dialog-close",""],["for","subscriber editor"],["mode","indeterminate",4,"ngIf"],["fxLayout","row","fxLayoutAlign","center flex-start"],["fxFlex","60","fxFlex.lg","70","fxFlex.md","80","fxFlex.sm","90","fxFlex.xs","100",3,"formGroup","ngSubmit"],["appearance","outline"],["text-capitalize",""],["matInput","","type","text","placeholder","Start typing...","formControlName","search",3,"matAutocomplete"],["search","matAutocomplete"],[3,"value","click",4,"ngFor","ngForOf"],["name","type","placeholder","type","formControlName","type","required",""],["value","app"],["value","user"],["value","group"],[4,"ngIf"],["name","role","placeholder","role","formControlName","role","required",""],[3,"value"],["type","submit",2,"display","none"],["button",""],["type","button","mat-flat-button","","color","primary",3,"click"],["mode","indeterminate"],[3,"value","click"],[1,"autocomplete-item",3,"src"]],template:function(t,i){if(1&t){const n=e.EpF();e.TgZ(0,"mat-toolbar"),e.TgZ(1,"button",0),e.TgZ(2,"mat-icon"),e._uU(3," arrow_back "),e.qZA(),e.qZA(),e.TgZ(4,"label",1),e._uU(5),e.qZA(),e.qZA(),e.YNc(6,Se,1,0,"mat-progress-bar",2),e.TgZ(7,"mat-content",3),e.TgZ(8,"form",4),e.NdJ("ngSubmit",function(){return!i.loading&&!i.form.invalid&&i.submit()}),e.TgZ(9,"mat-form-field",5),e.TgZ(10,"mat-label",6),e._uU(11),e.qZA(),e._UZ(12,"input",7),e.TgZ(13,"mat-autocomplete",null,8),e.YNc(15,we,3,3,"mat-option",9),e.ALo(16,"orderBy"),e.qZA(),e.qZA(),e.TgZ(17,"mat-form-field",5),e.TgZ(18,"mat-label"),e._uU(19," Type "),e.qZA(),e.TgZ(20,"mat-select",10),e.TgZ(21,"mat-option",11),e._uU(22," App "),e.qZA(),e.TgZ(23,"mat-option",12),e._uU(24," User "),e.qZA(),e.TgZ(25,"mat-option",13),e._uU(26," Group "),e.qZA(),e.qZA(),e.YNc(27,Ze,2,1,"mat-error",14),e.qZA(),e.TgZ(28,"mat-form-field",5),e.TgZ(29,"mat-label"),e._uU(30," Role "),e.qZA(),e.TgZ(31,"mat-select",15),e.TgZ(32,"mat-option",16),e._uU(33," Read "),e.qZA(),e.TgZ(34,"mat-option",16),e._uU(35," Write "),e.qZA(),e.TgZ(36,"mat-option",16),e._uU(37," Read/Write "),e.qZA(),e.TgZ(38,"mat-option",16),e._uU(39," Admin "),e.qZA(),e.qZA(),e.YNc(40,xe,2,1,"mat-error",14),e.qZA(),e._UZ(41,"button",17,18),e.qZA(),e.qZA(),e.TgZ(43,"mat-footer"),e.TgZ(44,"button",19),e.NdJ("click",function(){return e.CHM(n),e.MAs(42).click()}),e._uU(45," Submit "),e.qZA(),e.qZA()}if(2&t){const n=e.MAs(14);e.xp6(5),e.AsE(" ","add"==i.mode?"Add Subscriber":""," ","update"==i.mode?"Edit Subscriber":""," "),e.xp6(1),e.Q6J("ngIf",i.loading),e.xp6(2),e.Q6J("formGroup",i.form),e.xp6(3),e.hij(" Search ",i.form.value.type," "),e.xp6(1),e.Q6J("matAutocomplete",n),e.xp6(3),e.Q6J("ngForOf",e.xi3(16,13,i.options,"description")),e.xp6(12),e.Q6J("ngIf",i.errors.type),e.xp6(5),e.Q6J("value",1),e.xp6(2),e.Q6J("value",2),e.xp6(2),e.Q6J("value",3),e.xp6(2),e.Q6J("value",4),e.xp6(2),e.Q6J("ngIf",i.errors.role)}},directives:[S.Ye,w.lW,_.ZT,Z.Hw,v.O5,x.pW,N.s,D.xw,D.Wh,m._Y,m.JL,D.yH,m.sg,A.KE,A.hX,V.Nt,m.Fj,j,m.JJ,m.u,be,v.sg,g.ey,X,K.gD,m.Q7,A.TO,Me.A],pipes:[Ce.T],styles:[""]}),a})();var Ee=r(7046);class Ie{constructor(o){this.name={last:void 0,first:void 0,middle:void 0},this.number={tel:void 0,mobile:void 0},this.address={billing:{company:{vat:void 0,reg:void 0},street:void 0,suburb:void 0,country:void 0,cityTown:void 0,additional:void 0,postalCode:void 0},physical:{company:{vat:void 0,reg:void 0},street:void 0,suburb:void 0,country:void 0,cityTown:void 0,additional:void 0,postalCode:void 0},same:void 0},this.identification={type:void 0,number:void 0},void 0!==o&&null!=o&&(void 0!==o.name&&null!=o.name&&(void 0!==o.name.last&&null!=o.name.last&&(this.name.last=o.name.last),void 0!==o.name.first&&null!=o.name.first&&(this.name.first=o.name.first),void 0!==o.name.middle&&null!=o.name.middle&&(this.name.middle=o.name.middle)),void 0!==o.number&&null!=o.number&&(void 0!==o.number.tel&&null!=o.number.tel&&(this.number.tel=o.number.tel),void 0!==o.number.mobile&&null!=o.number.mobile&&(this.number.mobile=o.number.mobile)),void 0!==o.address&&null!=o.address&&(void 0!==o.address.billing&&null!=o.address.billing&&(void 0!==o.address.billing.company&&null!=o.address.billing.company&&(void 0!==o.address.billing.company.vat&&null!=o.address.billing.company.vat&&(this.address.billing.company.vat=o.address.billing.company.vat),void 0!==o.address.billing.company.reg&&null!=o.address.billing.company.reg&&(this.address.billing.company.reg=o.address.billing.company.reg)),void 0!==o.address.billing.street&&null!=o.address.billing.street&&(this.address.billing.street=o.address.billing.street),void 0!==o.address.billing.suburb&&null!=o.address.billing.suburb&&(this.address.billing.suburb=o.address.billing.suburb),void 0!==o.address.billing.country&&null!=o.address.billing.country&&(this.address.billing.country=o.address.billing.country),void 0!==o.address.billing.cityTown&&null!=o.address.billing.cityTown&&(this.address.billing.cityTown=o.address.billing.cityTown),void 0!==o.address.billing.additional&&null!=o.address.billing.additional&&(this.address.billing.additional=o.address.billing.additional),void 0!==o.address.billing.postalCode&&null!=o.address.billing.postalCode&&(this.address.billing.postalCode=o.address.billing.postalCode)),void 0!==o.address.physical&&null!=o.address.physical&&(void 0!==o.address.physical.company&&null!=o.address.physical.company&&(void 0!==o.address.physical.company.vat&&null!=o.address.physical.company.vat&&(this.address.physical.company.vat=o.address.physical.company.vat),void 0!==o.address.physical.company.reg&&null!=o.address.physical.company.reg&&(this.address.physical.company.reg=o.address.physical.company.reg)),void 0!==o.address.physical.street&&null!=o.address.physical.street&&(this.address.physical.street=o.address.physical.street),void 0!==o.address.physical.suburb&&null!=o.address.physical.suburb&&(this.address.physical.suburb=o.address.physical.suburb),void 0!==o.address.physical.country&&null!=o.address.physical.country&&(this.address.physical.country=o.address.physical.country),void 0!==o.address.physical.cityTown&&null!=o.address.physical.cityTown&&(this.address.physical.cityTown=o.address.physical.cityTown),void 0!==o.address.physical.additional&&null!=o.address.physical.additional&&(this.address.physical.additional=o.address.physical.additional),void 0!==o.address.physical.postalCode&&null!=o.address.physical.postalCode&&(this.address.physical.postalCode=o.address.physical.postalCode)),void 0!==o.address.same&&null!=o.address.same&&(this.address.same=o.address.same)),void 0!==o.identification&&null!=o.identification&&(void 0!==o.identification.type&&null!=o.identification.type&&(this.identification.type=o.identification.type),void 0!==o.identification.number&&null!=o.identification.number&&(this.identification.number=o.identification.number)),void 0!==o.email&&null!=o.email&&(this.email=o.email),void 0!==o.userId&&null!=o.userId&&(this.userId=o.userId),void 0!==o.picture&&null!=o.picture&&(this.picture=o.picture),void 0!==o.language&&null!=o.language&&(this.language=o.language),void 0!==o.timezone&&null!=o.timezone&&(this.timezone=o.timezone),void 0!==o.username&&null!=o.username&&(this.username=o.username),void 0!==o.validated&&null!=o.validated&&(this.validated=o.validated))}}var Pe=r(5607),M=r(1444),Fe=r(213),ke=r(649),R=r(6696),Re=r(7563),Ye=r(8939),Le=r(5167),Ue=r(7756);function Be(a,o){1&a&&e._UZ(0,"mat-progress-bar",12)}function He(a,o){1&a&&e._UZ(0,"th",13)}function Ne(a,o){if(1&a&&(e.TgZ(0,"td",14),e._UZ(1,"mat-avatar",15),e.qZA()),2&a){const t=o.$implicit;e.xp6(1),e.Q6J("src",t.avatar)}}function Ve(a,o){1&a&&(e.TgZ(0,"th",13),e._uU(1," Description "),e.qZA())}function Je(a,o){if(1&a&&(e.TgZ(0,"td",14),e._uU(1),e.qZA()),2&a){const t=o.$implicit;e.xp6(1),e.hij(" ",t.description," ")}}function Qe(a,o){1&a&&(e.TgZ(0,"th",13),e._uU(1," Type "),e.qZA())}function We(a,o){if(1&a&&(e.TgZ(0,"td",14),e.TgZ(1,"span"),e._uU(2),e.qZA(),e.qZA()),2&a){const t=o.$implicit;e.xp6(1),e.Tol(t.type),e.xp6(1),e.hij(" ",t.type," ")}}function ze(a,o){1&a&&(e.TgZ(0,"th",13),e._uU(1," Role "),e.qZA())}function Ge(a,o){if(1&a&&(e.TgZ(0,"td",14),e._uU(1),e.qZA()),2&a){const t=o.$implicit;e.xp6(1),e.xDo(" ",1==t.role?"Read":""," ",2==t.role?"Write":""," ",3==t.role?"Write/Read":""," ",4==t.role?"Admin":""," ",5==t.role?"Owner":""," ")}}function je(a,o){1&a&&e._UZ(0,"tr",16)}function Xe(a,o){if(1&a){const t=e.EpF();e.TgZ(0,"tr",17),e.NdJ("click",function(){const l=e.CHM(t).$implicit;return e.oxw().options(l)}),e.qZA()}}const $=function(){return["avatar","description","type","role"]};let Ke=(()=>{class a{constructor(t,i,n,l,s,d,c,p,u,b,Y){this.apps=t,this.users=i,this.groups=n,this.tokens=l,this.dialog=s,this.toast=d,this.route=c,this.sheet=p,this.config=u,this.router=b,this.confirm=Y,this.id="unset",this.role=0,this.type="unset",this.table=new h.by,this.loading=!1,this.observers={}}get(){var t=this;return(0,f.Z)(function*(){t.loading=!0;let n,i={filter:["role","apps","users","groups"]};switch(t.type){case"app":n=t.apps,i.appId=t.id;break;case"group":n=t.groups,i.groupId=t.id;break;case"token":n=t.tokens,i.tokenId=t.id}const l=yield n.get(i);l.ok?(t.table.data=[],t.role=l.result.role,l.result.apps.map(s=>t.table.data.push({id:s.id,type:"app",role:s.role,avatar:"./assets/icons/icon-512x512.png",description:"-"})),l.result.users.map(s=>t.table.data.push({id:s.id,type:"user",role:s.role,avatar:"./assets/icons/icon-512x512.png",description:"-"})),l.result.groups.map(s=>t.table.data.push({id:s.id,type:"group",role:s.role,avatar:"./assets/icons/icon-512x512.png",description:"-"})),t.table.data=t.table.data.map(s=>new M.U(s))):t.toast.show(l.error.message),t.loading=!1})()}load(){var t=this;return(0,f.Z)(function*(){t.loading=!0;const i=yield t.apps.list({filter:["name","icon","appId"],appId:t.table.data.filter(s=>"app"==s.type).map(s=>s.id),private:[!0,!1]});i.ok?(t.apps.data=i.result.map(s=>new Ee.g(s)),t.apps.data.map(s=>{for(let d=0;d<t.table.data.length;d++)t.table.data[d].id==s.appId&&"app"==t.table.data[d].type&&(t.table.data[d].avatar=s.icon,t.table.data[d].description=s.name)})):t.apps.data=[];const n=yield t.users.list({filter:["name","userId","picture"],userId:t.table.data.filter(s=>"user"==s.type).map(s=>s.id)});n.ok?(t.users.data=n.result.map(s=>new Ie(s)),t.users.data.map(s=>{for(let d=0;d<t.table.data.length;d++)t.table.data[d].id==s.userId&&"user"==t.table.data[d].type&&(t.table.data[d].avatar=s.picture,t.table.data[d].description=[s.name.first,s.name.last].join(" "))})):t.users.data=[];const l=yield t.groups.list({filter:["groupId","description"],groupId:t.table.data.filter(s=>"group"==s.type).map(s=>s.id),private:[!0,!1]});l.ok?(t.groups.data=l.result.map(s=>new Pe.Z(s)),t.groups.data.map(s=>{for(let d=0;d<t.table.data.length;d++)t.table.data[d].id==s.groupId&&"group"==t.table.data[d].type&&(t.table.data[d].avatar="./assets/group.png",t.table.data[d].description=s.description)})):t.groups.data=[],t.loading=!1})()}options(t){var i=this;return(0,f.Z)(function*(){let n={edit:!1,delete:!1,makeOwner:!1};var l;(i.role<4||i.role<=t.role)&&(n.edit=!0,n.delete=!0),(i.role<5||5==t.role||"user"!=t.type)&&(n.makeOwner=!0),i.sheet.show({role:i.role,title:t.description,options:[{icon:"edit",title:"Edit",handler:(l=(0,f.Z)(function*(){return i.editor("update",t)}),function(){return l.apply(this,arguments)}),disabled:n.edit?[i.role]:[]},{icon:"remove",title:"Unsubscribe",danger:!0,handler:function(){var l=(0,f.Z)(function*(){var s;i.confirm.show({message:"Are you sure you want to unsubscribe "+t.description+"?",handler:(s=(0,f.Z)(function*(){i.loading=!0;let c,d={id:t.id,type:t.type};switch(i.type){case"app":c=i.apps,d.appId=i.id;break;case"group":c=i.groups,d.groupId=i.id;break;case"token":c=i.tokens,d.tokenId=i.id}const p=yield c.unsubscribe(d);if(p.ok)if(p.result.updated>0){for(let u=0;u<i.table.data.length;u++)if(i.table.data[u].id==t.id&&i.table.data[u].type==t.type){i.table.data.splice(u,1);break}i.table.data=i.table.data.map(u=>new M.U(u))}else i.toast.show("Accesor was not unsubscribed from "+i.type+"!");else i.toast.show(p.error.message);i.loading=!1}),function(){return s.apply(this,arguments)})})});return function(){return l.apply(this,arguments)}}(),disabled:n.delete?[i.role]:[]},{icon:"vpn_key",title:"Make Owner",danger:!0,handler:function(){var l=(0,f.Z)(function*(){var s;i.confirm.show({message:"Are you sure you want to change ownership to "+t.description+"?",handler:(s=(0,f.Z)(function*(){i.loading=!0;let c,d={id:t.id,type:t.type};switch(i.type){case"app":c=i.apps,d.appId=i.id;break;case"group":c=i.groups,d.groupId=i.id;break;case"token":c=i.tokens,d.tokenId=i.id}const p=yield c.changeowner(d);if(p.ok)if(p.result.updated>0){i.table.data.map(u=>{5==u.role&&(u.role=4)});for(let u=0;u<i.table.data.length;u++)if(i.table.data[u].id==t.id&&i.table.data[u].type==t.type){i.table.data[u].role=5;break}i.table.data=i.table.data.map(u=>new M.U(u))}else i.toast.show("Accesor was not set as owner on "+i.type+"!");else i.toast.show(p.error.message);i.loading=!1}),function(){return s.apply(this,arguments)})})});return function(){return l.apply(this,arguments)}}(),disabled:n.makeOwner?[i.role]:[]}]})})()}editor(t,i){var n=this;return(0,f.Z)(function*(){yield(yield n.dialog.open(De,{data:{id:n.id,mode:t,type:n.type,accesor:i},panelClass:"fullscreen-dialog"})).afterClosed().subscribe(function(){var s=(0,f.Z)(function*(d){if(d){if("add"==t){n.loading=!0;let p,c={id:d.id,type:d.type,role:d.role};switch(n.type){case"app":p=n.apps,c.appId=n.id;break;case"group":p=n.groups,c.groupId=n.id;break;case"token":p=n.tokens,c.tokenId=n.id}const u=yield p.share(c);u.ok?u.result.updated>0?(n.table.data.push({id:d.id,type:d.type,role:d.role,avatar:"-",description:"-"}),yield n.load()):n.toast.show("Accesor was not added to "+n.type+"!"):n.toast.show(u.error.message),n.loading=!1}else{n.loading=!0;let p,c={id:d.id,type:d.type,role:d.role};switch(n.type){case"app":p=n.apps,c.appId=n.id;break;case"group":p=n.groups,c.groupId=n.id;break;case"token":p=n.tokens,c.tokenId=n.id}const u=yield p.updatesubscriber(c);if(u.ok){for(let b=0;b<n.table.data.length;b++)if(n.table.data[b].id==(null==i?void 0:i.id)&&n.table.data[b].type==(null==i?void 0:i.type)){n.table.data[b].role=d.role;break}}else n.toast.show(u.error.message);n.loading=!1}n.table.data=n.table.data.map(c=>new M.U(c))}});return function(d){return s.apply(this,arguments)}}())})()}ngOnInit(){var t=this;this.observers.loaded=this.config.loaded.subscribe(function(){var i=(0,f.Z)(function*(n){if(n){const l=t.route.snapshot.params;t.id=l.id,t.type=l.type,yield t.get(),yield t.load()}});return function(n){return i.apply(this,arguments)}}())}ngOnDestroy(){var t;null===(t=this.observers.loaded)||void 0===t||t.unsubscribe()}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(U.b),e.Y36(B.f),e.Y36(H.J),e.Y36(Fe.H),e.Y36(_.uw),e.Y36(ke.k),e.Y36(R.gz),e.Y36(Re.I),e.Y36(Ye.E),e.Y36(R.F0),e.Y36(Le.z))},a.\u0275cmp=e.Xpm({type:a,selectors:[["subscribers-page"]],decls:24,vars:7,consts:[["for","subscribers"],["mode","indeterminate",4,"ngIf"],["mat-table","",3,"dataSource"],["matColumnDef","avatar"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","description"],["matColumnDef","type"],["matColumnDef","role"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",3,"click",4,"matRowDef","matRowDefColumns"],["mat-fab","","color","primary",1,"add-floating-button",3,"click"],["mode","indeterminate"],["mat-header-cell",""],["mat-cell",""],[3,"src"],["mat-header-row",""],["mat-row","",3,"click"]],template:function(t,i){1&t&&(e.TgZ(0,"mat-toolbar"),e._UZ(1,"mat-back-button"),e.TgZ(2,"label",0),e._uU(3," Subscribers "),e.qZA(),e.qZA(),e.YNc(4,Be,1,0,"mat-progress-bar",1),e.TgZ(5,"mat-content"),e.TgZ(6,"table",2),e.ynx(7,3),e.YNc(8,He,1,0,"th",4),e.YNc(9,Ne,2,1,"td",5),e.BQk(),e.ynx(10,6),e.YNc(11,Ve,2,0,"th",4),e.YNc(12,Je,2,1,"td",5),e.BQk(),e.ynx(13,7),e.YNc(14,Qe,2,0,"th",4),e.YNc(15,We,3,3,"td",5),e.BQk(),e.ynx(16,8),e.YNc(17,ze,2,0,"th",4),e.YNc(18,Ge,2,5,"td",5),e.BQk(),e.YNc(19,je,1,0,"tr",9),e.YNc(20,Xe,1,0,"tr",10),e.qZA(),e.qZA(),e.TgZ(21,"button",11),e.NdJ("click",function(){return i.editor("add")}),e.TgZ(22,"mat-icon"),e._uU(23," add "),e.qZA(),e.qZA()),2&t&&(e.xp6(4),e.Q6J("ngIf",i.loading),e.xp6(2),e.Q6J("dataSource",i.table),e.xp6(13),e.Q6J("matHeaderRowDef",e.DdM(5,$))("matHeaderRowDefSticky",!0),e.xp6(1),e.Q6J("matRowDefColumns",e.DdM(6,$)))},directives:[S.Ye,Ue.x,v.O5,x.pW,N.s,h.BZ,h.w1,h.fO,h.ge,h.Dz,h.ev,X,h.as,h.XQ,h.nj,h.Gk,w.lW,Z.Hw],styles:[".mat-column-avatar[_ngcontent-%COMP%]{width:60px}span[_ngcontent-%COMP%]{padding:4px 8px;font-size:12px;border-radius:12px;background-color:#fafafa}span.app[_ngcontent-%COMP%]{color:#fff;background-color:#f44336}span.user[_ngcontent-%COMP%]{color:#fff;background-color:#4caf50}span.group[_ngcontent-%COMP%]{color:#fff;background-color:#2196f3}"]}),a})();var $e=r(7375);let qe=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[[v.ez]]}),a})();var et=r(2217),tt=r(2604),it=r(2155),ot=r(4274),nt=r(1065),at=r(5896);const st=[{path:":type/:id",component:Ke}];let lt=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[[m.u5,v.ez,Z.Ps,h.p0,V.c,_.Is,qe,w.ot,et.l,K.LD,$e.M,tt.o,ot.X,S.g0,it.o9,nt.w,A.lN,at.n,m.UX,x.Cv,Oe,R.Bz.forChild(st)]]}),a})()}}]);