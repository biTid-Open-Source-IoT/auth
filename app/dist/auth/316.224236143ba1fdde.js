"use strict";(self.webpackChunkauth=self.webpackChunkauth||[]).push([[316],{6316:(ze,N,a)=>{a.r(N),a.d(N,{TokensPageModule:()=>Le});var d=a(5861),Z=a(4847),u=a(4999),b=a(7046),C=a(1444);class v{constructor(n){this.app={name:void 0,icon:void 0},this.token={scopes:void 0,expiry:void 0,timezone:void 0,description:void 0},this.role=0,this.apps=[],this.users=[],this.groups=[],this.disabled=!1,void 0!==n&&null!=n&&(void 0!==n.app&&null!=n.app&&(void 0!==n.app.icon&&null!=n.app.icon&&(this.app.icon=n.app.icon),void 0!==n.app.name&&null!=n.app.name&&(this.app.name=n.app.name)),void 0!==n.token&&null!=n.token&&(void 0!==n.token.scopes&&null!=n.token.scopes&&(this.token.scopes=n.token.scopes),void 0!==n.token.expiry&&null!=n.token.expiry&&(this.token.expiry=new Date(n.token.expiry)),void 0!==n.token.timezone&&null!=n.token.timezone&&(this.token.timezone=n.token.timezone),void 0!==n.token.description&&null!=n.token.description&&(this.token.description=n.token.description)),void 0!==n.role&&null!=n.role&&(this.role=n.role),void 0!==n.apps&&null!=n.apps&&(this.apps=n.apps.map(t=>new C.U(t))),void 0!==n.appId&&null!=n.appId&&(this.appId=n.appId),void 0!==n.users&&null!=n.users&&(this.users=n.users.map(t=>new C.U(t))),void 0!==n.groups&&null!=n.groups&&(this.groups=n.groups.map(t=>new C.U(t))),void 0!==n.device&&null!=n.device&&(this.device=n.device),void 0!==n.tokenId&&null!=n.tokenId&&(this.tokenId=n.tokenId),void 0!==n.disabled&&null!=n.disabled&&(this.disabled=n.disabled),void 0!==n.description&&null!=n.description&&(this.description=n.description))}}var l=a(3075),I=a(8966),e=a(5e3),A=a(5358),L=a(2109),y=a(4594),m=a(7322),x=a(7423),F=a(5245),k=a(8863),f=a(9808),Y=a(5899),P=a(4107),M=a(508),U=a(1303),J=a(4014),q=a(3711);function E(i,n){1&i&&e._UZ(0,"mat-progress-bar",11)}function S(i,n){if(1&i&&(e.TgZ(0,"mat-option",12),e._uU(1),e.qZA()),2&i){const t=n.$implicit;e.Q6J("value",t.appId),e.xp6(1),e.hij(" ",t.name," ")}}function B(i,n){if(1&i&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.hij(" ",t.errors.appId," ")}}const R=function(i){return{name:i}};let $=(()=>{class i{constructor(t,o,s,r){this.apps=t,this.dialog=o,this.config=s,this.formerror=r,this.form=new l.cw({appId:new l.NI([])}),this.errors={appId:""},this.filter=new l.cw({app:new l.NI("")}),this.loading=!1,this.observers={}}load(){var t=this;return(0,d.Z)(function*(){t.loading=!0;const o=yield t.apps.list({filter:["name","appId"]});t.apps.data=o.ok?o.result.map(s=>new b.g(s)):[],void 0!==t.config.appId&&null!=t.config.appId&&t.form.controls.appId.setValue(t.config.appId),t.loading=!1})()}close(){var t=this;return(0,d.Z)(function*(){t.dialog.close(!1)})()}submit(){var t=this;return(0,d.Z)(function*(){t.dialog.close(t.form.value)})()}ngOnInit(){this.observers.form=this.form.valueChanges.subscribe(t=>{this.errors=this.formerror.validateForm(this.form,this.errors,!0)}),this.load()}ngOnDestroy(){this.observers.form.unsubscribe()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(A.b),e.Y36(I.so),e.Y36(I.WI),e.Y36(L.J))},i.\u0275cmp=e.Xpm({type:i,selectors:[["tokens-filter-dialog"]],decls:21,vars:13,consts:[[1,"spacer"],["mat-icon-button","",3,"click"],["mode","indeterminate",4,"ngIf"],[3,"formGroup","ngSubmit"],["appearance","outline"],["name","appId","formControlName","appId","multiple",""],[3,"formGroup"],["placeholderLabel","filter apps","noEntriesFoundLabel","no apps found","formControlName","app"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],["type","submit","color","primary","mat-flat-button",""],["mode","indeterminate"],[3,"value"]],template:function(t,o){1&t&&(e.TgZ(0,"mat-toolbar"),e.TgZ(1,"mat-label",0),e._uU(2," Filter Tokens "),e.qZA(),e.TgZ(3,"button",1),e.NdJ("click",function(){return o.close()}),e.TgZ(4,"mat-icon"),e._uU(5," close "),e.qZA(),e.qZA(),e.qZA(),e.TgZ(6,"mat-content"),e.YNc(7,E,1,0,"mat-progress-bar",2),e.TgZ(8,"form",3),e.NdJ("ngSubmit",function(){return!o.loading&&!o.form.invalid&&o.submit()}),e.TgZ(9,"mat-form-field",4),e.TgZ(10,"mat-label"),e._uU(11," App(s) "),e.qZA(),e.TgZ(12,"mat-select",5),e.TgZ(13,"mat-option",6),e._UZ(14,"ngx-mat-select-search",7),e.qZA(),e.YNc(15,S,2,2,"mat-option",8),e.ALo(16,"filterBy"),e.ALo(17,"orderBy"),e.qZA(),e.YNc(18,B,2,1,"mat-error",9),e.qZA(),e.TgZ(19,"button",10),e._uU(20," submit "),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(7),e.Q6J("ngIf",o.loading),e.xp6(1),e.Q6J("formGroup",o.form),e.xp6(5),e.Q6J("formGroup",o.filter),e.xp6(2),e.Q6J("ngForOf",e.xi3(16,5,e.xi3(17,8,o.apps.data,"name"),e.VKq(11,R,o.filter.value.app))),e.xp6(3),e.Q6J("ngIf",o.errors.appId))},directives:[y.Ye,m.hX,x.lW,F.Hw,k.s,f.O5,Y.pW,l._Y,l.JL,l.sg,m.KE,P.gD,l.JJ,l.u,M.ey,U.nu,f.sg,m.TO],pipes:[J.g,q.T],styles:[".filter-dialog{width:500px!important}.filter-dialog .mat-dialog-container{padding:0!important}@media screen and (max-width: 600px){.filter-dialog .mat-dialog-container{top:0px;left:0px;right:0px;bottom:0px;z-index:5000;position:fixed;border-radius:0}}\n"],encapsulation:2}),i})();var H=a(3065),w=a(649),z=a(7563),D=a(8939),X=a(8188),g=a(6696),V=a(5167),O=a(213);class K{constructor(n,t){this._document=t;const o=this._textarea=this._document.createElement("textarea"),s=o.style;s.position="fixed",s.top=s.opacity="0",s.left="-999em",o.setAttribute("aria-hidden","true"),o.value=n,this._document.body.appendChild(o)}copy(){const n=this._textarea;let t=!1;try{if(n){const o=this._document.activeElement;n.select(),n.setSelectionRange(0,n.value.length),t=this._document.execCommand("copy"),o&&o.focus()}}catch(o){}return t}destroy(){const n=this._textarea;n&&(n.remove(),this._textarea=void 0)}}let W=(()=>{class i{constructor(t){this._document=t}copy(t){const o=this.beginCopy(t),s=o.copy();return o.destroy(),s}beginCopy(t){return new K(t,this._document)}}return i.\u0275fac=function(t){return new(t||i)(e.LFG(f.K0))},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();var ee=a(7635),te=a(5277),_=a(6688),oe=a(3322),Q=a(7238),h=a(4449),ne=a(8712);function ie(i,n){1&i&&e._UZ(0,"mat-progress-bar",19)}function se(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"mat-chip",22),e.NdJ("removed",function(){const r=e.CHM(t).$implicit;return e.oxw(2).unfilter("appId",r)}),e.TgZ(1,"mat-icon"),e._uU(2," apps "),e.qZA(),e.TgZ(3,"mat-label"),e._uU(4),e.ALo(5,"describe"),e.qZA(),e.TgZ(6,"mat-icon",23),e._uU(7," cancel "),e.qZA(),e.qZA()}if(2&i){const t=n.$implicit,o=e.oxw(2);e.xp6(4),e.hij(" ",e.gM2(5,1,o.apps.data,"appId",t,"name")," ")}}function ae(i,n){if(1&i&&(e.TgZ(0,"mat-chip-list",20),e.YNc(1,se,8,6,"mat-chip",21),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.filter.appId)}}function re(i,n){1&i&&(e.TgZ(0,"th",24),e._uU(1," Icon "),e.qZA())}function le(i,n){if(1&i&&(e.TgZ(0,"td",25),e._UZ(1,"img",26),e.qZA()),2&i){const t=n.$implicit;e.xp6(1),e.Q6J("src",t.app.icon,e.LSH)("alt",t.app.name)}}function pe(i,n){1&i&&(e.TgZ(0,"th",27),e._uU(1," App Name "),e.qZA())}function de(i,n){if(1&i&&(e.TgZ(0,"td",25),e._uU(1),e.qZA()),2&i){const t=n.$implicit;e.xp6(1),e.hij(" ",t.app.name," ")}}function ce(i,n){1&i&&(e.TgZ(0,"th",27),e._uU(1," Description "),e.qZA())}function ue(i,n){if(1&i&&(e.TgZ(0,"td",25),e._uU(1),e.qZA()),2&i){const t=n.$implicit;e.xp6(1),e.hij(" ",t.description," ")}}function fe(i,n){1&i&&(e.TgZ(0,"th",27),e._uU(1," Expiry "),e.qZA())}function me(i,n){if(1&i&&(e.TgZ(0,"td",25),e._uU(1),e.ALo(2,"date"),e.qZA()),2&i){const t=n.$implicit;e.xp6(1),e.hij(" ",e.xi3(2,1,t.token.expiry,"yyyy/MM/dd HH:mm")," ")}}function ge(i,n){1&i&&e._UZ(0,"th",24)}function he(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"td",25),e.TgZ(1,"button",28),e.NdJ("click",function(s){const p=e.CHM(t).$implicit;return e.oxw().disable(s,p)}),e.TgZ(2,"mat-icon"),e._uU(3),e.qZA(),e.qZA(),e.qZA()}if(2&i){const t=n.$implicit,o=e.oxw();e.xp6(1),e.Q6J("disabled",o.tokenId==t.tokenId||t.role<2)("matTooltip",t.disabled?"Disabled":"Enabled"),e.xp6(2),e.hij(" ",t.disabled?"do_disturb_on":"check_circle"," ")}}function Te(i,n){1&i&&e._UZ(0,"tr",29)}function Ze(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"tr",30),e.NdJ("click",function(){const r=e.CHM(t).$implicit;return e.oxw().options(r)}),e.qZA()}}function ve(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"mat-list-item",31),e.NdJ("click",function(){const r=e.CHM(t).$implicit;return e.oxw().options(r)}),e._UZ(1,"img",32),e.TgZ(2,"mat-label"),e.TgZ(3,"h3"),e._uU(4),e.TgZ(5,"small"),e._uU(6),e.qZA(),e.qZA(),e.TgZ(7,"p"),e._uU(8),e.ALo(9,"date"),e.qZA(),e.qZA(),e.qZA()}if(2&i){const t=n.$implicit;e.xp6(1),e.Q6J("src",t.app.icon,e.LSH)("alt",t.app.name),e.xp6(3),e.hij(" ",t.description," "),e.xp6(2),e.hij(" ",t.app.name," "),e.xp6(2),e.hij(" ",e.xi3(9,5,t.token.expiry,"yyyy/MM/dd HH:mm")," ")}}const G=function(){return["icon","app.name","description","token.expiry","disabled"]};let ye=(()=>{class i{constructor(t,o,s,r,p,c,Ee,Se,Be,Re,$e){this.apps=t,this.toast=o,this.dialog=s,this.sheet=r,this.config=p,this.filters=c,this.router=Ee,this.confirm=Se,this.service=Be,this.clipboard=Re,this.localstorage=$e,this.sort=new Z.YE,this.filter=this.filters.get({appId:[]}),this.tokens=new u.by,this.loading=!1,this.observers={}}list(){var t=this;return(0,d.Z)(function*(){t.loading=!0;const o=yield t.service.list({filter:["app","role","tokenId","disabled","description","token.expiry"],appId:t.filter.appId});t.tokens.data=o.ok?o.result.map(s=>new v(s)):[],t.loading=!1})()}load(){var t=this;return(0,d.Z)(function*(){t.loading=!0;const o=yield t.apps.list({filter:["name","appId"]});t.apps.data=o.ok?o.result.map(s=>new b.g(s)):[],t.loading=!1})()}OpenFilter(){var t=this;return(0,d.Z)(function*(){yield(yield t.dialog.open($,{data:t.filter,panelClass:"filter-dialog"})).afterClosed().subscribe(function(){var s=(0,d.Z)(function*(r){r&&(Object.keys(r).map(p=>{t.filter[p]=r[p]}),t.filters.update(t.filter),t.list())});return function(r){return s.apply(this,arguments)}}())})()}options(t){var o=this;return(0,d.Z)(function*(){var s;t.tokenId==o.tokenId?o.toast.show("This token has been locked as it is your current login token!"):o.sheet.show({role:t.role,title:t.description,options:[{icon:"launch",title:"View",handler:(s=(0,d.Z)(function*(){o.router.navigate(["/tokens","viewer"],{queryParams:{tokenId:t.tokenId}})}),function(){return s.apply(this,arguments)}),disabled:[0]},{icon:"content_copy",title:"Copy",handler:function(){var s=(0,d.Z)(function*(){o.loading=!0;const r=yield o.service.get({filter:["token"],tokenId:t.tokenId});r.ok?(o.clipboard.copy(JSON.stringify(r.result.token)),o.toast.show("Token was copied to clipboard!")):o.toast.show(r.error.message),o.loading=!1});return function(){return s.apply(this,arguments)}}(),disabled:[0,1]},{icon:"people",title:"Subscribers",handler:function(){var s=(0,d.Z)(function*(){o.router.navigate(["/subscribers","token",t.tokenId])});return function(){return s.apply(this,arguments)}}(),disabled:[0,1,2,3]},{icon:"remove",title:"Unubscribe",danger:!0,handler:function(){var s=(0,d.Z)(function*(){var r;o.confirm.show({message:"Are you sure you want to unsubscribe from "+t.description+"?",handler:(r=(0,d.Z)(function*(){o.loading=!0;const p=yield o.service.unsubscribe({id:o.localstorage.get("userId"),type:"user",tokenId:t.tokenId});if(p.ok){for(let c=0;c<o.tokens.data.length;c++)if(o.tokens.data[c].tokenId==t.tokenId){o.tokens.data.splice(c,1),o.toast.show("You were unsubscribed!");break}o.tokens.data=o.tokens.data.map(c=>new v(c))}else o.toast.show(p.error.message);o.loading=!1}),function(){return r.apply(this,arguments)})})});return function(){return s.apply(this,arguments)}}(),disabled:[5]},{icon:"delete",title:"Revoke",danger:!0,handler:function(){var s=(0,d.Z)(function*(){var r;o.confirm.show({message:"Are you sure you want to revoke "+t.description+"?",handler:(r=(0,d.Z)(function*(){o.loading=!0;const p=yield o.service.revoke({tokenId:t.tokenId});if(p.ok){for(let c=0;c<o.tokens.data.length;c++)if(o.tokens.data[c].tokenId==t.tokenId){o.tokens.data.splice(c,1),o.toast.show("Token was revoked!");break}o.tokens.data=o.tokens.data.map(c=>new v(c))}else o.toast.show(p.error.message);o.loading=!1}),function(){return r.apply(this,arguments)})})});return function(){return s.apply(this,arguments)}}(),disabled:[0,1,2,3,4]}]})})()}unfilter(t,o){this.filter[t]=this.filter[t].filter(s=>s!=o),this.filters.update(this.filter),this.list()}disable(t,o){var s=this;return(0,d.Z)(function*(){s.loading=!0,t.preventDefault(),t.stopPropagation();const r=yield s.service.update({tokenId:o.tokenId,disabled:!o.disabled});r.ok?o.disabled=!o.disabled:s.toast.show(r.error.message),s.loading=!1})()}ngOnInit(){var o,t=this;this.tokens.sort=this.sort,this.tokens.sort.active="expiry",this.tokens.sort.direction="desc",this.observers.loaded=this.config.loaded.subscribe(function(){var s=(0,d.Z)(function*(r){r&&(yield t.load(),yield t.list(),t.tokenId=t.localstorage.get("tokenId",null))});return function(r){return s.apply(this,arguments)}}()),this.observers.search=null===(o=this.search)||void 0===o?void 0:o.change.subscribe(s=>{this.tokens.filter=s})}ngOnDestroy(){var t,o;null===(t=this.observers.loaded)||void 0===t||t.unsubscribe(),null===(o=this.observers.search)||void 0===o||o.unsubscribe()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(A.b),e.Y36(w.k),e.Y36(I.uw),e.Y36(z.I),e.Y36(D.E),e.Y36(X.q),e.Y36(g.F0),e.Y36(V.z),e.Y36(O.H),e.Y36(W),e.Y36(ee.n))},i.\u0275cmp=e.Xpm({type:i,selectors:[["tokens-page"]],viewQuery:function(t,o){if(1&t&&(e.Gf(Z.YE,7),e.Gf(H.g,7)),2&t){let s;e.iGM(s=e.CRH())&&(o.sort=s.first),e.iGM(s=e.CRH())&&(o.search=s.first)}},decls:34,vars:9,consts:[["for","users"],["placeholder","Filter users.."],["mat-icon-button","",3,"click"],["mode","indeterminate",4,"ngIf"],["class","filterbar",4,"ngIf"],["mat-table","","fxShow","","fxHide.xs","true","matSort","",3,"dataSource"],["matColumnDef","icon"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","app.name"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["matColumnDef","description"],["matColumnDef","token.expiry"],["matColumnDef","disabled"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",3,"click",4,"matRowDef","matRowDefColumns"],["fxHide","","fxShow.xs","true"],["lines","full","matRipple","",3,"click",4,"ngFor","ngForOf"],["mat-fab","","color","primary","routerLink","generate",1,"add-floating-button"],["mode","indeterminate"],[1,"filterbar"],[3,"removed",4,"ngFor","ngForOf"],[3,"removed"],["matChipRemove",""],["mat-header-cell",""],["mat-cell",""],["width","40","height","40","draggable","false",3,"src","alt"],["mat-header-cell","","mat-sort-header",""],["mat-icon-button","",3,"disabled","matTooltip","click"],["mat-header-row",""],["mat-row","",3,"click"],["lines","full","matRipple","",3,"click"],["slot","start","width","40","height","40","draggable","false",3,"src","alt"]],template:function(t,o){1&t&&(e.TgZ(0,"mat-toolbar"),e._UZ(1,"mat-menu-button"),e.TgZ(2,"label",0),e._uU(3," Users "),e.qZA(),e._UZ(4,"search",1),e.TgZ(5,"button",2),e.NdJ("click",function(){return o.OpenFilter()}),e.TgZ(6,"mat-icon"),e._uU(7," filter_list "),e.qZA(),e.qZA(),e.qZA(),e.YNc(8,ie,1,0,"mat-progress-bar",3),e.TgZ(9,"mat-content"),e.YNc(10,ae,2,1,"mat-chip-list",4),e.TgZ(11,"table",5),e.ynx(12,6),e.YNc(13,re,2,0,"th",7),e.YNc(14,le,2,2,"td",8),e.BQk(),e.ynx(15,9),e.YNc(16,pe,2,0,"th",10),e.YNc(17,de,2,1,"td",8),e.BQk(),e.ynx(18,11),e.YNc(19,ce,2,0,"th",10),e.YNc(20,ue,2,1,"td",8),e.BQk(),e.ynx(21,12),e.YNc(22,fe,2,0,"th",10),e.YNc(23,me,3,4,"td",8),e.BQk(),e.ynx(24,13),e.YNc(25,ge,1,0,"th",7),e.YNc(26,he,4,3,"td",8),e.BQk(),e.YNc(27,Te,1,0,"tr",14),e.YNc(28,Ze,1,0,"tr",15),e.qZA(),e.TgZ(29,"mat-list",16),e.YNc(30,ve,10,8,"mat-list-item",17),e.qZA(),e.qZA(),e.TgZ(31,"button",18),e.TgZ(32,"mat-icon"),e._uU(33," add "),e.qZA(),e.qZA()),2&t&&(e.xp6(8),e.Q6J("ngIf",o.loading),e.xp6(2),e.Q6J("ngIf",o.filter.appId.length>0),e.xp6(1),e.Q6J("dataSource",o.tokens),e.xp6(16),e.Q6J("matHeaderRowDef",e.DdM(7,G))("matHeaderRowDefSticky",!0),e.xp6(1),e.Q6J("matRowDefColumns",e.DdM(8,G)),e.xp6(2),e.Q6J("ngForOf",o.tokens.data))},directives:[y.Ye,te.v,H.g,x.lW,F.Hw,f.O5,Y.pW,k.s,_.qn,f.sg,_.HS,m.hX,_.qH,u.BZ,oe.b8,Z.YE,u.w1,u.fO,u.ge,u.Dz,u.ev,Z.nU,Q.gM,u.as,u.XQ,u.nj,u.Gk,h.i$,h.Tg,g.rH],pipes:[ne.z,f.uU],styles:[".mat-column-icon[_ngcontent-%COMP%]{width:60px}.mat-column-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{margin-top:4px}.mat-column-expiry[_ngcontent-%COMP%]{width:150px}.mat-column-options[_ngcontent-%COMP%]{width:40px;padding-right:16px!important}.mat-column-disabled[_ngcontent-%COMP%]{width:40px}mat-list[_ngcontent-%COMP%]   mat-list-item[_ngcontent-%COMP%]{display:flex;align-items:center;flex-direction:row}"]}),i})();var T=a(7093);function xe(i,n){if(1&i&&e._UZ(0,"img",7),2&i){const t=e.oxw();e.Q6J("src",t.token.app.icon,e.LSH)("alt",t.token.app.name)}}function ke(i,n){if(1&i&&(e.TgZ(0,"mat-list-item"),e.TgZ(1,"mat-label",5),e.TgZ(2,"p"),e._uU(3),e.qZA(),e.qZA(),e.qZA()),2&i){const t=n.$implicit;e.xp6(3),e.hij(" ",t," ")}}let _e=(()=>{class i{constructor(t,o,s,r,p){this.toast=t,this.route=o,this.config=s,this.router=r,this.service=p,this.token=new v,this.loading=!1,this.observers={}}get(){var t=this;return(0,d.Z)(function*(){t.loading=!0;const o=yield t.service.get({filter:["app","appId","device","expiry","scopes","tokenId","description"],tokenId:t.tokenId});o.ok?t.token=new v(o.result):(t.toast.show(o.error.message),t.router.navigate(["/tokens"])),t.loading=!1})()}ngOnInit(){var t=this;this.observers.loaded=this.config.loaded.subscribe(function(){var o=(0,d.Z)(function*(s){s&&(t.tokenId=t.route.snapshot.queryParams.tokenId,t.get())});return function(s){return o.apply(this,arguments)}}())}ngOnDestroy(){var t;null===(t=this.observers.loaded)||void 0===t||t.unsubscribe()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(w.k),e.Y36(g.gz),e.Y36(D.E),e.Y36(g.F0),e.Y36(O.H))},i.\u0275cmp=e.Xpm({type:i,selectors:[["tokens-viewer-page"]],decls:27,vars:9,consts:[["fxLayout","row"],["fxFlex","50","fxFlexOffset","25","fxFlex.lg","70","fxFlexOffset.lg","15","fxFlex.md","80","fxFlexOffset.md","10","fxFlex.sm","90","fxFlexOffset.sm","5","fxFlex.xs","100","fxFlexOffset.xs","0"],["mat-subheader",""],["lines","full"],["slot","start","width","48","height","48","draggable","false",3,"src","alt",4,"ngIf"],[1,"spacer"],[4,"ngFor","ngForOf"],["slot","start","width","48","height","48","draggable","false",3,"src","alt"]],template:function(t,o){1&t&&(e.TgZ(0,"mat-content",0),e.TgZ(1,"mat-list",1),e.TgZ(2,"div",2),e._uU(3," App "),e.qZA(),e.TgZ(4,"mat-list-item",3),e.YNc(5,xe,1,2,"img",4),e.TgZ(6,"mat-label",5),e.TgZ(7,"h3"),e._uU(8),e.qZA(),e.TgZ(9,"p"),e._uU(10),e.qZA(),e.qZA(),e.qZA(),e.TgZ(11,"div",2),e._uU(12," Device "),e.qZA(),e.TgZ(13,"mat-list-item",3),e.TgZ(14,"mat-label",5),e.TgZ(15,"p"),e._uU(16),e.qZA(),e.qZA(),e.qZA(),e.TgZ(17,"div",2),e._uU(18," Expiry "),e.qZA(),e.TgZ(19,"mat-list-item",3),e.TgZ(20,"mat-label",5),e.TgZ(21,"p"),e._uU(22),e.ALo(23,"date"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(24,"div",2),e._uU(25," Scopes "),e.qZA(),e.YNc(26,ke,4,1,"mat-list-item",6),e.qZA(),e.qZA()),2&t&&(e.xp6(5),e.Q6J("ngIf",o.token.app.icon),e.xp6(3),e.hij(" ",o.token.app.name," "),e.xp6(2),e.hij(" ID: ",o.token.appId," "),e.xp6(6),e.hij(" ",o.token.device," "),e.xp6(6),e.hij(" ",e.xi3(23,6,o.token.token.expiry,"yyyy/MM/dd HH:mm")," "),e.xp6(4),e.Q6J("ngForOf",o.token.token.scopes))},directives:[k.s,T.xw,h.i$,T.yH,T.UT,h.gs,h.Tg,f.O5,m.hX,f.sg],pipes:[f.uU],styles:[""]}),i})();var be=a(7756),j=a(8833),Ce=a(4080);function Ie(i,n){if(1&i&&(e.TgZ(0,"mat-option",14),e._uU(1),e.qZA()),2&i){const t=n.$implicit;e.Q6J("value",t.appId),e.xp6(1),e.hij(" ",t.name," ")}}function Ae(i,n){if(1&i&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.hij(" ",t.errors.appId," ")}}function Fe(i,n){if(1&i&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.hij(" ",t.errors.expiry," ")}}function Ye(i,n){if(1&i&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.hij(" ",t.errors.description," ")}}const Pe=function(i){return{name:i}};let Ue=(()=>{class i{constructor(t,o,s,r,p,c){this.apps=t,this.toast=o,this.route=s,this.config=r,this.router=p,this.service=c,this.form=new l.cw({appId:new l.NI(null,[l.kI.required]),expiry:new l.NI(null,[l.kI.required]),description:new l.NI(null,[l.kI.required])}),this.errors={appId:"",expiry:"",description:""},this.loading=!1,this.observers={}}load(){var t=this;return(0,d.Z)(function*(){t.loading=!0;const o=yield t.apps.list({filter:["role","name","icon","appId"],private:[!0,!1]});o.ok?t.apps.data=o.result.map(s=>new b.g(s)):(t.apps.data=[],t.toast.show(o.error.message)),t.loading=!1})()}submit(){var t=this;return(0,d.Z)(function*(){t.loading=!0;const o=yield t.service.generate({appId:t.form.value.appId,expiry:t.form.value.expiry,description:t.form.value.description});o.ok?t.router.navigate(["/tokens"]):t.toast.show(o.error.message),t.loading=!1})()}ngOnInit(){var t=this;this.observers.loaded=this.config.loaded.subscribe(function(){var o=(0,d.Z)(function*(s){s&&(yield t.load())});return function(s){return o.apply(this,arguments)}}())}ngOnDestroy(){var t;null===(t=this.observers.loaded)||void 0===t||t.unsubscribe()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(A.b),e.Y36(w.k),e.Y36(g.gz),e.Y36(D.E),e.Y36(g.F0),e.Y36(O.H))},i.\u0275cmp=e.Xpm({type:i,selectors:[["tokens-generate-page"]],decls:32,vars:13,consts:[[1,"spacer"],["fxLayout","row","fxLayoutAlign","center flex-start"],["fxFlex","60","fxFlex.lg","70","fxFlex.md","80","fxFlex.sm","90","fxFlex.xs","100",3,"formGroup","ngSubmit"],["appearance","outline"],["name","appId","placeholder","appId","formControlName","appId","required",""],["placeholderLabel","Filter apps...","noEntriesFoundLabel","There are no apps matching your query!"],["filter",""],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],["matInput","","type","datetime-local","name","expiry","format","YYYY-MM-DD HH:mm","placeholder","expiry","formControlName","expiry","required",""],["matInput","","type","text","name","description","placeholder","description","formControlName","description","required",""],["type","submit",2,"display","none"],["button",""],["type","button","mat-flat-button","","color","primary",3,"click"],[3,"value"]],template:function(t,o){if(1&t){const s=e.EpF();e.TgZ(0,"mat-toolbar"),e._UZ(1,"mat-back-button"),e.TgZ(2,"label",0),e._uU(3," Generate Token "),e.qZA(),e.qZA(),e.TgZ(4,"mat-content",1),e.TgZ(5,"form",2),e.NdJ("ngSubmit",function(){return!o.loading&&!o.form.invalid&&o.submit()}),e.TgZ(6,"mat-form-field",3),e.TgZ(7,"mat-label"),e._uU(8," App "),e.qZA(),e.TgZ(9,"mat-select",4),e.TgZ(10,"mat-option"),e._UZ(11,"ngx-mat-select-search",5,6),e.qZA(),e.YNc(13,Ie,2,2,"mat-option",7),e.ALo(14,"filterBy"),e.ALo(15,"orderBy"),e.qZA(),e.YNc(16,Ae,2,1,"mat-error",8),e.qZA(),e.TgZ(17,"mat-form-field",3),e.TgZ(18,"mat-label"),e._uU(19," Expiry "),e.qZA(),e._UZ(20,"input",9),e.YNc(21,Fe,2,1,"mat-error",8),e.qZA(),e.TgZ(22,"mat-form-field",3),e.TgZ(23,"mat-label"),e._uU(24," Description "),e.qZA(),e._UZ(25,"input",10),e.YNc(26,Ye,2,1,"mat-error",8),e.qZA(),e._UZ(27,"button",11,12),e.qZA(),e.qZA(),e.TgZ(29,"mat-footer"),e.TgZ(30,"button",13),e.NdJ("click",function(){return e.CHM(s),e.MAs(28).click()}),e._uU(31," Generate "),e.qZA(),e.qZA()}if(2&t){const s=e.MAs(12);e.xp6(5),e.Q6J("formGroup",o.form),e.xp6(8),e.Q6J("ngForOf",e.xi3(14,5,e.xi3(15,8,o.apps.data,"name"),e.VKq(11,Pe,s.value))),e.xp6(3),e.Q6J("ngIf",o.errors.appId),e.xp6(5),e.Q6J("ngIf",o.errors.expiry),e.xp6(5),e.Q6J("ngIf",o.errors.description)}},directives:[y.Ye,be.x,k.s,T.xw,T.Wh,l._Y,l.JL,T.yH,l.sg,m.KE,m.hX,P.gD,l.JJ,l.u,l.Q7,M.ey,U.nu,f.sg,f.O5,m.TO,j.Nt,l.Fj,Ce.A,x.lW],pipes:[J.g,q.T],styles:[""]}),i})();var we=a(949),De=a(8248),Oe=a(2217),Ne=a(7375),Me=a(2155),Je=a(2604),qe=a(4274),He=a(1065),Qe=a(5612),Ge=a(5896);const je=[{path:"",component:ye},{path:"viewer",component:_e},{path:"generate",component:Ue}];let Le=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[[l.u5,f.ez,we.t,h.ie,F.Ps,De._,Z.JX,j.c,_.Hi,u.p0,Oe.l,x.ot,P.LD,Ne.M,Me.o9,Je.o,qe.X,y.g0,Q.AV,m.lN,He.w,Ge.n,Qe.G,l.UX,Y.Cv,U.Co,g.Bz.forChild(je)]]}),i})()}}]);