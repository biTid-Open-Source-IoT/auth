"use strict";(self.webpackChunkauth=self.webpackChunkauth||[]).push([[316],{6316:(ze,N,s)=>{s.r(N),s.d(N,{TokensPageModule:()=>Le});var p=s(5861),Z=s(4847),u=s(4999),b=s(7046),C=s(1444);class v{constructor(o){this.app={name:void 0,icon:void 0},this.token={scopes:void 0,expiry:void 0,timezone:void 0,description:void 0},this.role=0,this.apps=[],this.users=[],this.groups=[],this.disabled=!1,void 0!==o&&null!=o&&(void 0!==o.app&&null!=o.app&&(void 0!==o.app.icon&&null!=o.app.icon&&(this.app.icon=o.app.icon),void 0!==o.app.name&&null!=o.app.name&&(this.app.name=o.app.name)),void 0!==o.token&&null!=o.token&&(void 0!==o.token.scopes&&null!=o.token.scopes&&(this.token.scopes=o.token.scopes),void 0!==o.token.expiry&&null!=o.token.expiry&&(this.token.expiry=new Date(o.token.expiry)),void 0!==o.token.timezone&&null!=o.token.timezone&&(this.token.timezone=o.token.timezone),void 0!==o.token.description&&null!=o.token.description&&(this.token.description=o.token.description)),void 0!==o.role&&null!=o.role&&(this.role=o.role),void 0!==o.apps&&null!=o.apps&&(this.apps=o.apps.map(t=>new C.U(t))),void 0!==o.appId&&null!=o.appId&&(this.appId=o.appId),void 0!==o.users&&null!=o.users&&(this.users=o.users.map(t=>new C.U(t))),void 0!==o.groups&&null!=o.groups&&(this.groups=o.groups.map(t=>new C.U(t))),void 0!==o.device&&null!=o.device&&(this.device=o.device),void 0!==o.tokenId&&null!=o.tokenId&&(this.tokenId=o.tokenId),void 0!==o.disabled&&null!=o.disabled&&(this.disabled=o.disabled),void 0!==o.description&&null!=o.description&&(this.description=o.description))}}var l=s(3075),A=s(8966),e=s(5e3),I=s(5358),E=s(2109),y=s(4594),f=s(7322),x=s(7423),Y=s(5245),k=s(8863),m=s(9808),P=s(5899),U=s(4107),M=s(508),w=s(1303),q=s(4014),J=s(3711);function S(i,o){1&i&&e._UZ(0,"mat-progress-bar",11)}function B(i,o){if(1&i&&(e.TgZ(0,"mat-option",12),e._uU(1),e.qZA()),2&i){const t=o.$implicit;e.Q6J("value",t.appId),e.xp6(1),e.hij(" ",t.name," ")}}function R(i,o){if(1&i&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.hij(" ",t.errors.appId," ")}}const $=function(i){return{name:i}};let z=(()=>{class i{constructor(t,n,a,r){this.apps=t,this.dialog=n,this.config=a,this.formerror=r,this.form=new l.cw({appId:new l.NI([])}),this.errors={appId:""},this.filter=new l.cw({app:new l.NI("")}),this.loading=!1,this.observers={}}load(){var t=this;return(0,p.Z)(function*(){t.loading=!0;const n=yield t.apps.list({filter:["name","appId"]});t.apps.data=n.ok?n.result.map(a=>new b.g(a)):[],void 0!==t.config.appId&&null!=t.config.appId&&t.form.controls.appId.setValue(t.config.appId),t.loading=!1})()}close(){var t=this;return(0,p.Z)(function*(){t.dialog.close(!1)})()}submit(){var t=this;return(0,p.Z)(function*(){t.dialog.close(t.form.value)})()}ngOnInit(){this.observers.form=this.form.valueChanges.subscribe(t=>{this.errors=this.formerror.validateForm(this.form,this.errors,!0)}),this.load()}ngOnDestroy(){this.observers.form.unsubscribe()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(I.b),e.Y36(A.so),e.Y36(A.WI),e.Y36(E.J))},i.\u0275cmp=e.Xpm({type:i,selectors:[["tokens-filter-dialog"]],decls:21,vars:13,consts:[[1,"spacer"],["mat-icon-button","",3,"click"],["mode","indeterminate",4,"ngIf"],[3,"formGroup","ngSubmit"],["appearance","outline"],["name","appId","formControlName","appId","multiple",""],[3,"formGroup"],["placeholderLabel","filter apps","noEntriesFoundLabel","no apps found","formControlName","app"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],["type","submit","color","primary","mat-flat-button",""],["mode","indeterminate"],[3,"value"]],template:function(t,n){1&t&&(e.TgZ(0,"mat-toolbar"),e.TgZ(1,"mat-label",0),e._uU(2," Filter Tokens "),e.qZA(),e.TgZ(3,"button",1),e.NdJ("click",function(){return n.close()}),e.TgZ(4,"mat-icon"),e._uU(5," close "),e.qZA(),e.qZA(),e.qZA(),e.TgZ(6,"mat-content"),e.YNc(7,S,1,0,"mat-progress-bar",2),e.TgZ(8,"form",3),e.NdJ("ngSubmit",function(){return!n.loading&&!n.form.invalid&&n.submit()}),e.TgZ(9,"mat-form-field",4),e.TgZ(10,"mat-label"),e._uU(11," App(s) "),e.qZA(),e.TgZ(12,"mat-select",5),e.TgZ(13,"mat-option",6),e._UZ(14,"ngx-mat-select-search",7),e.qZA(),e.YNc(15,B,2,2,"mat-option",8),e.ALo(16,"filterBy"),e.ALo(17,"orderBy"),e.qZA(),e.YNc(18,R,2,1,"mat-error",9),e.qZA(),e.TgZ(19,"button",10),e._uU(20," submit "),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(7),e.Q6J("ngIf",n.loading),e.xp6(1),e.Q6J("formGroup",n.form),e.xp6(5),e.Q6J("formGroup",n.filter),e.xp6(2),e.Q6J("ngForOf",e.xi3(16,5,e.xi3(17,8,n.apps.data,"name"),e.VKq(11,$,n.filter.value.app))),e.xp6(3),e.Q6J("ngIf",n.errors.appId))},directives:[y.Ye,f.hX,x.lW,Y.Hw,k.s,m.O5,P.pW,l._Y,l.JL,l.sg,f.KE,U.gD,l.JJ,l.u,M.ey,w.nu,m.sg,f.TO],pipes:[q.g,J.T],styles:[".filter-dialog{width:500px!important}.filter-dialog .mat-dialog-container{padding:0!important}@media screen and (max-width: 600px){.filter-dialog .mat-dialog-container{inset:0;z-index:5000;position:fixed;border-radius:0}}\n"],encapsulation:2}),i})();var H=s(3065),F=s(649),V=s(7563),D=s(8939),X=s(8188),g=s(6696),K=s(5167),O=s(213);class W{constructor(o,t){this._document=t;const n=this._textarea=this._document.createElement("textarea"),a=n.style;a.position="fixed",a.top=a.opacity="0",a.left="-999em",n.setAttribute("aria-hidden","true"),n.value=o,this._document.body.appendChild(n)}copy(){const o=this._textarea;let t=!1;try{if(o){const n=this._document.activeElement;o.select(),o.setSelectionRange(0,o.value.length),t=this._document.execCommand("copy"),n&&n.focus()}}catch(n){}return t}destroy(){const o=this._textarea;o&&(o.remove(),this._textarea=void 0)}}let ee=(()=>{class i{constructor(t){this._document=t}copy(t){const n=this.beginCopy(t),a=n.copy();return n.destroy(),a}beginCopy(t){return new W(t,this._document)}}return i.\u0275fac=function(t){return new(t||i)(e.LFG(m.K0))},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();var te=s(7635),ne=s(5277),_=s(6688),oe=s(3322),Q=s(7238),h=s(4449),ie=s(8712);function ae(i,o){1&i&&e._UZ(0,"mat-progress-bar",19)}function se(i,o){if(1&i){const t=e.EpF();e.TgZ(0,"mat-chip",22),e.NdJ("removed",function(){const r=e.CHM(t).$implicit;return e.oxw(2).unfilter("appId",r)}),e.TgZ(1,"mat-icon"),e._uU(2," apps "),e.qZA(),e.TgZ(3,"mat-label"),e._uU(4),e.ALo(5,"describe"),e.qZA(),e.TgZ(6,"mat-icon",23),e._uU(7," cancel "),e.qZA(),e.qZA()}if(2&i){const t=o.$implicit,n=e.oxw(2);e.xp6(4),e.hij(" ",e.gM2(5,1,n.apps.data,"appId",t,"name")," ")}}function re(i,o){if(1&i&&(e.TgZ(0,"mat-chip-list",20),e.YNc(1,se,8,6,"mat-chip",21),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.filter.appId)}}function le(i,o){1&i&&(e.TgZ(0,"th",24),e._uU(1," Icon "),e.qZA())}function de(i,o){if(1&i&&(e.TgZ(0,"td",25),e._UZ(1,"img",26),e.qZA()),2&i){const t=o.$implicit;e.xp6(1),e.Q6J("src",t.app.icon,e.LSH)("alt",t.app.name)}}function pe(i,o){1&i&&(e.TgZ(0,"th",27),e._uU(1," App Name "),e.qZA())}function ce(i,o){if(1&i&&(e.TgZ(0,"td",25),e._uU(1),e.qZA()),2&i){const t=o.$implicit;e.xp6(1),e.hij(" ",t.app.name," ")}}function ue(i,o){1&i&&(e.TgZ(0,"th",27),e._uU(1," Description "),e.qZA())}function me(i,o){if(1&i&&(e.TgZ(0,"td",25),e._uU(1),e.qZA()),2&i){const t=o.$implicit;e.xp6(1),e.hij(" ",t.description," ")}}function fe(i,o){1&i&&(e.TgZ(0,"th",27),e._uU(1," Expiry "),e.qZA())}function ge(i,o){if(1&i&&(e.TgZ(0,"td",25),e._uU(1),e.ALo(2,"date"),e.qZA()),2&i){const t=o.$implicit;e.xp6(1),e.hij(" ",e.xi3(2,1,t.token.expiry,"yyyy/MM/dd HH:mm")," ")}}function he(i,o){1&i&&e._UZ(0,"th",24)}function Te(i,o){if(1&i){const t=e.EpF();e.TgZ(0,"td",25),e.TgZ(1,"button",28),e.NdJ("click",function(a){const d=e.CHM(t).$implicit;return e.oxw().disable(a,d)}),e.TgZ(2,"mat-icon"),e._uU(3),e.qZA(),e.qZA(),e.qZA()}if(2&i){const t=o.$implicit,n=e.oxw();e.xp6(1),e.Q6J("disabled",n.tokenId==t.tokenId||t.role<2)("matTooltip",t.disabled?"Disabled":"Enabled"),e.xp6(2),e.hij(" ",t.disabled?"do_disturb_on":"check_circle"," ")}}function Ze(i,o){1&i&&e._UZ(0,"tr",29)}function ve(i,o){if(1&i){const t=e.EpF();e.TgZ(0,"tr",30),e.NdJ("click",function(){const r=e.CHM(t).$implicit;return e.oxw().options(r)}),e.qZA()}}function ye(i,o){if(1&i){const t=e.EpF();e.TgZ(0,"mat-list-item",31),e.NdJ("click",function(){const r=e.CHM(t).$implicit;return e.oxw().options(r)}),e._UZ(1,"img",32),e.TgZ(2,"mat-label"),e.TgZ(3,"h3"),e._uU(4),e.TgZ(5,"small"),e._uU(6),e.qZA(),e.qZA(),e.TgZ(7,"p"),e._uU(8),e.ALo(9,"date"),e.qZA(),e.qZA(),e.qZA()}if(2&i){const t=o.$implicit;e.xp6(1),e.Q6J("src",t.app.icon,e.LSH)("alt",t.app.name),e.xp6(3),e.hij(" ",t.description," "),e.xp6(2),e.hij(" ",t.app.name," "),e.xp6(2),e.hij(" ",e.xi3(9,5,t.token.expiry,"yyyy/MM/dd HH:mm")," ")}}const G=function(){return["icon","app.name","description","token.expiry","disabled"]};let xe=(()=>{class i{constructor(t,n,a,r,d,c,Ee,Se,Be,Re,$e){this.apps=t,this.toast=n,this.dialog=a,this.sheet=r,this.config=d,this.filters=c,this.router=Ee,this.confirm=Se,this.service=Be,this.clipboard=Re,this.localstorage=$e,this.sort=new Z.YE,this.filter=this.filters.get({appId:[]}),this.tokens=new u.by,this.loading=!1,this.observers={}}list(){var t=this;return(0,p.Z)(function*(){t.loading=!0;const n=yield t.service.list({filter:["app","role","tokenId","disabled","description","token.expiry"],appId:t.filter.appId});t.tokens.data=n.ok?n.result.map(a=>new v(a)):[],t.loading=!1})()}load(){var t=this;return(0,p.Z)(function*(){t.loading=!0;const n=yield t.apps.list({filter:["name","appId"]});t.apps.data=n.ok?n.result.map(a=>new b.g(a)):[],t.loading=!1})()}OpenFilter(){var t=this;return(0,p.Z)(function*(){yield(yield t.dialog.open(z,{data:t.filter,panelClass:"filter-dialog"})).afterClosed().subscribe(function(){var a=(0,p.Z)(function*(r){r&&(Object.keys(r).map(d=>{t.filter[d]=r[d]}),t.filters.update(t.filter),t.list())});return function(r){return a.apply(this,arguments)}}())})()}options(t){var n=this;return(0,p.Z)(function*(){var a;t.tokenId==n.tokenId?n.toast.show("This token has been locked as it is your current login token!"):n.sheet.show({role:t.role,title:t.description,options:[{icon:"launch",title:"View",handler:(a=(0,p.Z)(function*(){n.router.navigate(["/tokens","viewer"],{queryParams:{tokenId:t.tokenId}})}),function(){return a.apply(this,arguments)}),disabled:[0]},{icon:"content_copy",title:"Copy",handler:function(){var a=(0,p.Z)(function*(){n.loading=!0;const r=yield n.service.get({filter:["token"],tokenId:t.tokenId});r.ok?(n.clipboard.copy(JSON.stringify(r.result.token)),n.toast.show("Token was copied to clipboard!")):n.toast.show(r.error.message),n.loading=!1});return function(){return a.apply(this,arguments)}}(),disabled:[0,1]},{icon:"people",title:"Subscribers",handler:function(){var a=(0,p.Z)(function*(){n.router.navigate(["/subscribers","token",t.tokenId])});return function(){return a.apply(this,arguments)}}(),disabled:[0,1,2,3]},{icon:"remove",title:"Unubscribe",danger:!0,handler:function(){var a=(0,p.Z)(function*(){var r;n.confirm.show({message:"Are you sure you want to unsubscribe from "+t.description+"?",handler:(r=(0,p.Z)(function*(){n.loading=!0;const d=yield n.service.unsubscribe({id:n.localstorage.get("userId"),type:"user",tokenId:t.tokenId});if(d.ok){for(let c=0;c<n.tokens.data.length;c++)if(n.tokens.data[c].tokenId==t.tokenId){n.tokens.data.splice(c,1),n.toast.show("You were unsubscribed!");break}n.tokens.data=n.tokens.data.map(c=>new v(c))}else n.toast.show(d.error.message);n.loading=!1}),function(){return r.apply(this,arguments)})})});return function(){return a.apply(this,arguments)}}(),disabled:[5]},{icon:"delete",title:"Revoke",danger:!0,handler:function(){var a=(0,p.Z)(function*(){var r;n.confirm.show({message:"Are you sure you want to revoke "+t.description+"?",handler:(r=(0,p.Z)(function*(){n.loading=!0;const d=yield n.service.revoke({tokenId:t.tokenId});if(d.ok){for(let c=0;c<n.tokens.data.length;c++)if(n.tokens.data[c].tokenId==t.tokenId){n.tokens.data.splice(c,1),n.toast.show("Token was revoked!");break}n.tokens.data=n.tokens.data.map(c=>new v(c))}else n.toast.show(d.error.message);n.loading=!1}),function(){return r.apply(this,arguments)})})});return function(){return a.apply(this,arguments)}}(),disabled:[0,1,2,3,4]}]})})()}unfilter(t,n){this.filter[t]=this.filter[t].filter(a=>a!=n),this.filters.update(this.filter),this.list()}disable(t,n){var a=this;return(0,p.Z)(function*(){a.loading=!0,t.preventDefault(),t.stopPropagation();const r=yield a.service.update({tokenId:n.tokenId,disabled:!n.disabled});r.ok?n.disabled=!n.disabled:a.toast.show(r.error.message),a.loading=!1})()}ngOnInit(){var n,t=this;this.tokens.sort=this.sort,this.tokens.sort.active="expiry",this.tokens.sort.direction="desc",this.observers.loaded=this.config.loaded.subscribe(function(){var a=(0,p.Z)(function*(r){r&&(yield t.load(),yield t.list(),t.tokenId=t.localstorage.get("tokenId",null))});return function(r){return a.apply(this,arguments)}}()),this.observers.search=null===(n=this.search)||void 0===n?void 0:n.change.subscribe(a=>{this.tokens.filter=a})}ngOnDestroy(){var t,n;null===(t=this.observers.loaded)||void 0===t||t.unsubscribe(),null===(n=this.observers.search)||void 0===n||n.unsubscribe()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(I.b),e.Y36(F.k),e.Y36(A.uw),e.Y36(V.I),e.Y36(D.E),e.Y36(X.q),e.Y36(g.F0),e.Y36(K.z),e.Y36(O.H),e.Y36(ee),e.Y36(te.n))},i.\u0275cmp=e.Xpm({type:i,selectors:[["tokens-page"]],viewQuery:function(t,n){if(1&t&&(e.Gf(Z.YE,7),e.Gf(H.g,7)),2&t){let a;e.iGM(a=e.CRH())&&(n.sort=a.first),e.iGM(a=e.CRH())&&(n.search=a.first)}},decls:34,vars:9,consts:[["for","tokens"],["placeholder","Filter tokens.."],["mat-icon-button","",3,"click"],["mode","indeterminate",4,"ngIf"],["class","filterbar",4,"ngIf"],["mat-table","","fxShow","","fxHide.xs","true","matSort","",3,"dataSource"],["matColumnDef","icon"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","app.name"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["matColumnDef","description"],["matColumnDef","token.expiry"],["matColumnDef","disabled"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",3,"click",4,"matRowDef","matRowDefColumns"],["fxHide","","fxShow.xs","true"],["lines","full","matRipple","",3,"click",4,"ngFor","ngForOf"],["mat-fab","","color","primary","routerLink","generate",1,"add-floating-button"],["mode","indeterminate"],[1,"filterbar"],[3,"removed",4,"ngFor","ngForOf"],[3,"removed"],["matChipRemove",""],["mat-header-cell",""],["mat-cell",""],["width","40","height","40","draggable","false",3,"src","alt"],["mat-header-cell","","mat-sort-header",""],["mat-icon-button","",3,"disabled","matTooltip","click"],["mat-header-row",""],["mat-row","",3,"click"],["lines","full","matRipple","",3,"click"],["slot","start","width","40","height","40","draggable","false",3,"src","alt"]],template:function(t,n){1&t&&(e.TgZ(0,"mat-toolbar"),e._UZ(1,"mat-menu-button"),e.TgZ(2,"label",0),e._uU(3," Tokens "),e.qZA(),e._UZ(4,"search",1),e.TgZ(5,"button",2),e.NdJ("click",function(){return n.OpenFilter()}),e.TgZ(6,"mat-icon"),e._uU(7," filter_list "),e.qZA(),e.qZA(),e.qZA(),e.YNc(8,ae,1,0,"mat-progress-bar",3),e.TgZ(9,"mat-content"),e.YNc(10,re,2,1,"mat-chip-list",4),e.TgZ(11,"table",5),e.ynx(12,6),e.YNc(13,le,2,0,"th",7),e.YNc(14,de,2,2,"td",8),e.BQk(),e.ynx(15,9),e.YNc(16,pe,2,0,"th",10),e.YNc(17,ce,2,1,"td",8),e.BQk(),e.ynx(18,11),e.YNc(19,ue,2,0,"th",10),e.YNc(20,me,2,1,"td",8),e.BQk(),e.ynx(21,12),e.YNc(22,fe,2,0,"th",10),e.YNc(23,ge,3,4,"td",8),e.BQk(),e.ynx(24,13),e.YNc(25,he,1,0,"th",7),e.YNc(26,Te,4,3,"td",8),e.BQk(),e.YNc(27,Ze,1,0,"tr",14),e.YNc(28,ve,1,0,"tr",15),e.qZA(),e.TgZ(29,"mat-list",16),e.YNc(30,ye,10,8,"mat-list-item",17),e.qZA(),e.qZA(),e.TgZ(31,"button",18),e.TgZ(32,"mat-icon"),e._uU(33," add "),e.qZA(),e.qZA()),2&t&&(e.xp6(8),e.Q6J("ngIf",n.loading),e.xp6(2),e.Q6J("ngIf",n.filter.appId.length>0),e.xp6(1),e.Q6J("dataSource",n.tokens),e.xp6(16),e.Q6J("matHeaderRowDef",e.DdM(7,G))("matHeaderRowDefSticky",!0),e.xp6(1),e.Q6J("matRowDefColumns",e.DdM(8,G)),e.xp6(2),e.Q6J("ngForOf",n.tokens.data))},directives:[y.Ye,ne.v,H.g,x.lW,Y.Hw,m.O5,P.pW,k.s,_.qn,m.sg,_.HS,f.hX,_.qH,u.BZ,oe.b8,Z.YE,u.w1,u.fO,u.ge,u.Dz,u.ev,Z.nU,Q.gM,u.as,u.XQ,u.nj,u.Gk,h.i$,h.Tg,g.rH],pipes:[ie.z,m.uU],styles:[".mat-column-icon[_ngcontent-%COMP%]{width:60px}.mat-column-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{margin-top:4px}.mat-column-expiry[_ngcontent-%COMP%]{width:150px}.mat-column-options[_ngcontent-%COMP%]{width:40px;padding-right:16px!important}.mat-column-disabled[_ngcontent-%COMP%]{width:40px}mat-list[_ngcontent-%COMP%]   mat-list-item[_ngcontent-%COMP%]{display:flex;align-items:center;flex-direction:row}"]}),i})();var j=s(7756),T=s(7093);function ke(i,o){if(1&i&&e._UZ(0,"img",9),2&i){const t=e.oxw();e.Q6J("src",t.token.app.icon,e.LSH)("alt",t.token.app.name)}}function _e(i,o){if(1&i&&(e.TgZ(0,"mat-list-item"),e.TgZ(1,"mat-label",6),e.TgZ(2,"p"),e._uU(3),e.qZA(),e.qZA(),e.qZA()),2&i){const t=o.$implicit;e.xp6(3),e.hij(" ",t," ")}}let be=(()=>{class i{constructor(t,n,a,r,d){this.toast=t,this.route=n,this.config=a,this.router=r,this.service=d,this.token=new v,this.loading=!1,this.observers={}}get(){var t=this;return(0,p.Z)(function*(){t.loading=!0;const n=yield t.service.get({filter:["app","appId","token","device","expiry","scopes","tokenId","description"],tokenId:t.tokenId});n.ok?t.token=new v(n.result):(t.toast.show(n.error.message),t.router.navigate(["/tokens"])),t.loading=!1})()}ngOnInit(){var t=this;this.observers.loaded=this.config.loaded.subscribe(function(){var n=(0,p.Z)(function*(a){a&&(t.tokenId=t.route.snapshot.queryParams.tokenId,t.get())});return function(a){return n.apply(this,arguments)}}())}ngOnDestroy(){var t;null===(t=this.observers.loaded)||void 0===t||t.unsubscribe()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(F.k),e.Y36(g.gz),e.Y36(D.E),e.Y36(g.F0),e.Y36(O.H))},i.\u0275cmp=e.Xpm({type:i,selectors:[["tokens-viewer-page"]],decls:31,vars:9,consts:[["for","view token"],["fxLayout","row","fxLayoutAlign","center flex-start"],["fxFlex","60","fxFlex.lg","70","fxFlex.md","80","fxFlex.sm","90","fxFlex.xs","100"],["mat-subheader",""],["lines","full",1,"details"],["slot","start","width","48","height","48","draggable","false",3,"src","alt",4,"ngIf"],[1,"spacer"],["lines","full"],[4,"ngFor","ngForOf"],["slot","start","width","48","height","48","draggable","false",3,"src","alt"]],template:function(t,n){1&t&&(e.TgZ(0,"mat-toolbar"),e._UZ(1,"mat-back-button"),e.TgZ(2,"label",0),e._uU(3," View Token "),e.qZA(),e.qZA(),e.TgZ(4,"mat-content",1),e.TgZ(5,"mat-list",2),e.TgZ(6,"div",3),e._uU(7," App "),e.qZA(),e.TgZ(8,"mat-list-item",4),e.YNc(9,ke,1,2,"img",5),e.TgZ(10,"mat-label",6),e.TgZ(11,"h3"),e._uU(12),e.qZA(),e.TgZ(13,"p"),e._uU(14),e.qZA(),e.qZA(),e.qZA(),e.TgZ(15,"div",3),e._uU(16," Device "),e.qZA(),e.TgZ(17,"mat-list-item",7),e.TgZ(18,"mat-label",6),e.TgZ(19,"p"),e._uU(20),e.qZA(),e.qZA(),e.qZA(),e.TgZ(21,"div",3),e._uU(22," Expiry "),e.qZA(),e.TgZ(23,"mat-list-item",7),e.TgZ(24,"mat-label",6),e.TgZ(25,"p"),e._uU(26),e.ALo(27,"date"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(28,"div",3),e._uU(29," Scopes "),e.qZA(),e.YNc(30,_e,4,1,"mat-list-item",8),e.qZA(),e.qZA()),2&t&&(e.xp6(9),e.Q6J("ngIf",n.token.app.icon),e.xp6(3),e.hij(" ",n.token.app.name," "),e.xp6(2),e.hij(" ID: ",n.token.appId," "),e.xp6(6),e.hij(" ",n.token.device," "),e.xp6(6),e.hij(" ",e.xi3(27,6,n.token.token.expiry,"yyyy/MM/dd HH:mm")," "),e.xp6(4),e.Q6J("ngForOf",n.token.token.scopes))},directives:[y.Ye,j.x,k.s,T.xw,T.Wh,h.i$,T.yH,h.gs,h.Tg,m.O5,f.hX,m.sg],pipes:[m.uU],styles:["[slot=start][_ngcontent-%COMP%]{margin-right:16px}.details[_ngcontent-%COMP%]{height:64px;margin:8px 0}"]}),i})();var L=s(8833),Ce=s(4080);function Ae(i,o){if(1&i&&(e.TgZ(0,"mat-option",14),e._uU(1),e.qZA()),2&i){const t=o.$implicit;e.Q6J("value",t.appId),e.xp6(1),e.hij(" ",t.name," ")}}function Ie(i,o){if(1&i&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.hij(" ",t.errors.appId," ")}}function Ye(i,o){if(1&i&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.hij(" ",t.errors.expiry," ")}}function Pe(i,o){if(1&i&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.hij(" ",t.errors.description," ")}}const Ue=function(i){return{name:i}};let we=(()=>{class i{constructor(t,n,a,r,d,c){this.apps=t,this.toast=n,this.route=a,this.config=r,this.router=d,this.service=c,this.form=new l.cw({appId:new l.NI(null,[l.kI.required]),expiry:new l.NI(null,[l.kI.required]),description:new l.NI(null,[l.kI.required])}),this.errors={appId:"",expiry:"",description:""},this.loading=!1,this.observers={}}load(){var t=this;return(0,p.Z)(function*(){t.loading=!0;const n=yield t.apps.list({filter:["role","name","icon","appId"],private:[!0,!1]});n.ok?t.apps.data=n.result.map(a=>new b.g(a)):(t.apps.data=[],t.toast.show(n.error.message)),t.loading=!1})()}submit(){var t=this;return(0,p.Z)(function*(){t.loading=!0;const n=yield t.service.generate({appId:t.form.value.appId,expiry:t.form.value.expiry,description:t.form.value.description});n.ok?t.router.navigate(["/tokens"]):t.toast.show(n.error.message),t.loading=!1})()}ngOnInit(){var t=this;this.observers.loaded=this.config.loaded.subscribe(function(){var n=(0,p.Z)(function*(a){a&&(yield t.load())});return function(a){return n.apply(this,arguments)}}())}ngOnDestroy(){var t;null===(t=this.observers.loaded)||void 0===t||t.unsubscribe()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(I.b),e.Y36(F.k),e.Y36(g.gz),e.Y36(D.E),e.Y36(g.F0),e.Y36(O.H))},i.\u0275cmp=e.Xpm({type:i,selectors:[["tokens-generate-page"]],decls:32,vars:13,consts:[[1,"spacer"],["fxLayout","row","fxLayoutAlign","center flex-start"],["fxFlex","60","fxFlex.lg","70","fxFlex.md","80","fxFlex.sm","90","fxFlex.xs","100",3,"formGroup","ngSubmit"],["appearance","outline"],["name","appId","placeholder","appId","formControlName","appId","required",""],["placeholderLabel","Filter apps...","noEntriesFoundLabel","There are no apps matching your query!"],["filter",""],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],["matInput","","type","datetime-local","name","expiry","format","YYYY-MM-DD HH:mm","placeholder","expiry","formControlName","expiry","required",""],["matInput","","type","text","name","description","placeholder","description","formControlName","description","required",""],["type","submit",2,"display","none"],["button",""],["type","button","mat-flat-button","","color","primary",3,"click"],[3,"value"]],template:function(t,n){if(1&t){const a=e.EpF();e.TgZ(0,"mat-toolbar"),e._UZ(1,"mat-back-button"),e.TgZ(2,"label",0),e._uU(3," Generate Token "),e.qZA(),e.qZA(),e.TgZ(4,"mat-content",1),e.TgZ(5,"form",2),e.NdJ("ngSubmit",function(){return!n.loading&&!n.form.invalid&&n.submit()}),e.TgZ(6,"mat-form-field",3),e.TgZ(7,"mat-label"),e._uU(8," App "),e.qZA(),e.TgZ(9,"mat-select",4),e.TgZ(10,"mat-option"),e._UZ(11,"ngx-mat-select-search",5,6),e.qZA(),e.YNc(13,Ae,2,2,"mat-option",7),e.ALo(14,"filterBy"),e.ALo(15,"orderBy"),e.qZA(),e.YNc(16,Ie,2,1,"mat-error",8),e.qZA(),e.TgZ(17,"mat-form-field",3),e.TgZ(18,"mat-label"),e._uU(19," Expiry "),e.qZA(),e._UZ(20,"input",9),e.YNc(21,Ye,2,1,"mat-error",8),e.qZA(),e.TgZ(22,"mat-form-field",3),e.TgZ(23,"mat-label"),e._uU(24," Description "),e.qZA(),e._UZ(25,"input",10),e.YNc(26,Pe,2,1,"mat-error",8),e.qZA(),e._UZ(27,"button",11,12),e.qZA(),e.qZA(),e.TgZ(29,"mat-footer"),e.TgZ(30,"button",13),e.NdJ("click",function(){return e.CHM(a),e.MAs(28).click()}),e._uU(31," Generate "),e.qZA(),e.qZA()}if(2&t){const a=e.MAs(12);e.xp6(5),e.Q6J("formGroup",n.form),e.xp6(8),e.Q6J("ngForOf",e.xi3(14,5,e.xi3(15,8,n.apps.data,"name"),e.VKq(11,Ue,a.value))),e.xp6(3),e.Q6J("ngIf",n.errors.appId),e.xp6(5),e.Q6J("ngIf",n.errors.expiry),e.xp6(5),e.Q6J("ngIf",n.errors.description)}},directives:[y.Ye,j.x,k.s,T.xw,T.Wh,l._Y,l.JL,T.yH,l.sg,f.KE,f.hX,U.gD,l.JJ,l.u,l.Q7,M.ey,w.nu,m.sg,m.O5,f.TO,L.Nt,l.Fj,Ce.A,x.lW],pipes:[q.g,J.T],styles:[""]}),i})();var Fe=s(949),De=s(8248),Oe=s(2217),Ne=s(7375),Me=s(2155),qe=s(2604),Je=s(4274),He=s(1065),Qe=s(5612),Ge=s(5896);const je=[{path:"",component:xe},{path:"viewer",component:be},{path:"generate",component:we}];let Le=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[[l.u5,m.ez,Fe.t,h.ie,Y.Ps,De._,Z.JX,L.c,_.Hi,u.p0,Oe.l,x.ot,U.LD,Ne.M,Me.o9,qe.o,Je.X,y.g0,Q.AV,f.lN,He.w,Ge.n,Qe.G,l.UX,P.Cv,w.Co,g.Bz.forChild(je)]]}),i})()}}]);