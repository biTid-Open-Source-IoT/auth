(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{Pn0e:function(t,e,i){"use strict";i.r(e),i.d(e,"SubscribersModule",(function(){return U}));var s=i("mrSG"),o=i("0IaG"),r=i("3Pt+"),a=i("fXoL"),n=i("dWDE"),c=i("/t3+"),l=i("kmnG"),b=i("bTqV"),u=i("NFeN"),d=i("qFsG"),m=i("ofXK"),h=i("d3UM"),p=i("FKr1");function f(t,e){if(1&t&&(a.Sb(0,"mat-error"),a.Cc(1),a.Rb()),2&t){const t=a.ec();a.Ab(1),a.Ec(" ",t.errors.email," ")}}function g(t,e){if(1&t&&(a.Sb(0,"mat-error"),a.Cc(1),a.Rb()),2&t){const t=a.ec();a.Ab(1),a.Ec(" ",t.errors.role," ")}}let k=(()=>{class t{constructor(t,e,i){this.dialog=t,this.config=e,this.formerror=i,this.form=new r.f({role:new r.c(1,[r.v.required]),email:new r.c(null,[r.v.required,r.v.email])}),this.errors={role:"",email:""},this.subscribers={}}close(){this.dialog.close(!1)}submit(){this.dialog.close(this.form.value)}ngOnInit(){this.subscribers.form=this.form.valueChanges.subscribe(t=>{this.errors=this.formerror.validateForm(this.form,this.errors,!0)}),null!=this.config&&(null!=this.config.role&&this.form.controls.role.setValue(this.config.role),null!=this.config.email&&(this.form.controls.email.setValue(this.config.email),this.form.controls.email.disable()))}ngOnDestroy(){this.subscribers.form.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(a.Mb(o.d),a.Mb(o.a),a.Mb(n.a))},t.\u0275cmp=a.Gb({type:t,selectors:[["user-editor-dialog"]],decls:29,vars:8,consts:[[1,"spacer"],["type","button","mat-icon-button","",3,"click"],[3,"formGroup","ngSubmit"],["appearance","outline"],["matInput","","type","email","name","email","placeholder","email","formControlName","email","required",""],[4,"ngIf"],["name","role","placeholder","role","formControlName","role","required",""],[3,"value"],["disabled","",3,"value"],["type","submit","mat-flat-button","","color","primary"]],template:function(t,e){1&t&&(a.Sb(0,"mat-toolbar"),a.Sb(1,"mat-label",0),a.Cc(2," Manage User "),a.Rb(),a.Sb(3,"button",1),a.ac("click",(function(){return e.close()})),a.Sb(4,"mat-icon"),a.Cc(5,"close"),a.Rb(),a.Rb(),a.Rb(),a.Sb(6,"form",2),a.ac("ngSubmit",(function(){return!e.form.invalid&&e.submit()})),a.Sb(7,"mat-form-field",3),a.Sb(8,"mat-label"),a.Cc(9," Email "),a.Rb(),a.Nb(10,"input",4),a.Ac(11,f,2,1,"mat-error",5),a.Rb(),a.Sb(12,"mat-form-field",3),a.Sb(13,"mat-label"),a.Cc(14," Role "),a.Rb(),a.Sb(15,"mat-select",6),a.Sb(16,"mat-option",7),a.Cc(17," Read "),a.Rb(),a.Sb(18,"mat-option",7),a.Cc(19," Write "),a.Rb(),a.Sb(20,"mat-option",7),a.Cc(21," Read/Write "),a.Rb(),a.Sb(22,"mat-option",7),a.Cc(23," Admin "),a.Rb(),a.Sb(24,"mat-option",8),a.Cc(25," Owner "),a.Rb(),a.Rb(),a.Ac(26,g,2,1,"mat-error",5),a.Rb(),a.Sb(27,"button",9),a.Cc(28," submit "),a.Rb(),a.Rb()),2&t&&(a.Ab(6),a.kc("formGroup",e.form),a.Ab(5),a.kc("ngIf",e.errors.email),a.Ab(5),a.kc("value",1),a.Ab(2),a.kc("value",2),a.Ab(2),a.kc("value",3),a.Ab(2),a.kc("value",4),a.Ab(2),a.kc("value",5),a.Ab(2),a.kc("ngIf",e.errors.role))},directives:[c.a,l.g,b.a,u.a,r.w,r.p,r.g,l.c,d.a,r.b,r.o,r.e,r.u,m.l,h.a,p.k,l.b],styles:[".user-editor-dialog{width:500px!important}.user-editor-dialog .mat-dialog-container{padding:0 0 10px!important}.user-editor-dialog .mat-dialog-container mat-toolbar{display:flex;font-size:14px;margin-bottom:5px;justify-content:center}@media screen and (max-width:600px){.user-editor-dialog .mat-dialog-container{top:0;left:0;right:0;bottom:0;z-index:5000;position:fixed;border-radius:0}}"],encapsulation:2}),t})();var S=i("+0xr"),R=i("xyCQ"),w=i("L7HW"),C=i("9ZKQ"),v=i("tyNb"),A=i("BhS5"),y=i("RgeU"),M=i("znSr"),O=i("MutI");function x(t,e){1&t&&(a.Sb(0,"th",10),a.Cc(1," Email "),a.Rb())}function I(t,e){if(1&t&&(a.Sb(0,"td",11),a.Cc(1),a.Rb()),2&t){const t=e.$implicit;a.Ab(1),a.Ec(" ",t.email," ")}}function D(t,e){1&t&&(a.Sb(0,"th",10),a.Cc(1," Role "),a.Rb())}function N(t,e){if(1&t){const t=a.Tb();a.Sb(0,"td",11),a.Sb(1,"mat-select",12),a.ac("ngModelChange",(function(i){return a.rc(t),e.$implicit.role=i}))("ngModelChange",(function(i){a.rc(t);const s=e.$implicit;return a.ec().updatesubscriber(s.email,i)})),a.Sb(2,"mat-option",13),a.Cc(3," Read "),a.Rb(),a.Sb(4,"mat-option",13),a.Cc(5," Write "),a.Rb(),a.Sb(6,"mat-option",13),a.Cc(7," Read/Write "),a.Rb(),a.Sb(8,"mat-option",13),a.Cc(9," Admin "),a.Rb(),a.Sb(10,"mat-option",14),a.Cc(11," Owner "),a.Rb(),a.Rb(),a.Rb()}if(2&t){const t=e.$implicit,i=a.ec();a.Ab(1),a.kc("ngModel",t.role)("disabled",i.role<4||t.role>=i.role||5==t.role),a.Ab(1),a.kc("value",1),a.Ab(2),a.kc("value",2),a.Ab(2),a.kc("value",3),a.Ab(2),a.kc("value",4),a.Ab(2),a.kc("value",5)}}function P(t,e){1&t&&a.Nb(0,"th",10)}function H(t,e){if(1&t){const t=a.Tb();a.Sb(0,"td",11),a.Sb(1,"button",15),a.ac("click",(function(){a.rc(t);const i=e.$implicit;return a.ec().unsubscribe(i.email)})),a.Sb(2,"mat-icon"),a.Cc(3," delete "),a.Rb(),a.Rb(),a.Rb()}if(2&t){const t=e.$implicit,i=a.ec();a.Ab(1),a.kc("disabled",i.role<4||t.role>=i.role||5==t.role)}}function $(t,e){1&t&&a.Nb(0,"tr",16)}function j(t,e){1&t&&a.Nb(0,"tr",17)}function q(t,e){if(1&t){const t=a.Tb();a.Sb(0,"mat-list-item",18),a.Sb(1,"mat-label"),a.Sb(2,"h3"),a.Cc(3),a.Rb(),a.Sb(4,"p"),a.Cc(5),a.Rb(),a.Rb(),a.Sb(6,"button",19),a.ac("click",(function(){a.rc(t);const i=e.$implicit;return a.ec().editor(i)})),a.Sb(7,"mat-icon"),a.Cc(8," edit "),a.Rb(),a.Rb(),a.Sb(9,"button",15),a.ac("click",(function(){a.rc(t);const i=e.$implicit;return a.ec().unsubscribe(i.email)})),a.Sb(10,"mat-icon"),a.Cc(11," delete "),a.Rb(),a.Rb(),a.Rb()}if(2&t){const t=e.$implicit,i=a.ec();a.Ab(3),a.Ec(" ",t.email," "),a.Ab(2),a.Hc(" ",1==t.role?"Read":""," ",2==t.role?"Write":""," ",3==t.role?"Read/Write":""," ",4==t.role?"Admin":""," ",5==t.role?"Owner":""," "),a.Ab(1),a.kc("disabled",i.role<4||t.role>=i.role||5==t.role),a.Ab(3),a.kc("disabled",i.role<4||t.role>=i.role||5==t.role)}}let G=(()=>{class t{constructor(t,e,i,s,o,r,a){this.apps=t,this.config=e,this.dialog=i,this.toast=s,this.route=o,this.buttons=r,this.tokens=a,this.users=new S.k,this.columns=["email","role","options"],this.subscriptions={}}get(){return Object(s.a)(this,void 0,void 0,(function*(){this.loading=!0;const t={filter:["role","users"]};let e;switch(this.type){case"app":e=this.apps,t.appId=this.id;break;case"token":e=this.tokens,t.tokenId=this.id}const i=yield e.get(t);i.ok?(this.role=i.result.role,this.users.data=i.result.users):this.users.data=[],this.loading=!1}))}share(t){return Object(s.a)(this,void 0,void 0,(function*(){this.loading=!0;const e={role:t.role,email:t.email};let i;switch(this.type){case"app":i=this.apps,e.appId=this.id;break;case"token":i=this.tokens,e.tokenId=this.id}const s=yield i.share(e);s.ok?(this.users.data.push(t),this.users.data=JSON.parse(JSON.stringify(this.users.data)),this.toast.show("User was shared!")):this.toast.show(s.error.message),this.loading=!1}))}editor(t){return Object(s.a)(this,void 0,void 0,(function*(){(yield this.dialog.open(k,{data:t,panelClass:"user-editor-dialog"})).afterClosed().subscribe(e=>{e&&(t?this.updatesubscriber(t.email,e.role):this.share(e))})}))}unsubscribe(t){return Object(s.a)(this,void 0,void 0,(function*(){this.loading=!0;const e={email:t};let i;switch(this.type){case"app":i=this.apps,e.appId=this.id;break;case"token":i=this.tokens,e.tokenId=this.id}const s=yield i.unsubscribe(e);if(s.ok){for(let e=0;e<this.users.data.length;e++)this.users.data[e].email==t&&this.users.data.splice(e,1);this.users.data=JSON.parse(JSON.stringify(this.users.data)),this.toast.show("User was removed!")}else this.toast.show(s.error.message);this.loading=!1}))}updatesubscriber(t,e){return Object(s.a)(this,void 0,void 0,(function*(){this.loading=!0;const i={role:e,email:t};let s;switch(this.type){case"app":s=this.apps,i.appId=this.id;break;case"token":s=this.tokens,i.tokenId=this.id}const o=yield s.updatesubscriber(i);this.toast.show(o.ok?"User was updated!":o.error.message),this.loading=!1}))}ngOnInit(){this.buttons.show("add"),this.buttons.show("close"),this.buttons.hide("search"),this.buttons.hide("filter"),this.subscriptions.add=this.buttons.add.click.subscribe(t=>{this.editor()}),this.subscriptions.close=this.buttons.close.click.subscribe(t=>{window.history.back()}),this.subscriptions.loaded=this.config.loaded.subscribe(t=>{if(t){const t=this.route.snapshot.queryParams;this.id=t.id,this.type=t.type,this.get()}})}ngOnDestroy(){this.subscriptions.add.unsubscribe(),this.subscriptions.close.unsubscribe(),this.subscriptions.loaded.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(a.Mb(R.a),a.Mb(w.a),a.Mb(o.b),a.Mb(C.a),a.Mb(v.a),a.Mb(A.a),a.Mb(y.a))},t.\u0275cmp=a.Gb({type:t,selectors:[["subscribers-page"]],decls:14,vars:5,consts:[["mat-table","","fxShow","","fxHide.xs","true",3,"dataSource"],["matColumnDef","email"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","role"],["matColumnDef","options"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",4,"matRowDef","matRowDefColumns"],["fxHide","","fxShow.xs","true"],["lines","full",4,"ngFor","ngForOf"],["mat-header-cell",""],["mat-cell",""],["required","",3,"ngModel","disabled","ngModelChange"],[3,"value"],["disabled","",3,"value"],["mat-icon-button","","color","warn",3,"disabled","click"],["mat-header-row",""],["mat-row",""],["lines","full"],["mat-icon-button","",3,"disabled","click"]],template:function(t,e){1&t&&(a.Sb(0,"table",0),a.Qb(1,1),a.Ac(2,x,2,0,"th",2),a.Ac(3,I,2,1,"td",3),a.Pb(),a.Qb(4,4),a.Ac(5,D,2,0,"th",2),a.Ac(6,N,12,7,"td",3),a.Pb(),a.Qb(7,5),a.Ac(8,P,1,0,"th",2),a.Ac(9,H,4,1,"td",3),a.Pb(),a.Ac(10,$,1,0,"tr",6),a.Ac(11,j,1,0,"tr",7),a.Rb(),a.Sb(12,"mat-list",8),a.Ac(13,q,12,8,"mat-list-item",9),a.Rb()),2&t&&(a.kc("dataSource",e.users),a.Ab(10),a.kc("matHeaderRowDef",e.columns)("matHeaderRowDefSticky",!0),a.Ab(1),a.kc("matRowDefColumns",e.columns),a.Ab(2),a.kc("ngForOf",e.users.data))},directives:[S.j,M.a,S.c,S.e,S.b,S.g,S.i,O.a,m.k,S.d,S.a,h.a,r.u,r.o,r.r,p.k,b.a,u.a,S.f,S.h,O.b,l.g],styles:[".mat-column-options[_ngcontent-%COMP%]{width:40px;padding-right:16px!important}mat-list[_ngcontent-%COMP%]   mat-list-item[_ngcontent-%COMP%]{width:100%}mat-list[_ngcontent-%COMP%]   mat-list-item[_ngcontent-%COMP%]   mat-label[_ngcontent-%COMP%]{margin-right:auto}"]}),t})();var W=i("wZkO"),E=i("YUcS"),F=i("H0Zp");const J=[{path:"",component:G}];let U=(()=>{class t{}return t.\u0275mod=a.Kb({type:t}),t.\u0275inj=a.Jb({factory:function(e){return new(e||t)},imports:[[r.i,m.c,W.a,u.b,O.c,S.l,d.b,p.p,o.c,b.b,h.b,F.a,c.b,E.a,l.e,r.t,v.g.forChild(J)]]}),t})()}}]);