(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{"1Vod":function(t,e,r){"use strict";r.r(e),r.d(e,"AllowAccessModule",(function(){return T}));var s=r("mrSG"),i=r("3Pt+"),o=r("fXoL"),a=r("tyNb"),n=r("9ZKQ"),c=r("dWDE"),p=r("xyCQ"),l=r("WF9o"),m=r("ofXK"),b=r("kmnG"),u=r("qFsG"),d=r("bTqV"),f=r("Xa2L");function h(t,e){if(1&t&&o.Pb(0,"img",9),2&t){const t=o.gc();o.nc("src",t.app.icon,o.uc)}}function g(t,e){if(1&t&&(o.Ub(0,"h1"),o.Ac(1),o.Tb()),2&t){const t=o.gc();o.Cb(1),o.Cc(" ",t.app.name," ")}}function w(t,e){if(1&t&&(o.Ub(0,"mat-error"),o.Ac(1),o.Tb()),2&t){const t=o.gc();o.Cb(1),o.Cc(" ",t.errors.email," ")}}function C(t,e){if(1&t&&(o.Ub(0,"mat-error"),o.Ac(1),o.Tb()),2&t){const t=o.gc();o.Cb(1),o.Cc(" ",t.errors.password," ")}}function I(t,e){1&t&&o.Pb(0,"mat-progress-spinner",10)}let v=(()=>{class t{constructor(t,e,r,s,o){this.route=t,this.toast=e,this.formerror=r,this.service=s,this.localstorage=o,this.form=new i.d({email:new i.b("",[i.p.email,i.p.required]),password:new i.b("",[i.p.required])}),this.errors={email:"",password:""},this.app={},this.subscriptions={}}load(){return Object(s.a)(this,void 0,void 0,(function*(){this.loading=!0;const t=yield this.service.load({filter:["icon","name","scopes"],appId:this.appId});this.loading=!1,t.ok?this.app=t.result:this.toast.error("issue loading app!")}))}submit(){return Object(s.a)(this,void 0,void 0,(function*(){this.loading=!0,this.form.disable();const t=new Date((new Date).setFullYear((new Date).getFullYear()+1)),e=yield this.service.allowaccess({appId:this.appId,email:this.form.value.email,expiry:t,scopes:this.app.scopes,password:this.form.value.password,description:this.app.name+" (LOGIN)"});if(this.form.enable(),this.loading=!1,e.ok){const t=[this.returl,"?","email=",this.form.value.email,"&","tokenId=",e.result.tokenId].join("");window.open(t,"_parent")}else this.toast.error(e.error.message)}))}ngOnInit(){this.subscriptions.form=this.form.valueChanges.subscribe(t=>{this.errors=this.formerror.validateForm(this.form,this.errors,!0)}),this.subscriptions.route=this.route.queryParams.subscribe(t=>{this.appId=t.appId,this.returl=t.returl,void 0!==t.email&&(this.form.controls.email.setValue(t.email),this.localstorage.set("email",t.email)),this.load()})}ngOnDestroy(){this.subscriptions.form.unsubscribe(),this.subscriptions.route.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(o.Ob(a.a),o.Ob(n.a),o.Ob(c.a),o.Ob(p.a),o.Ob(l.a))},t.\u0275cmp=o.Ib({type:t,selectors:[["allow-access-page"]],decls:16,vars:7,consts:[[3,"formGroup","ngSubmit"],["alt","app icon",3,"src",4,"ngIf"],[4,"ngIf"],["appearance","outline"],["text-uppercase",""],["matInput","","type","email","name","email","placeholder","email","formControlName","email","required",""],["matInput","","type","password","name","password","placeholder","password","formControlName","password","required",""],["type","submit","mat-flat-button","","color","primary"],["mode","indeterminate","diameter","30",4,"ngIf"],["alt","app icon",3,"src"],["mode","indeterminate","diameter","30"]],template:function(t,e){1&t&&(o.Ub(0,"form",0),o.cc("ngSubmit",(function(){return!e.form.invalid&&!e.loading&&e.submit()})),o.zc(1,h,1,1,"img",1),o.zc(2,g,2,1,"h1",2),o.Ub(3,"mat-form-field",3),o.Ub(4,"mat-label",4),o.Ac(5," Email "),o.Tb(),o.Pb(6,"input",5),o.zc(7,w,2,1,"mat-error",2),o.Tb(),o.Ub(8,"mat-form-field",3),o.Ub(9,"mat-label",4),o.Ac(10," Password "),o.Tb(),o.Pb(11,"input",6),o.zc(12,C,2,1,"mat-error",2),o.Tb(),o.Ub(13,"button",7),o.Ac(14),o.zc(15,I,1,0,"mat-progress-spinner",8),o.Tb(),o.Tb()),2&t&&(o.nc("formGroup",e.form),o.Cb(1),o.nc("ngIf",e.app.icon),o.Cb(1),o.nc("ngIf",e.app.name),o.Cb(5),o.nc("ngIf",e.errors.email),o.Cb(5),o.nc("ngIf",e.errors.password),o.Cb(2),o.Cc(" ",e.loading?"":"allow access"," "),o.Cb(1),o.nc("ngIf",e.loading))},directives:[i.q,i.j,i.e,m.l,b.c,b.g,u.a,i.a,i.i,i.c,i.o,d.a,b.b,f.a],styles:["img[_ngcontent-%COMP%]{width:100px;display:block;margin:25px auto}form[_ngcontent-%COMP%]{width:400px;margin:auto}form[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:20px;text-align:center;line-height:20px;font-weight:400;text-transform:uppercase}@media screen and (max-width:420px){form[_ngcontent-%COMP%]{width:calc(100% - 20px)}}"]}),t})();var y=r("NFeN"),O=r("d3UM"),x=r("/t3+");const P=[{path:"",component:v}];let T=(()=>{class t{}return t.\u0275mod=o.Mb({type:t}),t.\u0275inj=o.Lb({factory:function(e){return new(e||t)},imports:[[i.f,m.c,y.b,u.b,d.b,O.b,x.b,b.e,i.n,f.b,a.g.forChild(P)]]}),t})()}}]);