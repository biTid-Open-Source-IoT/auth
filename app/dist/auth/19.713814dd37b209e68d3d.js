(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{"4gMo":function(t,e,i){"use strict";i.r(e),i.d(e,"FeaturesModule",(function(){return et}));var o=i("mrSG");class s{constructor(t){this.app={},this.role=0,null!=t&&(null!=t.app&&(null!=t.app.name&&(this.app.name=t.app.name),null!=t.app.icon&&(this.app.icon=t.app.icon)),null!=t.role&&(this.role=t.role),null!=t.appId&&(this.appId=t.appId),null!=t.title&&(this.title=t.title),null!=t.featureId&&(this.featureId=t.featureId),null!=t.description&&(this.description=t.description))}}var r=i("Dh3D"),n=i("+0xr"),a=i("fXoL"),c=i("9ZKQ"),l=i("u0tM"),d=i("L7HW"),u=i("tyNb"),b=i("swrf"),f=i("BhS5"),p=i("wJso"),h=i("znSr"),m=i("MutI"),g=i("ofXK"),v=i("bTqV"),w=i("NFeN"),I=i("FKr1"),S=i("kmnG");function y(t,e){1&t&&(a.Sb(0,"th",11),a.Bc(1," Title "),a.Rb())}function O(t,e){if(1&t&&(a.Sb(0,"td",12),a.Bc(1),a.Rb()),2&t){const t=e.$implicit;a.Ab(1),a.Dc(" ",t.title," ")}}function R(t,e){1&t&&(a.Sb(0,"th",11),a.Bc(1," Description "),a.Rb())}function k(t,e){if(1&t&&(a.Sb(0,"td",12),a.Bc(1),a.Rb()),2&t){const t=e.$implicit;a.Ab(1),a.Dc(" ",t.description," ")}}function M(t,e){1&t&&a.Nb(0,"th",13)}function C(t,e){if(1&t){const t=a.Tb();a.Sb(0,"td",12),a.Sb(1,"button",14),a.ac("click",(function(){a.rc(t);const i=e.$implicit;return a.ec().options(i)})),a.Sb(2,"mat-icon"),a.Bc(3," more_vert "),a.Rb(),a.Rb(),a.Rb()}}function D(t,e){1&t&&a.Nb(0,"tr",15)}function x(t,e){1&t&&a.Nb(0,"tr",16)}function P(t,e){if(1&t){const t=a.Tb();a.Sb(0,"mat-list-item",17),a.ac("click",(function(){a.rc(t);const i=e.$implicit;return a.ec().options(i)})),a.Sb(1,"mat-label"),a.Sb(2,"h3"),a.Bc(3),a.Rb(),a.Sb(4,"p"),a.Bc(5),a.Rb(),a.Rb(),a.Rb()}if(2&t){const t=e.$implicit;a.Ab(3),a.Dc(" ",t.title," "),a.Ab(2),a.Dc(" ",t.description," ")}}let A=(()=>{class t{constructor(t,e,i,o,s,r,a){this.toast=t,this.sheet=e,this.config=i,this.router=o,this.confirm=s,this.buttons=r,this.service=a,this.columns=["title","description","options"],this.features=new n.k,this.subscriptions={}}list(){return Object(o.a)(this,void 0,void 0,(function*(){this.loading=!0;const t=yield this.service.list({filter:["icon","role","title","featureId","description"]});this.features.data=t.ok?t.result.map(t=>new s(t)):[],this.loading=!1}))}options(t){return Object(o.a)(this,void 0,void 0,(function*(){this.sheet.show({role:t.role,title:t.title,options:[{icon:"edit",title:"Edit",handler:()=>Object(o.a)(this,void 0,void 0,(function*(){this.router.navigate(["/features","editor"],{queryParams:{mode:"update",featureId:t.featureId}})})),disabled:[0,1]},{icon:"content_copy",title:"Copy",handler:()=>Object(o.a)(this,void 0,void 0,(function*(){this.router.navigate(["/features","editor"],{queryParams:{mode:"copy",featureId:t.featureId}})})),disabled:[0,1]},{icon:"delete",title:"Delete",danger:!0,handler:()=>Object(o.a)(this,void 0,void 0,(function*(){this.confirm.show({message:"Are you sure you want to delete "+t.title+"?",handler:()=>Object(o.a)(this,void 0,void 0,(function*(){this.loading=!0;const e=yield this.service.delete({featureId:t.featureId});if(e.ok){for(let e=0;e<this.features.data.length;e++)if(this.features.data[e].featureId==t.featureId){this.features.data.splice(e,1),this.toast.show("Feature was removed!");break}this.features.data=JSON.parse(JSON.stringify(this.features.data))}else this.toast.show(e.error.message);this.loading=!1}))})})),disabled:[0,1,2,3,4]}]})}))}ngOnInit(){this.buttons.show("add"),this.buttons.hide("close"),this.buttons.hide("filter"),this.buttons.hide("search"),this.features.sort=this.sort,this.features.sort.active="title",this.features.sort.direction="asc",this.subscriptions.add=this.buttons.add.click.subscribe(t=>{this.router.navigate(["/features","editor"],{queryParams:{mode:"add"}})}),this.subscriptions.loaded=this.config.loaded.subscribe(t=>{t&&this.list()})}ngOnDestroy(){this.subscriptions.add.unsubscribe(),this.subscriptions.loaded.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(a.Mb(c.a),a.Mb(l.a),a.Mb(d.a),a.Mb(u.b),a.Mb(b.a),a.Mb(f.a),a.Mb(p.a))},t.\u0275cmp=a.Gb({type:t,selectors:[["features-page"]],viewQuery:function(t,e){var i;1&t&&a.vc(r.a,!0),2&t&&a.oc(i=a.bc())&&(e.sort=i.first)},decls:14,vars:5,consts:[["mat-table","","fxShow","","fxHide.xs","true","matSort","",3,"dataSource"],["matColumnDef","title"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","description"],["matColumnDef","options"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",4,"matRowDef","matRowDefColumns"],["fxHide","","fxShow.xs","true"],["lines","full","matRipple","",3,"click",4,"ngFor","ngForOf"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-header-cell",""],["mat-icon-button","",3,"click"],["mat-header-row",""],["mat-row",""],["lines","full","matRipple","",3,"click"]],template:function(t,e){1&t&&(a.Sb(0,"table",0),a.Qb(1,1),a.zc(2,y,2,0,"th",2),a.zc(3,O,2,1,"td",3),a.Pb(),a.Qb(4,4),a.zc(5,R,2,0,"th",2),a.zc(6,k,2,1,"td",3),a.Pb(),a.Qb(7,5),a.zc(8,M,1,0,"th",6),a.zc(9,C,4,0,"td",3),a.Pb(),a.zc(10,D,1,0,"tr",7),a.zc(11,x,1,0,"tr",8),a.Rb(),a.Sb(12,"mat-list",9),a.zc(13,P,6,2,"mat-list-item",10),a.Rb()),2&t&&(a.kc("dataSource",e.features),a.Ab(10),a.kc("matHeaderRowDef",e.columns)("matHeaderRowDefSticky",!0),a.Ab(1),a.kc("matRowDefColumns",e.columns),a.Ab(2),a.kc("ngForOf",e.features.data))},directives:[n.j,h.a,r.a,n.c,n.e,n.b,n.g,n.i,m.a,g.k,n.d,r.b,n.a,v.a,w.a,n.f,n.h,m.b,I.o,S.f],styles:[".mat-column-title[_ngcontent-%COMP%]{width:30%}.mat-column-options[_ngcontent-%COMP%]{width:40px;padding-right:16px!important}mat-list[_ngcontent-%COMP%]   mat-list-item[_ngcontent-%COMP%]{display:flex;align-items:center;flex-direction:row}"]}),t})();var _=i("Ovx2"),B=i("3Pt+"),j=i("xyCQ"),q=i("4jEk"),z=i("d3UM"),N=i("WJ5W"),F=i("qFsG"),H=i("ZRfb"),G=i("AbOq");function J(t,e){if(1&t&&(a.Sb(0,"mat-option",10),a.Bc(1),a.Rb()),2&t){const t=e.$implicit;a.kc("value",t.appId),a.Ab(1),a.Dc(" ",t.name," ")}}function Q(t,e){if(1&t&&(a.Sb(0,"mat-error"),a.Bc(1),a.Rb()),2&t){const t=a.ec();a.Ab(1),a.Dc(" ",t.errors.appId," ")}}function T(t,e){if(1&t&&(a.Sb(0,"mat-error"),a.Bc(1),a.Rb()),2&t){const t=a.ec();a.Ab(1),a.Dc(" ",t.errors.title," ")}}function $(t,e){if(1&t&&(a.Sb(0,"mat-error"),a.Bc(1),a.Rb()),2&t){const t=a.ec();a.Ab(1),a.Dc(" ",t.errors.description," ")}}const V=function(t){return{name:t}};let K=(()=>{class t{constructor(t,e,i,o,s,r,n){this.apps=t,this.toast=e,this.route=i,this.config=o,this.router=s,this.buttons=r,this.service=n,this.form=new B.f({appId:new B.c(null,[B.v.required]),title:new B.c(null,[B.v.required]),description:new B.c(null,[B.v.required])}),this.errors={appId:"",title:"",description:""},this.filter=new B.f({apps:new B.c("",[B.v.required])}),this.subscriptions={}}get(){return Object(o.a)(this,void 0,void 0,(function*(){this.loading=!0;const t=yield this.service.get({filter:["role","appId","title","description"],featureId:this.featureId});if(t.ok){const e=new s(t.result);e.role>=2?(this.form.controls.appId.setValue(e.appId),this.form.controls.title.setValue(e.title),this.form.controls.description.setValue(e.description)):(this.toast.show("You have insufficient rights to edit this feature!"),this.router.navigate(["/features"]))}else this.toast.show(t.error.message),this.router.navigate(["/features"]);this.loading=!1}))}load(){return Object(o.a)(this,void 0,void 0,(function*(){this.loading=!0;const t=yield this.apps.list({filter:["role","name","icon","appId"]});t.ok?this.apps.data=t.result.map(t=>new _.a(t)).filter(t=>t.role>=2):(this.apps.data=[],this.toast.show(t.error.message)),this.loading=!1}))}submit(){return Object(o.a)(this,void 0,void 0,(function*(){this.loading=!0;let t=this.mode;"copy"==t&&(t="add",delete this.featureId);const e=yield this.service[t]({appId:this.form.value.appId,title:this.form.value.title,featureId:this.featureId,description:this.form.value.description});e.ok?this.router.navigate(["/features"]):this.toast.show(e.error.message),this.loading=!1}))}ngOnInit(){this.buttons.hide("add"),this.buttons.show("close"),this.buttons.hide("filter"),this.buttons.hide("search"),this.subscriptions.close=this.buttons.close.click.subscribe(t=>{this.router.navigate(["/features"])}),this.subscriptions.loaded=this.config.loaded.subscribe(t=>Object(o.a)(this,void 0,void 0,(function*(){if(t){const t=this.route.snapshot.queryParams;this.mode=t.mode,this.featureId=t.featureId,"add"!=this.mode?(yield this.get(),yield this.load()):yield this.load()}})))}ngOnDestroy(){this.subscriptions.close.unsubscribe(),this.subscriptions.loaded.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(a.Mb(j.a),a.Mb(c.a),a.Mb(u.a),a.Mb(d.a),a.Mb(u.b),a.Mb(f.a),a.Mb(p.a))},t.\u0275cmp=a.Gb({type:t,selectors:[["features-editor-page"]],decls:24,vars:13,consts:[[3,"formGroup","ngSubmit"],["appearance","outline"],["name","appId","placeholder","appId","formControlName","appId","required",""],[3,"formGroup"],["placeholderLabel","filter apps","noEntriesFoundLabel","no apps found","formControlName","apps"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],["matInput","","type","text","name","title","placeholder","title","formControlName","title","required",""],["matInput","","type","text","name","description","placeholder","description","formControlName","description","required",""],["type","button","mat-flat-button","","color","primary",3,"disabled","click"],[3,"value"]],template:function(t,e){1&t&&(a.Sb(0,"mat-content"),a.Sb(1,"form",0),a.ac("ngSubmit",(function(){return!e.loading&&!e.form.invalid&&e.submit()})),a.Sb(2,"mat-form-field",1),a.Sb(3,"mat-label"),a.Bc(4," App "),a.Rb(),a.Sb(5,"mat-select",2),a.Sb(6,"mat-option",3),a.Nb(7,"ngx-mat-select-search",4),a.Rb(),a.zc(8,J,2,2,"mat-option",5),a.fc(9,"filterBy"),a.Rb(),a.zc(10,Q,2,1,"mat-error",6),a.Rb(),a.Sb(11,"mat-form-field",1),a.Sb(12,"mat-label"),a.Bc(13," Title "),a.Rb(),a.Nb(14,"input",7),a.zc(15,T,2,1,"mat-error",6),a.Rb(),a.Sb(16,"mat-form-field",1),a.Sb(17,"mat-label"),a.Bc(18," Description "),a.Rb(),a.Nb(19,"input",8),a.zc(20,$,2,1,"mat-error",6),a.Rb(),a.Rb(),a.Rb(),a.Sb(21,"mat-footer"),a.Sb(22,"button",9),a.ac("click",(function(){return!e.loading&&!e.form.invalid&&e.submit()})),a.Bc(23),a.Rb(),a.Rb()),2&t&&(a.Ab(1),a.kc("formGroup",e.form),a.Ab(5),a.kc("formGroup",e.filter),a.Ab(2),a.kc("ngForOf",a.hc(9,8,e.apps.data,a.mc(11,V,e.filter.value.apps))),a.Ab(2),a.kc("ngIf",e.errors.appId),a.Ab(5),a.kc("ngIf",e.errors.title),a.Ab(5),a.kc("ngIf",e.errors.description),a.Ab(2),a.kc("disabled",e.form.invalid),a.Ab(1),a.Dc(" ",e.mode," "))},directives:[q.a,B.w,B.p,B.g,S.c,S.f,z.a,B.o,B.e,B.u,I.k,N.a,g.k,g.l,F.a,B.b,H.a,v.a,S.b],pipes:[G.a],styles:["[upload][_ngcontent-%COMP%]{width:100px;margin:auto;height:100px;border:2px solid transparent;display:flex;align-items:center;border-radius:100%;justify-content:center;background-color:#eee}[upload].required[_ngcontent-%COMP%]{border-color:red}mat-content[_ngcontent-%COMP%], mat-footer[_ngcontent-%COMP%]{display:flex;align-items:center;flex-direction:column}mat-content[_ngcontent-%COMP%]   form[_ngcontent-%COMP%], mat-footer[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{max-width:400px;margin-top:20px}mat-content[_ngcontent-%COMP%]   button[_ngcontent-%COMP%], mat-footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%;max-width:400px}mat-footer[_ngcontent-%COMP%]{justify-content:center}"]}),t})();var L=i("wZkO"),Z=i("gyTc"),E=i("R32p"),W=i("tVzd"),U=i("YUcS"),X=i("H0Zp"),Y=i("p/0r");const tt=[{path:"",component:A},{path:"editor",component:K}];let et=(()=>{class t{}return t.\u0275mod=a.Kb({type:t}),t.\u0275inj=a.Jb({factory:function(e){return new(e||t)},imports:[[B.i,g.c,E.a,L.a,w.b,r.c,m.c,Z.a,n.l,F.b,W.a,I.p,v.b,z.b,U.a,X.a,Y.a,S.e,B.t,N.b,u.f.forChild(tt)]]}),t})()}}]);