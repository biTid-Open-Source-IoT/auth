(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{"4gMo":function(t,e,i){"use strict";i.r(e),i.d(e,"FeaturesModule",(function(){return tt}));var o=i("mrSG");class s{constructor(t){this.app={},this.role=0,null!=t&&(null!=t.app&&(null!=t.app.name&&(this.app.name=t.app.name),null!=t.app.icon&&(this.app.icon=t.app.icon)),null!=t.role&&(this.role=t.role),null!=t.appId&&(this.appId=t.appId),null!=t.title&&(this.title=t.title),null!=t.featureId&&(this.featureId=t.featureId),null!=t.description&&(this.description=t.description))}}var n=i("+0xr"),r=i("fXoL"),a=i("9ZKQ"),c=i("u0tM"),l=i("L7HW"),d=i("tyNb"),u=i("swrf"),b=i("BhS5"),p=i("wJso"),f=i("znSr"),h=i("MutI"),m=i("ofXK"),g=i("bTqV"),v=i("NFeN"),w=i("FKr1"),y=i("kmnG");function I(t,e){1&t&&(r.Rb(0,"th",10),r.Ac(1," Title "),r.Qb())}function O(t,e){if(1&t&&(r.Rb(0,"td",11),r.Ac(1),r.Qb()),2&t){const t=e.$implicit;r.Ab(1),r.Cc(" ",t.title," ")}}function C(t,e){1&t&&(r.Rb(0,"th",10),r.Ac(1," Description "),r.Qb())}function R(t,e){if(1&t&&(r.Rb(0,"td",11),r.Ac(1),r.Qb()),2&t){const t=e.$implicit;r.Ab(1),r.Cc(" ",t.description," ")}}function A(t,e){1&t&&r.Mb(0,"th",10)}function Q(t,e){if(1&t){const t=r.Sb();r.Rb(0,"td",11),r.Rb(1,"button",12),r.Zb("click",(function(){r.qc(t);const i=e.$implicit;return r.dc().options(i)})),r.Rb(2,"mat-icon"),r.Ac(3," more_vert "),r.Qb(),r.Qb(),r.Qb()}}function M(t,e){1&t&&r.Mb(0,"tr",13)}function j(t,e){1&t&&r.Mb(0,"tr",14)}function k(t,e){if(1&t){const t=r.Sb();r.Rb(0,"mat-list-item",15),r.Zb("click",(function(){r.qc(t);const i=e.$implicit;return r.dc().options(i)})),r.Rb(1,"mat-label"),r.Rb(2,"h3"),r.Ac(3),r.Qb(),r.Rb(4,"p"),r.Ac(5),r.Qb(),r.Qb(),r.Qb()}if(2&t){const t=e.$implicit;r.Ab(3),r.Cc(" ",t.title," "),r.Ab(2),r.Cc(" ",t.description," ")}}let x=(()=>{class t{constructor(t,e,i,o,s,r,a){this.toast=t,this.sheet=e,this.config=i,this.router=o,this.confirm=s,this.buttons=r,this.service=a,this.columns=["title","description","options"],this.features=new n.k,this.subscriptions={}}list(){return Object(o.a)(this,void 0,void 0,(function*(){this.loading=!0;const t=yield this.service.list({filter:["icon","role","title","featureId","description"]});this.features.data=t.ok?t.result.map(t=>new s(t)):[],this.loading=!1}))}options(t){return Object(o.a)(this,void 0,void 0,(function*(){this.sheet.show({role:t.role,title:t.title,options:[{icon:"edit",title:"Edit",handler:()=>Object(o.a)(this,void 0,void 0,(function*(){this.router.navigate(["/features","editor"],{queryParams:{mode:"update",featureId:t.featureId}})})),disabled:[0,1]},{icon:"content_copy",title:"Copy",handler:()=>Object(o.a)(this,void 0,void 0,(function*(){this.router.navigate(["/features","editor"],{queryParams:{mode:"copy",featureId:t.featureId}})})),disabled:[0,1]},{icon:"delete",title:"Delete",danger:!0,handler:()=>Object(o.a)(this,void 0,void 0,(function*(){this.confirm.show({message:"Are you sure you want to delete "+t.title+"?",handler:()=>Object(o.a)(this,void 0,void 0,(function*(){this.loading=!0;const e=yield this.service.delete({featureId:t.featureId});if(e.ok){for(let e=0;e<this.features.data.length;e++)if(this.features.data[e].featureId==t.featureId){this.features.data.splice(e,1),this.toast.show("Feature was removed!");break}this.features.data=JSON.parse(JSON.stringify(this.features.data))}else this.toast.show(e.error.message);this.loading=!1}))})})),disabled:[0,1,2,3,4]}]})}))}ngOnInit(){this.buttons.show("add"),this.buttons.hide("close"),this.buttons.hide("filter"),this.buttons.hide("search"),this.subscriptions.add=this.buttons.add.click.subscribe(t=>{this.router.navigate(["/features","editor"],{queryParams:{mode:"add"}})}),this.subscriptions.loaded=this.config.loaded.subscribe(t=>{t&&this.list()})}ngOnDestroy(){this.subscriptions.add.unsubscribe(),this.subscriptions.loaded.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(r.Lb(a.a),r.Lb(c.a),r.Lb(l.a),r.Lb(d.b),r.Lb(u.a),r.Lb(b.a),r.Lb(p.a))},t.\u0275cmp=r.Fb({type:t,selectors:[["features-page"]],decls:14,vars:5,consts:[["mat-table","","fxShow","","fxHide.xs","true",3,"dataSource"],["matColumnDef","title"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","description"],["matColumnDef","options"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",4,"matRowDef","matRowDefColumns"],["fxHide","","fxShow.xs","true"],["lines","full","matRipple","",3,"click",4,"ngFor","ngForOf"],["mat-header-cell",""],["mat-cell",""],["mat-icon-button","",3,"click"],["mat-header-row",""],["mat-row",""],["lines","full","matRipple","",3,"click"]],template:function(t,e){1&t&&(r.Rb(0,"table",0),r.Pb(1,1),r.yc(2,I,2,0,"th",2),r.yc(3,O,2,1,"td",3),r.Ob(),r.Pb(4,4),r.yc(5,C,2,0,"th",2),r.yc(6,R,2,1,"td",3),r.Ob(),r.Pb(7,5),r.yc(8,A,1,0,"th",2),r.yc(9,Q,4,0,"td",3),r.Ob(),r.yc(10,M,1,0,"tr",6),r.yc(11,j,1,0,"tr",7),r.Qb(),r.Rb(12,"mat-list",8),r.yc(13,k,6,2,"mat-list-item",9),r.Qb()),2&t&&(r.jc("dataSource",e.features),r.Ab(10),r.jc("matHeaderRowDef",e.columns)("matHeaderRowDefSticky",!0),r.Ab(1),r.jc("matRowDefColumns",e.columns),r.Ab(2),r.jc("ngForOf",e.features.data))},directives:[n.j,f.a,n.c,n.e,n.b,n.g,n.i,h.a,m.k,n.d,n.a,g.a,v.a,n.f,n.h,h.b,w.o,y.f],styles:[".mat-column-title[_ngcontent-%COMP%]{width:30%}.mat-column-options[_ngcontent-%COMP%]{width:40px;padding-right:16px!important}mat-list[_ngcontent-%COMP%]   mat-list-item[_ngcontent-%COMP%]{display:flex;align-items:center;flex-direction:row}"]}),t})();var P=i("Ovx2"),_=i("3Pt+"),L=i("xyCQ"),q=i("4jEk"),D=i("d3UM"),S=i("WJ5W"),F=i("qFsG"),H=i("ZRfb"),N=i("AbOq");function Z(t,e){if(1&t&&(r.Rb(0,"mat-option",10),r.Ac(1),r.Qb()),2&t){const t=e.$implicit;r.jc("value",t.appId),r.Ab(1),r.Cc(" ",t.name," ")}}function G(t,e){if(1&t&&(r.Rb(0,"mat-error"),r.Ac(1),r.Qb()),2&t){const t=r.dc();r.Ab(1),r.Cc(" ",t.errors.appId," ")}}function J(t,e){if(1&t&&(r.Rb(0,"mat-error"),r.Ac(1),r.Qb()),2&t){const t=r.dc();r.Ab(1),r.Cc(" ",t.errors.title," ")}}function $(t,e){if(1&t&&(r.Rb(0,"mat-error"),r.Ac(1),r.Qb()),2&t){const t=r.dc();r.Ab(1),r.Cc(" ",t.errors.description," ")}}const V=function(t){return{name:t}};let T=(()=>{class t{constructor(t,e,i,o,s,n,r){this.apps=t,this.toast=e,this.route=i,this.config=o,this.router=s,this.buttons=n,this.service=r,this.form=new _.f({appId:new _.c(null,[_.v.required]),title:new _.c(null,[_.v.required]),description:new _.c(null,[_.v.required])}),this.errors={appId:"",title:"",description:""},this.filter=new _.f({apps:new _.c("",[_.v.required])}),this.subscriptions={}}get(){return Object(o.a)(this,void 0,void 0,(function*(){this.loading=!0;const t=yield this.service.get({filter:["role","appId","title","description"],featureId:this.featureId});if(t.ok){const e=new s(t.result);e.role>=2?(this.form.controls.appId.setValue(e.appId),this.form.controls.title.setValue(e.title),this.form.controls.description.setValue(e.description)):(this.toast.show("You have insufficient rights to edit this feature!"),this.router.navigate(["/features"]))}else this.toast.show(t.error.message),this.router.navigate(["/features"]);this.loading=!1}))}load(){return Object(o.a)(this,void 0,void 0,(function*(){this.loading=!0;const t=yield this.apps.list({filter:["role","name","icon","appId"]});t.ok?this.apps.data=t.result.map(t=>new P.a(t)).filter(t=>t.role>=2):(this.apps.data=[],this.toast.show(t.error.message)),this.loading=!1}))}submit(){return Object(o.a)(this,void 0,void 0,(function*(){this.loading=!0;let t=this.mode;"copy"==t&&(t="add",delete this.featureId);const e=yield this.service[t]({appId:this.form.value.appId,title:this.form.value.title,featureId:this.featureId,description:this.form.value.description});e.ok?this.router.navigate(["/features"]):this.toast.show(e.error.message),this.loading=!1}))}ngOnInit(){this.buttons.hide("add"),this.buttons.show("close"),this.buttons.hide("filter"),this.buttons.hide("search"),this.subscriptions.close=this.buttons.close.click.subscribe(t=>{this.router.navigate(["/features"])}),this.subscriptions.loaded=this.config.loaded.subscribe(t=>Object(o.a)(this,void 0,void 0,(function*(){if(t){const t=this.route.snapshot.queryParams;this.mode=t.mode,this.featureId=t.featureId,"add"!=this.mode?(yield this.get(),yield this.load()):yield this.load()}})))}ngOnDestroy(){this.subscriptions.close.unsubscribe(),this.subscriptions.loaded.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(r.Lb(L.a),r.Lb(a.a),r.Lb(d.a),r.Lb(l.a),r.Lb(d.b),r.Lb(b.a),r.Lb(p.a))},t.\u0275cmp=r.Fb({type:t,selectors:[["features-editor-page"]],decls:24,vars:13,consts:[[3,"formGroup","ngSubmit"],["appearance","outline"],["name","appId","placeholder","appId","formControlName","appId","required",""],[3,"formGroup"],["placeholderLabel","filter apps","noEntriesFoundLabel","no apps found","formControlName","apps"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],["matInput","","type","text","name","title","placeholder","title","formControlName","title","required",""],["matInput","","type","text","name","description","placeholder","description","formControlName","description","required",""],["type","button","mat-flat-button","","color","primary",3,"disabled","click"],[3,"value"]],template:function(t,e){1&t&&(r.Rb(0,"mat-content"),r.Rb(1,"form",0),r.Zb("ngSubmit",(function(){return!e.loading&&!e.form.invalid&&e.submit()})),r.Rb(2,"mat-form-field",1),r.Rb(3,"mat-label"),r.Ac(4," App "),r.Qb(),r.Rb(5,"mat-select",2),r.Rb(6,"mat-option",3),r.Mb(7,"ngx-mat-select-search",4),r.Qb(),r.yc(8,Z,2,2,"mat-option",5),r.ec(9,"filterBy"),r.Qb(),r.yc(10,G,2,1,"mat-error",6),r.Qb(),r.Rb(11,"mat-form-field",1),r.Rb(12,"mat-label"),r.Ac(13," Title "),r.Qb(),r.Mb(14,"input",7),r.yc(15,J,2,1,"mat-error",6),r.Qb(),r.Rb(16,"mat-form-field",1),r.Rb(17,"mat-label"),r.Ac(18," Description "),r.Qb(),r.Mb(19,"input",8),r.yc(20,$,2,1,"mat-error",6),r.Qb(),r.Qb(),r.Qb(),r.Rb(21,"mat-footer"),r.Rb(22,"button",9),r.Zb("click",(function(){return!e.loading&&!e.form.invalid&&e.submit()})),r.Ac(23),r.Qb(),r.Qb()),2&t&&(r.Ab(1),r.jc("formGroup",e.form),r.Ab(5),r.jc("formGroup",e.filter),r.Ab(2),r.jc("ngForOf",r.gc(9,8,e.apps.data,r.lc(11,V,e.filter.value.apps))),r.Ab(2),r.jc("ngIf",e.errors.appId),r.Ab(5),r.jc("ngIf",e.errors.title),r.Ab(5),r.jc("ngIf",e.errors.description),r.Ab(2),r.jc("disabled",e.form.invalid),r.Ab(1),r.Cc(" ",e.mode," "))},directives:[q.a,_.w,_.p,_.g,y.c,y.f,D.a,_.o,_.e,_.u,w.k,S.a,m.k,m.l,F.a,_.b,H.a,g.a,y.b],pipes:[N.a],styles:["[upload][_ngcontent-%COMP%]{width:100px;margin:auto;height:100px;border:2px solid transparent;display:flex;align-items:center;border-radius:100%;justify-content:center;background-color:#eee}[upload].required[_ngcontent-%COMP%]{border-color:red}mat-content[_ngcontent-%COMP%], mat-footer[_ngcontent-%COMP%]{display:flex;align-items:center;flex-direction:column}mat-content[_ngcontent-%COMP%]   form[_ngcontent-%COMP%], mat-footer[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{max-width:400px;margin-top:20px}mat-content[_ngcontent-%COMP%]   button[_ngcontent-%COMP%], mat-footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%;max-width:400px}mat-footer[_ngcontent-%COMP%]{justify-content:center}"]}),t})();var E=i("wZkO"),K=i("gyTc"),W=i("R32p"),z=i("tVzd"),B=i("YUcS"),U=i("H0Zp"),X=i("p/0r");const Y=[{path:"",component:x},{path:"editor",component:T}];let tt=(()=>{class t{}return t.\u0275mod=r.Jb({type:t}),t.\u0275inj=r.Ib({factory:function(e){return new(e||t)},imports:[[_.i,m.c,W.a,E.a,v.b,h.c,K.a,n.l,F.b,z.a,w.p,g.b,D.b,B.a,U.a,X.a,y.e,_.t,S.b,d.f.forChild(Y)]]}),t})()}}]);