function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{"4dGL":function(e,t,r){"use strict";r.r(t),r.d(t,"ScopesModule",(function(){return ne}));var o=r("CSBE"),n=r("ofXK"),s=r("C6Ja"),i=r("NFeN"),a=r("STbY"),c=r("+0xr"),u=r("qFsG"),p=r("d3UM"),l=r("0IaG"),b=r("bTqV"),d=r("J89Z"),m=r("/t3+"),f=r("O8lL"),h=r("mrSG"),g=r("At5g"),v=r("RZmA"),C=r("SY5p"),w=r("fXoL"),k=r("d3yR"),y=r("9ZKQ"),I=r("2ChS"),x=r("tyNb"),T=r("a6VE"),U=r("bv9b");function O(e,t){1&e&&w.Pb(0,"mat-progress-bar",16)}function R(e,t){1&e&&(w.Ub(0,"th",17),w.Ac(1," app "),w.Tb())}function A(e,t){if(1&e&&(w.Ub(0,"td",18),w.Ac(1),w.Tb()),2&e){var r=t.$implicit;w.Cb(1),w.Cc(" ",r.app," ")}}function P(e,t){1&e&&(w.Ub(0,"th",17),w.Ac(1," description "),w.Tb())}function _(e,t){if(1&e&&(w.Ub(0,"td",18),w.Ac(1),w.Tb()),2&e){var r=t.$implicit;w.Cb(1),w.Cc(" ",r.description," ")}}function D(e,t){1&e&&(w.Ub(0,"th",17),w.Ac(1," url "),w.Tb())}function S(e,t){if(1&e&&(w.Ub(0,"td",19),w.Ac(1),w.Tb()),2&e){var r=t.$implicit;w.Cb(1),w.Cc(" ",r.url," ")}}function z(e,t){1&e&&w.Pb(0,"tr",20)}function j(e,t){if(1&e){var r=w.Vb();w.Ub(0,"tr",21),w.cc("click",(function(){w.tc(r);var e=t.$implicit;return w.gc().options(e)})),w.Tb()}}var q,M=((q=function(){function e(t,r,o,n,s,i){_classCallCheck(this,e),this.menu=t,this.toast=r,this.sheet=o,this.dialog=n,this.router=s,this.service=i,this.sort={key:"description",reverse:!1},this.scopes=new c.k,this.columns=["app","description","url"],this.subscriptions={}}return _createClass(e,[{key:"list",value:function(){return Object(h.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.loading=!0,e.next=3,this.service.list({sort:_defineProperty({},this.sort.key,this.sort.reverse?-1:1),filter:["url","app","role","appId","scopeId","description"]});case 3:t=e.sent,this.loading=!1,this.scopes.data=t.ok?t.result:[];case 5:case"end":return e.stop()}}),e,this)})))}},{key:"options",value:function(e){return Object(h.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r,o=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.sheet.open(C.a,{data:{role:e.role,title:e.description,options:[{icon:"create",title:"Edit",disabled:[0,1],optionId:0},{icon:"file_copy",title:"Copy",disabled:[0,1,2],optionId:1},{icon:"delete",title:"Delete",disabled:[0,1,2,3,4],optionId:2}]}});case 2:return r=t.sent,t.next=5,r.afterDismissed().subscribe((function(t){return Object(h.a)(o,void 0,void 0,regeneratorRuntime.mark((function r(){var o,n=this;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(void 0===t){r.next=13;break}r.t0=t,r.next=0===r.t0?4:1===r.t0?6:2===r.t0?8:13;break;case 4:return this.router.navigate(["/scopes","update",e.scopeId]),r.abrupt("break",13);case 6:return this.router.navigate(["/scopes","copy",e.scopeId]),r.abrupt("break",13);case 8:return r.next=10,this.dialog.open(g.a,{panelClass:"delete-dialog",disableClose:!0});case 10:return o=r.sent,r.next=13,o.afterClosed().subscribe((function(t){return Object(h.a)(n,void 0,void 0,regeneratorRuntime.mark((function r(){var o,n;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!t){r.next=19;break}return this.loading=!0,r.next=4,this.service.delete({scopeId:e.scopeId});case 4:if(o=r.sent,this.loading=!1,!o.ok){r.next=18;break}this.toast.success("scope was deleted!"),n=0;case 8:if(!(n<this.scopes.data.length)){r.next=15;break}if(this.scopes.data[n].scopeId!=e.scopeId){r.next=12;break}return this.scopes.data.splice(n,1),r.abrupt("break",15);case 12:n++,r.next=8;break;case 15:this.scopes.data=JSON.parse(JSON.stringify(this.scopes.data)),r.next=19;break;case 18:this.toast.error("issue deleting scope!");case 19:case"end":return r.stop()}}),r,this)})))}));case 13:case"end":return r.stop()}}),r,this)})))}));case 5:case"end":return t.stop()}}),t,this)})))}},{key:"ngOnInit",value:function(){var e=this;this.list(),this.subscriptions.search=this.search.change.subscribe((function(t){e.scopes.filter=t}))}},{key:"ngOnDestroy",value:function(){this.subscriptions.search.unsubscribe()}}]),e}()).\u0275fac=function(e){return new(e||q)(w.Ob(k.a),w.Ob(y.a),w.Ob(I.b),w.Ob(l.b),w.Ob(x.c),w.Ob(T.a))},q.\u0275cmp=w.Ib({type:q,selectors:[["app-scopes-page"]],viewQuery:function(e,t){var r;1&e&&w.xc(v.a,!0),2&e&&w.qc(r=w.dc())&&(t.search=r.first)},decls:24,vars:5,consts:[["color","primary"],["mat-icon-button","",1,"menu-toggle",3,"click"],[1,"page-label","spacer"],["placeholder","filter scopes"],["mat-icon-button","","routerLink","add"],["mode","indeterminate","color","accent",4,"ngIf"],[1,"page-body"],["mat-table","",3,"dataSource"],["matColumnDef","app"],["mat-header-cell","","text-uppercase","",4,"matHeaderCellDef"],["mat-cell","","text-uppercase","",4,"matCellDef"],["matColumnDef","description"],["matColumnDef","url"],["mat-cell","","text-lowercase","",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",3,"click",4,"matRowDef","matRowDefColumns"],["mode","indeterminate","color","accent"],["mat-header-cell","","text-uppercase",""],["mat-cell","","text-uppercase",""],["mat-cell","","text-lowercase",""],["mat-header-row",""],["mat-row","",3,"click"]],template:function(e,t){1&e&&(w.Ub(0,"mat-toolbar",0),w.Ub(1,"button",1),w.cc("click",(function(){return t.menu.toggle()})),w.Ub(2,"mat-icon"),w.Ac(3," menu "),w.Tb(),w.Tb(),w.Ub(4,"div",2),w.Ac(5," scopes "),w.Tb(),w.Pb(6,"search",3),w.Ub(7,"button",4),w.Ub(8,"mat-icon"),w.Ac(9," add "),w.Tb(),w.Tb(),w.Tb(),w.zc(10,O,1,0,"mat-progress-bar",5),w.Ub(11,"div",6),w.Ub(12,"table",7),w.Sb(13,8),w.zc(14,R,2,0,"th",9),w.zc(15,A,2,1,"td",10),w.Rb(),w.Sb(16,11),w.zc(17,P,2,0,"th",9),w.zc(18,_,2,1,"td",10),w.Rb(),w.Sb(19,12),w.zc(20,D,2,0,"th",9),w.zc(21,S,2,1,"td",13),w.Rb(),w.zc(22,z,1,0,"tr",14),w.zc(23,j,1,0,"tr",15),w.Tb(),w.Tb()),2&e&&(w.Cb(10),w.nc("ngIf",t.loading),w.Cb(2),w.nc("dataSource",t.scopes),w.Cb(10),w.nc("matHeaderRowDef",t.columns)("matHeaderRowDefSticky",!0),w.Cb(1),w.nc("matRowDefColumns",t.columns))},directives:[m.a,b.a,i.a,v.a,x.d,n.l,c.j,c.c,c.e,c.b,c.g,c.i,U.a,c.d,c.a,c.f,c.h],styles:[".mat-column-icon[_ngcontent-%COMP%]{width:60px}.mat-column-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:40px;margin-top:5px;max-height:40px}.mat-row[_ngcontent-%COMP%]{cursor:pointer}"]}),q),N=r("AytR"),F=r("3Pt+"),G=r("dWDE"),L=r("xyCQ"),V=r("kmnG"),E=r("FKr1"),J=r("roMP");function $(e,t){1&e&&w.Pb(0,"mat-progress-bar",14)}function H(e,t){if(1&e&&(w.Ub(0,"mat-error"),w.Ac(1),w.Tb()),2&e){var r=w.gc();w.Cb(1),w.Cc(" ",r.errors.description," ")}}function K(e,t){if(1&e&&(w.Ub(0,"mat-error"),w.Ac(1),w.Tb()),2&e){var r=w.gc();w.Cb(1),w.Cc(" ",r.errors.url," ")}}function Q(e,t){if(1&e&&(w.Ub(0,"mat-option",15),w.Ac(1),w.Tb()),2&e){var r=t.$implicit;w.nc("value",r.appId),w.Cb(1),w.Cc(" ",r.name," ")}}function Z(e,t){if(1&e&&(w.Ub(0,"mat-error"),w.Ac(1),w.Tb()),2&e){var r=w.gc();w.Cb(1),w.Cc(" ",r.errors.appId," ")}}function B(e,t){if(1&e&&(w.Ub(0,"mat-option",15),w.Ac(1),w.Tb()),2&e){var r=t.$implicit;w.nc("value",r.value),w.Cb(1),w.Cc(" ",r.title," ")}}function X(e,t){if(1&e&&(w.Ub(0,"mat-error"),w.Ac(1),w.Tb()),2&e){var r=w.gc();w.Cb(1),w.Cc(" ",r.errors.roles," ")}}var Y,W,ee,te=((Y=function(){function e(t,r,o,n,s,i){_classCallCheck(this,e),this.route=t,this.toast=r,this.router=o,this.service=n,this.formerror=s,this.appsservice=i,this.form=new F.d({url:new F.b("",[F.p.required]),appId:new F.b("",[F.p.required]),roles:new F.b(0,[F.p.required]),description:new F.b("",[F.p.required])}),this.errors={url:"",appId:"",roles:"",description:""},this.apps=[],this.roles=N.a.roles,this.subscriptions={}}return _createClass(e,[{key:"get",value:function(){return Object(h.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.loading=!0,e.next=3,this.service.get({filter:["url","role","appId","roles","description"],scopeId:this.scopeId});case 3:t=e.sent,this.loading=!1,t.ok?(t.result.role<3&&(this.router.navigate(["/scopes"]),this.toast.error("you do not have permission to access this scope!")),this.form.controls.url.setValue(t.result.url),this.form.controls.appId.setValue(t.result.appId),this.form.controls.roles.setValue(t.result.roles),this.form.controls.description.setValue(t.result.description)):(this.router.navigate(["/scopes"]),this.toast.error("issue loading scope!")),this.load();case 5:case"end":return e.stop()}}),e,this)})))}},{key:"load",value:function(){return Object(h.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.loading=!0,e.next=3,this.appsservice.list({filter:["name","appId"]});case 3:t=e.sent,this.loading=!1,t.ok&&(this.apps=t.result);case 5:case"end":return e.stop()}}),e,this)})))}},{key:"submit",value:function(){return Object(h.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.loading=!0,"copy"==(t=this.mode)&&(t="add"),this.form.disable(),e.next=5,this.service[t]({url:this.form.value.url,roles:this.form.value.roles,appId:this.form.value.appId,scopeId:this.scopeId,description:this.form.value.description});case 5:r=e.sent,this.form.enable(),this.loading=!1,r.ok?(this.router.navigate(["/scopes"]),this.toast.success("add"==t?"scope was added!":"scope was updated!")):this.toast.error("add"==t?"there was an issue adding scope!":"there was an issue updating scope!");case 7:case"end":return e.stop()}}),e,this)})))}},{key:"ngOnInit",value:function(){var e=this;this.subscriptions.form=this.form.valueChanges.subscribe((function(t){e.errors=e.formerror.validateForm(e.form,e.errors,!0)})),this.subscriptions.route=this.route.params.subscribe((function(t){e.mode=t.mode,e.scopeId=t.scopeId,"add"!=e.mode?e.get():e.load()}))}},{key:"ngOnDestroy",value:function(){this.subscriptions.form.unsubscribe(),this.subscriptions.route.unsubscribe()}}]),e}()).\u0275fac=function(e){return new(e||Y)(w.Ob(x.a),w.Ob(y.a),w.Ob(x.c),w.Ob(T.a),w.Ob(G.a),w.Ob(L.a))},Y.\u0275cmp=w.Ib({type:Y,selectors:[["app-scope-editor"]],decls:33,vars:14,consts:[["color","primary"],[1,"page-label","spacer"],["mat-icon-button","","routerLink","/scopes"],["mode","indeterminate","color","accent",4,"ngIf"],[3,"formGroup","ngSubmit"],["appearance","outline"],["text-uppercase",""],["matInput","","type","text","name","description","placeholder","description","formControlName","description","required",""],[4,"ngIf"],["matInput","","type","url","name","url","placeholder","url","formControlName","url","required",""],["name","appId","placeholder","app","formControlName","appId","required",""],[3,"value",4,"ngFor","ngForOf"],["name","roles","placeholder","roles","formControlName","roles","required","","multiple",""],["type","submit","mat-flat-button","","color","primary"],["mode","indeterminate","color","accent"],[3,"value"]],template:function(e,t){1&e&&(w.Ub(0,"mat-toolbar",0),w.Ub(1,"div",1),w.Ac(2),w.Tb(),w.Ub(3,"button",2),w.Ub(4,"mat-icon"),w.Ac(5," close "),w.Tb(),w.Tb(),w.Tb(),w.zc(6,$,1,0,"mat-progress-bar",3),w.Ub(7,"form",4),w.cc("ngSubmit",(function(){return!t.form.invalid&&t.submit()})),w.Ub(8,"mat-form-field",5),w.Ub(9,"mat-label",6),w.Ac(10," description "),w.Tb(),w.Pb(11,"input",7),w.zc(12,H,2,1,"mat-error",8),w.Tb(),w.Ub(13,"mat-form-field",5),w.Ub(14,"mat-label",6),w.Ac(15," url "),w.Tb(),w.Pb(16,"input",9),w.zc(17,K,2,1,"mat-error",8),w.Tb(),w.Ub(18,"mat-form-field",5),w.Ub(19,"mat-label",6),w.Ac(20," app "),w.Tb(),w.Ub(21,"mat-select",10),w.zc(22,Q,2,2,"mat-option",11),w.hc(23,"orderBy"),w.Tb(),w.zc(24,Z,2,1,"mat-error",8),w.Tb(),w.Ub(25,"mat-form-field",5),w.Ub(26,"mat-label",6),w.Ac(27," roles "),w.Tb(),w.Ub(28,"mat-select",12),w.zc(29,B,2,2,"mat-option",11),w.Tb(),w.zc(30,X,2,1,"mat-error",8),w.Tb(),w.Ub(31,"button",13),w.Ac(32," submit "),w.Tb(),w.Tb()),2&e&&(w.Cb(2),w.Ec(" ","add"==t.mode?"add scope":""," ","copy"==t.mode?"copy scope":""," ","update"==t.mode?"update scope":""," "),w.Cb(4),w.nc("ngIf",t.loading),w.Cb(1),w.nc("formGroup",t.form),w.Cb(5),w.nc("ngIf",t.errors.description),w.Cb(5),w.nc("ngIf",t.errors.url),w.Cb(5),w.nc("ngForOf",w.jc(23,11,t.apps,"name")),w.Cb(2),w.nc("ngIf",t.errors.appId),w.Cb(5),w.nc("ngForOf",t.roles),w.Cb(1),w.nc("ngIf",t.errors.roles))},directives:[m.a,b.a,x.d,i.a,n.l,F.q,F.j,F.e,V.c,V.g,u.a,F.a,F.i,F.c,F.o,p.a,n.k,U.a,V.b,E.k],pipes:[J.a],styles:["form[_ngcontent-%COMP%]{width:400px;margin:auto}@media screen and (max-width:420px){form[_ngcontent-%COMP%]{width:calc(100% - 20px)}}"]}),Y),re=[{path:"",component:M},{path:":mode",component:te},{path:":mode/:scopeId",component:te}],oe=((ee=function e(){_classCallCheck(this,e)}).\u0275mod=w.Mb({type:ee}),ee.\u0275inj=w.Lb({factory:function(e){return new(e||ee)},imports:[[x.g.forChild(re)],x.g]}),ee),ne=((W=function e(){_classCallCheck(this,e)}).\u0275mod=w.Mb({type:W}),W.\u0275inj=w.Lb({factory:function(e){return new(e||W)},imports:[[F.f,n.c,o.a,s.a,i.b,a.a,u.b,c.l,p.b,l.c,b.b,d.a,m.b,f.a,V.e,oe,F.n,I.c,U.b]]}),W)}}]);